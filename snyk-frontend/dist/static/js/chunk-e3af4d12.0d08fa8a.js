(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e3af4d12"],{"1a75":function(e,t,r){"use strict";r("bad9")},"2cfa":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.data,"element-loading-text":"Loading","empty-text":"未查询到服务"}},[r("el-table-column",{attrs:{label:"序号","min-width":"5%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index+1+(e.currentPage-1)*e.pageSize)+" ")]}}])}),r("el-table-column",{attrs:{label:"服务名称","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),r("el-table-column",{attrs:{label:"服务描述","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.desc)+" ")]}}])}),e.supplychainColumn?r("el-table-column",{attrs:{label:"供应链版本","min-width":"6%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.version)+" ")]}}],null,!1,1531980007)}):e._e(),r("el-table-column",{attrs:{label:"服务视图","min-width":"5%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{staticClass:"btn-link",on:{click:function(r){return e.handleCheckMap(t.$index,t.row)}}},[e._v("服务视图")])]}}])}),r("el-table-column",{attrs:{label:"服务实例","min-width":"5%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.instance_count)+" ")]}}])}),r("el-table-column",{attrs:{label:"服务状态","min-width":"5%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_online?r("div",[r("el-tag",{attrs:{size:"small"}},[e._v("在线")])],1):r("div",[r("el-tag",{attrs:{type:"info",size:"small"}},[e._v("离线")])],1)]}}])}),r("el-table-column",{attrs:{label:"维护团队","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.teamname)+" ")]}}])}),r("el-table-column",{attrs:{label:"配置文件","min-width":"8%"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{staticClass:"btn-link",on:{click:function(r){return e.openInfo(t.$index,t.row)}}},[e._v("预览")]),r("a",{staticClass:"btn-link",staticStyle:{"margin-left":"5px"},on:{click:function(r){return e.downloadXml(t.$index,t.row)}}},[e._v("下载")])]}}])})],1),e.flowInfoVisible?r("flow-info",{ref:"flowInfo",attrs:{data:e.infoData},on:{downloadData:e.downloadData}}):e._e()],1)},a=[],i=r("c7eb"),o=r("1da1"),s=(r("b0c0"),r("ad8f")),d=r("df4a"),c=r("bfa9"),u={props:{data:Array,loading:{type:Boolean,default:!1},supplychainColumn:{type:Boolean,default:!1}},components:{FlowInfo:c["a"]},data:function(){return{currentPage:0,pageSize:0,flowInfoVisible:!1,infoData:""}},methods:{handleCheckMap:function(e,t){this.$router.push({path:"/workspace/rootName/"+t.name})},openInfo:function(e,t){var r=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var n;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.flowInfoVisible=!0,e.next=3,Object(s["j"])({rootName:t.name});case 3:n=e.sent,0!=n.nodes.length&&(r.infoData=Object(d["b"])(n),r.$nextTick((function(){this.$refs.flowInfo.init()})));case 5:case"end":return e.stop()}}),e)})))()},downloadXml:function(e,t){var r=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var n,a,o,c;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["j"])({rootName:t.name});case 2:n=e.sent,0!=n.nodes.length?(a=Object(d["b"])(n),o="data:text/xml;charset=utf-8,"+encodeURIComponent(a),c=document.createElement("a"),c.setAttribute("href",o),c.setAttribute("download","data.xml"),c.click(),c.remove(),r.$message.success("正在下载中,请稍后...")):r.$message.error("数据请求错误");case 4:case"end":return e.stop()}}),e)})))()},downloadData:function(){var e="data:text/xml;charset=utf-8,"+encodeURIComponent(this.infoData),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","data.xml"),t.click(),t.remove(),this.$message.success("正在下载中,请稍后...")}}},l=u,p=(r("1a75"),r("2877")),f=Object(p["a"])(l,n,a,!1,null,null,null);t["a"]=f.exports},5892:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));r("d3b7"),r("159b");var n=r("852e");function a(e){var t="",r=[],a=[],i=new n.Parser({onopentag:function(e,n){switch(e){case"node":r.push({id:n["id"]});break;case"edge":a.push({id:n["id"],source:n["source"],target:n["target"]});break;case"data":"key"in n&&(t=n["key"]);break}},ontext:function(e){switch(t){case"node_label":r[r.length-1]["type"]=e;break;case"node_name":r[r.length-1]["label"]=e;break;case"edge_relation":a[a.length-1]["label"]=e;break;case"node_tag":"tags"in r[r.length-1]?r[r.length-1].tags.push(e):r[r.length-1].tags=[e];break;case"node_risk":"risks"in r[r.length-1]?r[r.length-1].risks.push(e):r[r.length-1].risks=[e];break;case"node_serviceId":r[r.length-1]["serviceId"]=e;break;case"node_serviceNodeId":r[r.length-1]["serviceNodeId"]=e;break;case"node_riskId":r[r.length-1]["riskId"]=e;break;case"node_riskNodeId":r[r.length-1]["riskNodeId"]=e;break;case"node_version":r[r.length-1]["version"]=e;break}t=""},onclosetag:function(e){}});return i.write(e),i.end(),{nodes:r,links:a}}function i(e){var t=document.implementation.createDocument("","",null),r=t.createElement("GraphXML");t.appendChild(r);var n=t.createElement("key");n.setAttribute("id","node_name"),n.setAttribute("for","node"),n.setAttribute("attr.name","name"),n.setAttribute("attr.type","string"),r.appendChild(n);var a=t.createElement("key");a.setAttribute("id","node_label"),a.setAttribute("for","node"),a.setAttribute("attr.name","label"),a.setAttribute("attr.type","string"),r.appendChild(a);var i=t.createElement("key");i.setAttribute("id","node_risk"),i.setAttribute("for","node"),i.setAttribute("attr.name","risk"),i.setAttribute("attr.type","string"),r.appendChild(i);a=t.createElement("key");a.setAttribute("id","node_serviceId"),a.setAttribute("for","node"),a.setAttribute("attr.name","serviceId"),a.setAttribute("attr.type","int"),r.appendChild(a);a=t.createElement("key");a.setAttribute("id","node_riskId"),a.setAttribute("for","node"),a.setAttribute("attr.name","riskId"),a.setAttribute("attr.type","int"),r.appendChild(a);a=t.createElement("key");a.setAttribute("id","node_serviceNodeId"),a.setAttribute("for","node"),a.setAttribute("attr.name","serviceNodeId"),a.setAttribute("attr.type","int"),r.appendChild(a);a=t.createElement("key");a.setAttribute("id","node_riskNodeId"),a.setAttribute("for","node"),a.setAttribute("attr.name","riskNodeId"),a.setAttribute("attr.type","int"),r.appendChild(a);a=t.createElement("key");a.setAttribute("id","node_version"),a.setAttribute("for","node"),a.setAttribute("attr.name","version"),a.setAttribute("attr.type","string"),r.appendChild(a);var o=t.createElement("key");o.setAttribute("id","edge_relation"),o.setAttribute("for","edge"),o.setAttribute("attr.name","relation"),o.setAttribute("attr.type","string"),r.appendChild(o);var s=t.createElement("graph");return o.setAttribute("id","g1"),o.setAttribute("edgedefault","directed"),r.appendChild(s),e.nodes.forEach((function(e){var r=t.createElement("node");r.setAttribute("id",e.id),s.appendChild(r);var n=t.createElement("data");n.setAttribute("key","node_name"),n.innerHTML=e.label,r.appendChild(n);var a=t.createElement("data");if(a.setAttribute("key","node_label"),a.innerHTML=e.type,r.appendChild(a),void 0!=e.serviceId){var i=t.createElement("data");i.setAttribute("key","node_serviceId"),i.innerHTML=e.serviceId,r.appendChild(i)}if(void 0!=e.riskId){var o=t.createElement("data");o.setAttribute("key","node_riskId"),o.innerHTML=e.riskId,r.appendChild(o)}if(void 0!=e.serviceNodeId){var d=t.createElement("data");d.setAttribute("key","node_serviceNodeId"),d.innerHTML=e.serviceNodeId,r.appendChild(d)}if(void 0!=e.riskNodeId){var c=t.createElement("data");c.setAttribute("key","node_riskNodeId"),c.innerHTML=e.riskNodeId,r.appendChild(c)}if(void 0!=e.version){var u=t.createElement("data");u.setAttribute("key","node_version"),u.innerHTML=e.version,r.appendChild(u)}void 0!=e.tags&&e.tags.forEach((function(e){var n=t.createElement("data");n.setAttribute("key","node_tag"),n.innerHTML=e,r.appendChild(n)})),void 0!=e.risks&&e.risks.forEach((function(e){var n=t.createElement("data");n.setAttribute("key","node_risk"),n.innerHTML=e,r.appendChild(n)}))})),e.links.forEach((function(e){var r=t.createElement("edge");r.setAttribute("id",e.id),r.setAttribute("source",e.source),r.setAttribute("target",e.target),s.appendChild(r);var n=t.createElement("data");n.setAttribute("key","edge_relation"),n.innerHTML=e.label,r.appendChild(n)})),(new XMLSerializer).serializeToString(t)}},ad8f:function(e,t,r){"use strict";r.d(t,"n",(function(){return d})),r.d(t,"o",(function(){return c})),r.d(t,"p",(function(){return u})),r.d(t,"m",(function(){return l})),r.d(t,"q",(function(){return p})),r.d(t,"v",(function(){return f})),r.d(t,"i",(function(){return b})),r.d(t,"j",(function(){return m})),r.d(t,"c",(function(){return k})),r.d(t,"k",(function(){return h})),r.d(t,"t",(function(){return v})),r.d(t,"f",(function(){return g})),r.d(t,"d",(function(){return y})),r.d(t,"h",(function(){return I})),r.d(t,"u",(function(){return _})),r.d(t,"b",(function(){return w})),r.d(t,"g",(function(){return A})),r.d(t,"x",(function(){return O})),r.d(t,"y",(function(){return E})),r.d(t,"w",(function(){return C})),r.d(t,"e",(function(){return j})),r.d(t,"r",(function(){return N})),r.d(t,"a",(function(){return x}));var n=r("b775"),a=(r("d3b7"),r("bc3a")),i=r.n(a),o=(r("5c96"),i.a.create({baseURL:"",timeout:5e4}));o.defaults.retry=4,o.defaults.retryDelay=1e5,o.interceptors.response.use((function(e){var t=e.data;return t}),(function(e){return console.log("err"+e),Promise.reject(e)}));var s=o;function d(e){return Object(n["a"])({url:"backend/Projects/searchProject",method:"get",params:e})}function c(e){return Object(n["a"])({url:"backend/Projects/searchVersion",method:"get",params:e})}function u(e){return Object(n["a"])({url:"backend/getResults",method:"get",params:e})}function l(e){return Object(n["a"])({url:"backend/Services/getServices",method:"get",params:e})}function p(e){return Object(n["a"])({url:"backend/Services/insertServices",method:"get",params:e})}function f(e){return Object(n["a"])({url:"backend/Services/updateServices",method:"get",params:e})}function b(e){return Object(n["a"])({url:"backend/Services/deleteServices",method:"get",params:e})}function m(e){return Object(n["a"])({url:"backend/getMap",method:"get",params:e})}function k(e){return Object(n["a"])({url:"backend/addNode",method:"get",params:e})}function h(e){return Object(n["a"])({url:"backend/getNode",method:"get",params:e})}function v(e){return Object(n["a"])({url:"backend/updateNode",method:"get",params:e})}function g(e){return Object(n["a"])({url:"backend/deleteNode",method:"get",params:e})}function y(e){return Object(n["a"])({url:"backend/addRelation",method:"get",params:e})}function I(e){return Object(n["a"])({url:"backend/deleteRelation",method:"get",params:e})}function _(e){return Object(n["a"])({url:"backend/updateRelation",method:"get",params:e})}function w(e){return Object(n["a"])({url:"backend/addLabel",method:"get",params:e})}function A(e){return Object(n["a"])({url:"backend/deleteLabel",method:"get",params:e})}function O(e){return Object(n["a"])({url:"backend/mavenDependency/update",method:"get",params:e})}function E(e){return s({url:"backend/mavenDependency/sshupload",method:"post",headers:{"content-type":"multipart/form-data"},data:e})}function C(e){return s({url:"backend/mavenDependency/uploadFile",method:"post",headers:{"content-type":"multipart/form-data"},data:e})}function j(e){return Object(n["a"])({url:"backend/Projects/insertVersion",method:"get",params:e})}function N(e){return Object(n["a"])({url:"backend/insertSnykData",method:"get",params:e})}function x(e){return Object(n["a"])({url:"backend/crawl",method:"get",params:e})}},b775:function(e,t,r){"use strict";r("d3b7");var n=r("bc3a"),a=r.n(n),i=(r("5c96"),r("4328")),o=r.n(i),s=a.a.create({baseURL:"",timeout:5e4,headers:{"Content-Type":"application/x-www-form-urlencoded"}});s.defaults.retry=4,s.defaults.retryDelay=1e5,s.interceptors.request.use((function(e){return e.data=o.a.stringify(e.data),e}),(function(e){return Promise.error(e)})),s.interceptors.response.use((function(e){var t=e.data;return t}),(function(e){return console.log("err"+e),Promise.reject(e)})),t["a"]=s},bad9:function(e,t,r){},bfa9:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"GraphXML数据",visible:e.dialogVisible,width:"50%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-alert",{attrs:{title:"使用说明",type:"warning",description:"以下数据可以被存储起来，方便下一次流程加载","show-icon":"","close-text":"知道了"}}),r("codemirror",{staticClass:"code",attrs:{value:e.xmlData,options:e.options}}),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("关闭")]),r("el-button",{attrs:{type:"primary"},on:{click:e.downloadData}},[e._v("下载")])],1)],1)},a=[],i=(r("a7be"),r("d5e0"),r("8f94")),o=r("347e"),s=r.n(o);r("f9d4");var d={props:{data:String},data:function(){return{dialogVisible:!1,xmlData:void 0,options:{mode:"xml",readOnly:!0,lineNumbers:!0}}},components:{codemirror:i["codemirror"]},methods:{init:function(){this.dialogVisible=!0,this.xmlData=s.a.xml(this.data)},downloadData:function(){this.$emit("downloadData")}}},c=d,u=r("2877"),l=Object(u["a"])(c,n,a,!1,null,null,null);t["a"]=l.exports},df4a:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return d}));var n=r("b85c"),a=(r("d3b7"),r("159b"),r("c740"),r("fb6a"),r("a434"),r("5892")),i={SERVICE:{color:"64,158,255"},SOFTWARE:{color:"103,194,58"},COMPONENT:{color:"103,194,58"},HOST:{color:"230,162,60"},DOCKER:{color:"230,162,60"},ACCESS:{color:"26,185,211"},INTERFACE:{color:"26,185,211"},NETWORK:{color:"144,147,153"},RISK:{color:"245,108,108"},CUSTOM:{color:"153,153,153"}};function o(e,t){var r={nodes:[],links:[]};return e.forEach((function(e){var t={id:e.id,label:e.label,type:e.type,tags:e.properties.tags,risks:e.properties.risks,version:e.properties.version,serviceId:e.properties.serviceId,serviceNodeId:e.properties.serviceNodeId,riskId:e.properties.riskId,riskNodeId:e.properties.riskNodeId};r.nodes.push(t)})),t.forEach((function(e){r.links.push({source:e.source.id||e.source,target:e.target.id||e.target,label:e.label||"",id:e.id})})),r}function s(e,t){var r,a=Object(n["a"])(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;try{if(o.type=o.type.toUpperCase(),o.color=i[o.type].color,o.properties={risks:o.risks,tags:o.tags||[]},t){if("SOFTWARE"===o.type||"COMPONENT"===o.type){var s=o.properties.tags.findIndex((function(e){return-1!=e.indexOf("Version")}));s>-1&&(o.properties.version=o.properties.tags[s].slice(8),o.properties.tags.splice(s,1))}else if("SERVICE"===o.type){var d=o.properties.tags.findIndex((function(e){return-1!=e.indexOf("ServiceId")}));d>-1&&(o.properties.serviceId=o.properties.tags[d].slice(10),o.properties.tags.splice(d,1)),o.properties.serviceNodeId=o.id}else if("RISK"===o.type){var c=o.properties.tags.findIndex((function(e){return-1!=e.indexOf("RiskId")}));c>-1&&(o.properties.riskId=o.properties.tags[c].slice(7),o.properties.tags.splice(c,1)),o.properties.riskNodeId=o.id}o.properties.tags.shift()}else o.serviceId&&(o.properties.serviceId=o.serviceId),o.serviceNodeId&&(o.properties.serviceNodeId=o.serviceNodeId),o.version&&(o.properties.version=o.version),o.riskId&&(o.properties.riskId=o.riskId),o.riskNodeId&&(o.properties.riskNodeId=o.riskNodeId);delete o.tags,delete o.risks}catch(u){console.error("未定义的节点类型：",o.type,u);continue}}}catch(u){a.e(u)}finally{a.f()}return e}function d(e){return Object(a["a"])(o(s(e.nodes,!0),e.links))}}}]);