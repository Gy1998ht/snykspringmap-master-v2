(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7963e31e"],{"0649":function(e,t,i){"use strict";i("14aa")},"07a8":function(e,t,i){"use strict";i("b5cc")},"07f4":function(e,t,i){},"14aa":function(e,t,i){},"2b55":function(e,t,i){"use strict";i("99fb")},4348:function(e,t,i){},5892:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return a}));i("d3b7"),i("159b");var n=i("852e");function s(e){var t="",i=[],s=[],a=new n.Parser({onopentag:function(e,n){switch(e){case"node":i.push({id:n["id"]});break;case"edge":s.push({id:n["id"],source:n["source"],target:n["target"]});break;case"data":"key"in n&&(t=n["key"]);break}},ontext:function(e){switch(t){case"node_label":i[i.length-1]["type"]=e;break;case"node_name":i[i.length-1]["label"]=e;break;case"edge_relation":s[s.length-1]["label"]=e;break;case"node_tag":"tags"in i[i.length-1]?i[i.length-1].tags.push(e):i[i.length-1].tags=[e];break;case"node_risk":"risks"in i[i.length-1]?i[i.length-1].risks.push(e):i[i.length-1].risks=[e];break;case"node_serviceId":i[i.length-1]["serviceId"]=e;break;case"node_serviceNodeId":i[i.length-1]["serviceNodeId"]=e;break;case"node_riskId":i[i.length-1]["riskId"]=e;break;case"node_riskNodeId":i[i.length-1]["riskNodeId"]=e;break;case"node_version":i[i.length-1]["version"]=e;break}t=""},onclosetag:function(e){}});return a.write(e),a.end(),{nodes:i,links:s}}function a(e){var t=document.implementation.createDocument("","",null),i=t.createElement("GraphXML");t.appendChild(i);var n=t.createElement("key");n.setAttribute("id","node_name"),n.setAttribute("for","node"),n.setAttribute("attr.name","name"),n.setAttribute("attr.type","string"),i.appendChild(n);var s=t.createElement("key");s.setAttribute("id","node_label"),s.setAttribute("for","node"),s.setAttribute("attr.name","label"),s.setAttribute("attr.type","string"),i.appendChild(s);var a=t.createElement("key");a.setAttribute("id","node_risk"),a.setAttribute("for","node"),a.setAttribute("attr.name","risk"),a.setAttribute("attr.type","string"),i.appendChild(a);s=t.createElement("key");s.setAttribute("id","node_serviceId"),s.setAttribute("for","node"),s.setAttribute("attr.name","serviceId"),s.setAttribute("attr.type","int"),i.appendChild(s);s=t.createElement("key");s.setAttribute("id","node_riskId"),s.setAttribute("for","node"),s.setAttribute("attr.name","riskId"),s.setAttribute("attr.type","int"),i.appendChild(s);s=t.createElement("key");s.setAttribute("id","node_serviceNodeId"),s.setAttribute("for","node"),s.setAttribute("attr.name","serviceNodeId"),s.setAttribute("attr.type","int"),i.appendChild(s);s=t.createElement("key");s.setAttribute("id","node_riskNodeId"),s.setAttribute("for","node"),s.setAttribute("attr.name","riskNodeId"),s.setAttribute("attr.type","int"),i.appendChild(s);s=t.createElement("key");s.setAttribute("id","node_version"),s.setAttribute("for","node"),s.setAttribute("attr.name","version"),s.setAttribute("attr.type","string"),i.appendChild(s);var o=t.createElement("key");o.setAttribute("id","edge_relation"),o.setAttribute("for","edge"),o.setAttribute("attr.name","relation"),o.setAttribute("attr.type","string"),i.appendChild(o);var r=t.createElement("graph");return o.setAttribute("id","g1"),o.setAttribute("edgedefault","directed"),i.appendChild(r),e.nodes.forEach((function(e){var i=t.createElement("node");i.setAttribute("id",e.id),r.appendChild(i);var n=t.createElement("data");n.setAttribute("key","node_name"),n.innerHTML=e.label,i.appendChild(n);var s=t.createElement("data");if(s.setAttribute("key","node_label"),s.innerHTML=e.type,i.appendChild(s),void 0!=e.serviceId){var a=t.createElement("data");a.setAttribute("key","node_serviceId"),a.innerHTML=e.serviceId,i.appendChild(a)}if(void 0!=e.riskId){var o=t.createElement("data");o.setAttribute("key","node_riskId"),o.innerHTML=e.riskId,i.appendChild(o)}if(void 0!=e.serviceNodeId){var l=t.createElement("data");l.setAttribute("key","node_serviceNodeId"),l.innerHTML=e.serviceNodeId,i.appendChild(l)}if(void 0!=e.riskNodeId){var h=t.createElement("data");h.setAttribute("key","node_riskNodeId"),h.innerHTML=e.riskNodeId,i.appendChild(h)}if(void 0!=e.version){var c=t.createElement("data");c.setAttribute("key","node_version"),c.innerHTML=e.version,i.appendChild(c)}void 0!=e.tags&&e.tags.forEach((function(e){var n=t.createElement("data");n.setAttribute("key","node_tag"),n.innerHTML=e,i.appendChild(n)})),void 0!=e.risks&&e.risks.forEach((function(e){var n=t.createElement("data");n.setAttribute("key","node_risk"),n.innerHTML=e,i.appendChild(n)}))})),e.links.forEach((function(e){var i=t.createElement("edge");i.setAttribute("id",e.id),i.setAttribute("source",e.source),i.setAttribute("target",e.target),r.appendChild(i);var n=t.createElement("data");n.setAttribute("key","edge_relation"),n.innerHTML=e.label,i.appendChild(n)})),(new XMLSerializer).serializeToString(t)}},"6d29":function(module,exports,__webpack_require__){__webpack_require__("d3b7"),__webpack_require__("25f0"),__webpack_require__("ac1f"),__webpack_require__("5319"),__webpack_require__("4d63"),__webpack_require__("2c3e"),eval(function(e,t,i,n,s,a){if(s=function(e){return(e<t?"":s(parseInt(e/t)))+((e%=t)>35?String.fromCharCode(e+29):e.toString(36))},!"".replace(/^/,String)){while(i--)a[s(i)]=n[i]||s(i);n=[function(e){return a[e]}],s=function(){return"\\w+"},i=1}while(i--)n[i]&&(e=e.replace(new RegExp("\\b"+s(i)+"\\b","g"),n[i]));return e}(";(14(){7 z=14(a,b){13.1b=a;13.1A=b;13.3C=3.0;13.2Z=0.7Z;13.3e=0.0;13.4F=5.0;13.4G=10.0;13.6i={};13.1j=1x};z.18.1P=14(){19[{'1l':'邻点引力','3C':8.0},{'1l':'引力','2Z':0.6j},{'1l':'力缩放系数','3e':8.0}]};z.18.1Q=14(a){7 b=13;16(a){13.3C=1s(a['3C'])||8.0;13.2Z=1s(a['2Z'])||0.6j;13.3e=1s(a['3e'])||8.0;13.6i={};b.1b.1h(14(n){n.5o=(n.1V||[]).1a+(n.1M||[]).1a})}13.1j=1n};z.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};z.18.1R=14(){16(13.1j){13.1r()}};z.18.1u=14(){7 c=13;c.3C=8.0;c.2Z=0.12;c.3e=5.0;c.4F=5.0;c.4G=10.0;c.1b.1h(14(n){7 a=n.1V||[];7 b=n.1M||[];n.5o=a.1a+b.1a});13.1j=1n};z.18.1r=14(){7 d=13;7 e=3f,4H=3f;d.1b.1h(14(a){7 f=d.6k(a);7 b=a.5o;7 c=b<=1?d.4F:d.4F/17.5p(b,0.4);f={x:f.x*c,y:f.y*c};a.x+=f.x;a.y+=f.y;e=17.24(e,a.x);4H=17.24(4H,a.y)});d.1b.1h(14(a){a.x+=(2d-e);a.y+=(2d-4H)})};z.18.6k=14(d){7 e=13;7 f=e.1b.1a;7 g={x:0,y:0};16(d.x==0&&d.y==0){19 g}e.1b.1h(14(n){16(d.1e!=n.1e&&(n.x!=0||n.y!=0)){7 a=n.x-d.x;7 b=n.y-d.y;16(a==0&&b==0){a=50;b=50}7 c=1.0;16(e.6l(d,n)){c=e.3C}c=c*(e.2Z/17.1B(f));g={x:g.x+a*c,y:g.y+b*c};c=1.0/17.1B(a*a+b*b);g={x:g.x-a*c*e.3e,y:g.y-b*c*e.3e}}});7 h=e.6m(0.0,0.0,g.x,g.y);16(h>e.4G){7 i=e.4G/h;g={x:g.x*i,y:g.y*i}}19 g};z.18.81=14(a){19(a.1V||[]).1a+(a.1M||[]).1a};z.18.6l=14(a,b){7 c=[];(a.1V||[]).1h(14(l){c.1v(l.25)});(a.1M||[]).1h(14(l){c.1v(l.1T)});7 d=1x;c.1h(14(n){16(n.1e==b.1e){d=1n}})};z.18.6m=14(a,b,x,y){a-=x;b-=y;19 17.1B(a*a+b*b)};7 D=14(a,b){13.1b=a;13.1A=b;13.43=31;13.44=1x;13.1F=1n;13.45='4I';13.2v=1.2;13.3D=17.1G*2;13.1w=50;13.1j=1x};D.18.1P=14(){19[{'1l':'直径计算','45':[{1l:'自动',1H:'4I'},{1l:'指定',1H:'82'}]},{'1l':'直径大小','43':31}]};D.18.1Q=14(a){13.43=1s(a['43'])||31;13.45=a['45']||'4I';16(13.45=='4I'){13.44=1x}1g{13.44=1n}13.1u()};D.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};D.18.1R=14(){16(13.1j){13.1r()}};D.18.1u=14(){7 c=13;7 d=c.1b;7 e=d.1a;7 f=[];7 g=0.0;7 h=0.0;7 j=0;7 k=0.0;7 l=c.3D/e;7 m=0.0;d=d.3E(14(a,b){7 x=(a.1V||[]).1a+(a.1M||[]).1a;7 y=(b.1V||[]).1a+(b.1M||[]).1a;16(x>y){19-1}1g 16(x<y){19 1}1g{19 0}});16(!c.44){1k(7 i=0;i<e;i++){7 n=d[i];g+=(n.2i*n.1C)*1.2}g*=c.2v;h=g/17.1G;l=c.3D/g}1g{h=c.43}7 o=h/2;1k(7 i=0;i<e;i++){7 n=d[i];16(!c.44){k=n.2i*n.1C;7 p=l*k*c.2v;f=c.3F(o,1,m+p);m+=k*1.2*l*c.2v}1g{f=c.3F(o,j,l)}7 q=c.1z();q.1c=f[0];q.1d=f[1];q.1o=(1.0/c.1w)*(f[0]-n.x);q.1p=(1.0/c.1w)*(f[1]-n.y);n.1i=q;j++}13.1j=1n};D.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};D.18.3F=14(a,b,c){7 d=[];d[0]=(a*17.26(c*b+17.1G/2));d[1]=(a*17.27(c*b+17.1G/2));19 d};7 F=14(a,b){13.1b=a;13.1A=b;13.4J=1x;13.2E=15;13.83=1n;13.1F=1n;13.3D=17.1G*2;13.1w=50;13.1j=1x};F.18.1P=14(){19[{'1l':'分布位置','46':[{1l:'环内部',1H:'5q'},{1l:'环外部',1H:'84'}]},{'1l':'核心数','2E':15}]};F.18.1Q=14(a){13.2E=1s(a['2E'])||15;13.46=a['46']||'5q';16(13.46=='5q'){13.4J=1x}1g{13.4J=1n}13.1u()};F.18.1R=14(){16(13.1j){13.1r()}};F.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};F.18.1u=14(){7 c=13;7 d=c.1b;7 e=d.1a;7 f=[];7 g=0,2w=0;7 h=0,4K=0,47=0;7 j=1,3g=1;16(c.2E>e){c.2E=1}d=d.3E(14(a,b){7 x=(a.1V||[]).1a+(a.1M||[]).1a;7 y=(b.1V||[]).1a+(b.1M||[]).1a;16(x>y){19-1}1g 16(x<y){19 1}1g{19 0}});1k(7 i=0;i<e;i++){7 n=d[i];7 k=n.2i*n.1C;16(i<c.2E){g+=k*2.0}1g{2w+=k*2.0}}7 l=2w/g;16(l<2){j=2/l;2w=2*g}16(c.4J){3g=(2*2w)/g;g=2w*2}1g{3g=2w/(2*g);g=2w/2}2w*=1.2;5r=c.3D/2w;7 m=2w/17.1G/2;g*=1.2;4K=c.3D/g;7 o=g/17.1G/2;1k(7 i=0;i<e;i++){7 n=d[i];7 k=n.2i*n.1C;16(i<c.2E){16(3g>2){k=g/((2*c.2E)*3g*1.2)}7 p=4K*k*1.2*3g;16(i==0){47=p}f=c.3F(o,1,(h+p)-47);h+=k*2*4K*1.2*3g}1g{7 p=5r*k*1.2*j;16(i==c.2E){h=0;47=p}f=c.3F(m,1,(h+p)-47);h+=k*2*5r*1.2*j}7 q=c.1z();q.1c=f[0];q.1d=f[1];q.1o=(1.0/c.1w)*(f[0]-n.x);q.1p=(1.0/c.1w)*(f[1]-n.y);n.1i=q}13.1j=1n};F.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};F.18.3F=14(a,b,c){7 d=[];d[0]=(a*17.26(c*b+17.1G/2));d[1]=(a*17.27(c*b+17.1G/2));19 d};7 G=14(a,b){13.1b=a;13.1A=b;13.32=11;13.1W=30;13.1F=1n;13.1w=50;13.1j=1x};G.18.1P=14(){19[{'1l':'外层点数','32':11},{'1l':'层间距','1W':30}]};G.18.1Q=14(a){13.32=1s(a['32'])||11;13.1W=1s(a['1W'])||30;13.1u()};G.18.1R=14(){16(13.1j){13.1r()}};G.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};G.18.1u=14(){7 c=13;7 d=c.1b;7 e=d.1a;7 f=0,4L=0,48=0;7 g=0,2O=0;d=d.3E(14(a,b){7 x=(a.1V||[]).1a+(a.1M||[]).1a;7 y=(b.1V||[]).1a+(b.1M||[]).1a;16(x<y){19-1}1g 16(x>y){19 1}1g{19 0}});16(c.32>e){c.32=0}1k(7 i=0;i<e;i++){7 h=d[i];48+=h.1C*h.2i;16(48>4L){5s=h.1C*h.2i;3G=f+c.1W+5s;4L=2*17.1G*3G;f=f+c.1W+h.1C*h.2i;2O=1.0/3G;g=0;48=h.1C*h.2i}7 j=0;16(i<(e-c.32)){j=2O*h.1C*h.2i}1g{3G=f+c.1W+5s;j=2*17.1G/c.32}g+=j;7 k=c.1z();k.1c=3G*2.4*17.26(g+17.1G);k.1d=3G*2.4*17.27(g+17.1G);k.1o=(1.0/c.1w)*(k.1c-h.x);k.1p=(1.0/c.1w)*(k.1d-h.y);h.1i=k}13.1j=1n};G.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};7 H=14(a,b){13.1b=a;13.1A=b;13.3H=5t;13.1Y=3I;13.2e=1.2;13.33=3I.0;13.1Z=10;13.1j=1x};H.18.1z=14(){7 a={1D:0.0,1t:0.0,85:0.0,86:0.0,87:0.0};19 a};H.18.1R=14(){16(13.1j){13.1r()}};H.18.1P=14(){19[{'1l':'区域大小','1Y':31},{'1l':'重力','2e':2.0}]};H.18.1Q=14(a){7 b=13;16(a){13.1Y=1s(a['1Y'])||31;13.2e=1s(a['2e'])||1.5;13.1b.1h(14(n){n.1i=b.1z()})}13.1j=1n};H.18.1u=14(){7 a=13;a.1Y=a.1b.1a/2;a.1b.1h(14(n){n.1i=a.1z()});13.1j=1n};H.18.1r=14(){7 l=13;7 m=l.1b;7 o=m.1a;7 p=17.1B(l.3H*l.1Y)/10.0;7 k=17.1B((l.3H*l.1Y)/(1.0+o));m.1h(14(g,i){g.1i.1D=0;g.1i.1t=0;m.1h(14(a,j){16(i!=j){7 b=g.x-a.x;7 c=g.y-a.y;7 d=17.1B(b*b+c*c);16(d>0){7 e=k*k/d;7 f=g.1i;f.1D+=(b/d*e);f.1t+=(c/d*e)}}})});7 q=l.1A;q.1h(14(E){7 a=E.25;7 b=E.1T;7 c=a.x-b.x;7 d=a.y-b.y;7 e=17.1B(c*c+d*d);7 f=e*e/k;16(e>0){7 g=a.1i;7 h=b.1i;g.1D-=(c/e*f);g.1t-=(d/e*f);h.1D+=(c/e*f);h.1t+=(d/e*f)}});m.1h(14(n){7 a=n.1i;7 d=17.1B(n.x*n.x+n.y*n.y);7 b=0.34*k*l.2e*d;a.1D-=b*n.x/d;a.1t-=b*n.y/d;a.1D*=l.1Z/l.33;a.1t*=l.1Z/l.33;7 c=17.1B(a.1D*a.1D+a.1t*a.1t);16(c>0){7 e=17.24(p*(l.1Z/l.33),c);n.x+=(a.1D/c*e);n.y+=(a.1t/c*e)}})};7 I=14(a,b){13.1b=a;13.1A=b;13.2j={6n:1n,1Y:3h,2e:3,1Z:0.6o,6p:3h};13.3i=10;13.k=49.0;13.4a=0;13.1j=1x};I.18.1P=14(){7 a=13;19[{'1l':'重力','2e':0.5},{'1l':'边长度','k':a.k},{'1l':'收敛速度','1Z':0.50}]};I.18.1Q=14(b){16(b){13.1b.1h(14(a){a.2x=a.x;a.2y=a.y;a.2f={1D:0,1t:0}});13.2j.2e=1s(b['2e'])||0.5;13.2j.1Z=1s(b['1Z'])||0.6o;13.k=1s(b['k'])||49;13.4a=0}13.1j=1n};I.18.1u=14(){7 b=13;7 c=13.1b.1a;b.1b.1h(14(a){a.2x=a.x;a.2y=a.y;a.2f={1D:0,1t:0}});b.2j.1Y=b.2j.6n?(c*c):b.2j.1Y;b.3i=17.1B(b.2j.1Y)/8;b.k=17.1B(b.2j.1Y/(1+c));16(b.3i<4M){b.3i=4M}16(b.k<40){b.k=40}b.4a=0;13.1j=1n};I.18.1R=14(){16(13.4a>13.2j.6p){19}16(13.1j){13.1r();13.4a++}};I.18.1r=14(){7 a=13;7 b=a.1b;7 c=a.1A;7 e=a.1b.1a;1k(7 i=0;i<e;i++){7 n=b[i];1k(7 j=0;j<e;j++){7 f=b[j];16(n.1e!=f.1e){7 g=n.2x-f.2x;7 h=n.2y-f.2y;7 k=17.1B(g*g+h*h)+0.34;16(k>0){7 l=a.k*a.k/k;n.2f.1D+=g/k*l;n.2f.1t+=h/k*l}}}};7 m=c.1a;1k(i=0;i<m;i++){7 o=c[i];7 p=o.25;7 q=o.1T;7 g=p.2x-q.2x;7 h=p.2y-q.2y;7 k=17.1B(g*g+h*h)+0.34;7 r=k*k/a.k;16(k>0){p.2f.1D-=g/k*r;p.2f.1t-=h/k*r;q.2f.1D+=g/k*r;q.2f.1t+=h/k*r}};1k(7 i=0;i<e;i++){7 n=b[i];7 d=17.1B(n.2x*n.2x+n.2y*n.2y);7 s=0.34*a.k*a.2j.2e*d;n.2f.1D-=s*n.2x/d;n.2f.1t-=s*n.2y/d;n.2f.1D*=a.2j.1Z;n.2f.1t*=a.2j.1Z;16(!n.4N){7 g=n.2f.1D;7 h=n.2f.1t;k=17.1B(g*g+h*h);16(k>0){7 t=17.24(a.3i*a.2j.1Z,k);n.2x+=g/k*t;n.2y+=h/k*t}}}1k(7 i=0;i<e;i++){b[i].x=b[i].2x;b[i].y=b[i].2y}};7 J=14(a,b){13.1b=a;13.1A=b;13.6q=1;13.6r=1;13.4b=60;13.4c=60;13.6s=1x;13.1F=1n;13.1w=50;13.1j=1x};J.18.1P=14(){19[{'1l':'水平间距','4b':2d},{'1l':'垂直间距','4c':2d}]};J.18.1Q=14(a){16(a){13.4b=1s(a['4b'])||2d;13.4c=1s(a['4c'])||2d;13.1u()}};J.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};J.18.1R=14(){16(13.1j){13.1r()}};J.18.1u=14(){7 c=13;7 d=c.1b;7 e=d.1a;7 f=17.3j(17.1B(e))+1;7 g=17.3j(17.1B(e))+1;13.1j=1n;d=d.3E(14(a,b){7 x=(a.1V||[]).1a+(a.1M||[]).1a;7 y=(b.1V||[]).1a+(b.1M||[]).1a;16(x>y){19-1}1g 16(x<y){19 1}1g{19 0}});7 k=0;1k(7 i=0;i<f;i++){1k(7 j=0;j<g;j++){16(k>=e){1U}7 h,35;16(c.6s){h=c.5u(i,j);35=c.5v(i,j)}1g{h=c.5v(i,j);35=-c.5u(i,j)}7 l=d[k];7 m=c.1z();m.1c=h;m.1d=35;m.1o=(1.0/c.1w)*(h-l.x);m.1p=(1.0/c.1w)*(35-l.y);l.1i=m;k++}}};J.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};J.18.5u=14(a,b){19 13.6q+a*13.4b};J.18.5v=14(a,b){19 13.6r+b*13.4c};7 K=14(a,b){13.1b=a;13.1A=b;13.1X=[];13.2F=[];13.2G=[];13.2q=[];13.2r=[];13.2H=[];13.36=6t.0;13.3J=5.0;13.1j=1x};K.18.1P=14(){7 a=13.6u(13.1b.1a);19[{'1l':'区域大小','36':a}]};K.18.1Q=14(a){16(a){13.36=1s(a['36'])||3h;13.1u()}};K.18.1R=14(){7 i=0;37(i++<2d&&13.1j){13.1r()}};K.18.1u=14(){7 g=13;7 h=g.1b;7 k=h.1a;13.1j=1n;7 l=g.3J;g.1X=[];g.2H=[];g.2F=[];g.2G=[];g.2q=[];g.2r=[];h.1h(14(a){g.1X.1v(a.1e);g.2H.1v({1e:a.1e,x:a.x/(g.36/g.3J),y:a.y/(g.36/g.3J)})});7 m=[k];7 n=[k];7 o=g.6v(k);7 p=g.6w(k,o);g.6x(l,p,o,n,m);7 q=[k];7 r=[k];g.2H.1h(14(e,i){7 f=0.0,3K=0.0;g.2H.1h(14(a,j){16(i!=j){7 b=e.x-a.x;7 c=e.y-a.y;7 d=17.1B(b*b+c*c);f+=n[i][j]*(b-m[i][j]*b/d);3K+=n[i][j]*(c-m[i][j]*c/d)}});q[i]=f;r[i]=3K});g.2F=q;g.2G=r;g.2q=m;g.2r=n};K.18.1r=14(){7 a=13;7 b=a.2H.1a;7 c=0.88;7 d=0.0,3K=0.0;7 A=0.0,B=0.0,C=0.0;7 e,4O;7 f,4d,4e,4f;7 m=0;7 g=-1;1k(7 i=0;i<b;i++){7 h=(a.2F[i]*a.2F[i]+a.2G[i]*a.2G[i]);16(h>g){m=i;g=h}}16(g<c){19}7 j=a.2H[m];f=j.x;4d=j.y;1k(7 i=0;i<b;i++){16(i==m){1U}7 k=a.2H[i];7 l=f-k.x;7 n=4d-k.y;7 o=17.1B(l*l+n*n);7 p=o*(l*l+n*n);A+=a.2r[m][i]*(1.0-a.2q[m][i]*n*n/p);B+=a.2r[m][i]*(a.2q[m][i]*l*n/p);C+=a.2r[m][i]*(1.0-a.2q[m][i]*l*l/p)}d=a.2F[m];3K=a.2G[m];4O=(B*d-3K*A)/(C*A-B*B);e=-(d+B*4O)/A;4e=f+e;4f=4d+4O;a.2F[m]=a.2G[m]=0.0;1k(7 i=0;i<b;i++){16(i==m){1U}7 k=a.2H[i];7 q=f-k.x;7 r=4d-k.y;7 s=17.1B(q*q+r*r);7 t=4e-k.x;7 u=4f-k.y;7 v=17.1B(t*t+u*u);a.2F[i]-=a.2r[m][i]*(-q+a.2q[m][i]*q/s);a.2G[i]-=a.2r[m][i]*(-r+a.2q[m][i]*r/s);a.2F[i]+=a.2r[m][i]*(-t+a.2q[m][i]*t/v);a.2G[i]+=a.2r[m][i]*(-u+a.2q[m][i]*u/v);a.2F[m]+=a.2r[m][i]*(t-a.2q[m][i]*t/v);a.2G[m]+=a.2r[m][i]*(u-a.2q[m][i]*u/v)}j.x=4e;j.y=4f;7 w=a.1X.21(j.1e);7 x=a.1b[w];x.x=4e*(a.36/a.3J);x.y=4f*(a.36/a.3J)};K.18.6w=14(a,b){7 c=0;1k(7 i=0;i<a;i++){1k(7 j=i+1;j<a;j++){16(b[i][j]==3f){1U}16(b[i][j]>c){c=b[i][j]}}}1k(7 i=0;i<a;i++){1k(7 j=0;j<a;j++){16(b[i][j]==3f){b[i][j]=c}}}19 c};K.18.6x=14(a,b,c,d,e){7 L=a/b;7 f=13.2H.1a;1k(7 i=0;i<f;i++){d[i]=[f];e[i]=[f];1k(7 j=0;j<f;j++){7 g=c[i][j]*c[i][j];16(i==j){1U}d[i][j]=17.5p(f,2)*1.0/g;e[i][j]=L*c[i][j]}}};K.18.6v=14(b){7 c=13;7 d=[b];1k(7 i=0;i<b;i++){d[i]=[b];1k(7 j=0;j<b;j++){16(i==j){d[i][j]=0;1U}d[i][j]=3f}}c.1A.1h(14(a){7 i=c.1X.21(a.25.1e);7 j=c.1X.21(a.1T.1e);d[i][j]=1;d[j][i]=1});1k(7 k=0;k<b;k++){1k(7 i=0;i<b;i++){1k(7 j=i+1;j<b;j++){7 e=d[i][k]+d[k][j];16(e<d[i][j]){d[i][j]=e;d[j][i]=e}}}}19 d};K.18.6u=14(a){7 b=6y;7 c=6z;7 d=b-c;7 e=5;7 f=17.5w(3I+e);7 g=17.5w(e);7 h=f-g;7 i=17.3j(((17.5w((17.24(a,6y)/10)+e)-g)*d/h+c));19 i};7 M=14(a,b){13.1b=a;13.1A=b;13.1W=80;13.6A=1n;13.1F=1n;13.1w=50;13.1j=1x};M.18.1P=14(){19[{'1l':'层间距','1W':80}]};M.18.1Q=14(a){16(a){13.1W=1s(a['1W'])||2d;13.1u()}};M.18.1R=14(){16(13.1j){13.1r()}};M.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};M.18.1u=14(){7 c=13;7 d=c.1b;7 e=d.1a;7 f=0,4L=0,48=0;7 g=0,2O=0;13.1j=1n;d=d.3E(14(a,b){7 x=(a.1V||[]).1a+(a.1M||[]).1a;7 y=(b.1V||[]).1a+(b.1M||[]).1a;16(x<y){19-1}1g 16(x>y){19 1}1g{19 0}});7 h=c.4P(d[0]);7 i=d[0].x;7 j=d[0].y;7 k=h;7 l=1n;7 m=0;7 o=[];d.1h(14(n){16(c.4P(n)!=k){16(l&&o.1a>1){m=1}l=1x;c.5x(o,i,j,m+(k-h));o=[];k=c.4P(n)}o.1v(n)});16(o.1a>0){c.5x(o,i,j,m+(k-h))}};M.18.4P=14(a){19(a.1V||[]).1a+(a.1M||[]).1a};M.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};M.18.5x=14(c,d,e,f){7 g=13;16(g.6A){1y 1a=0;c.1h(14(n){1a+=n.1C});7 h=0;7 j=6B/1a;c.1h(14(o,i){h+=(j*o.1C)/2;7 a=0;16(i%3==1){a=o.1C*(-1)}16(i%3==2){a=o.1C}7 x=d+((g.1W*f)+a)*17.26(h*(17.1G/3L));7 y=e+((g.1W*f)+a)*17.27(h*(17.1G/3L));h+=(j*o.1C)/2;7 b=g.1z();b.1c=x;b.1d=y;b.1o=(1.0/g.1w)*(x-o.x);b.1p=(1.0/g.1w)*(y-o.y);o.1i=b})}1g{7 h=0;7 j=6B/c.1a;c.1h(14(o){7 x=d+(g.1W*(f)*17.26(h*(17.1G/3L)));7 y=e+(g.1W*(f)*17.27(h*(17.1G/3L)));7 a=g.1z();a.1c=x;a.1d=y;a.1o=(1.0/g.1w)*(x-o.x);a.1p=(1.0/g.1w)*(y-o.y);o.1i=a;h+=j})}};7 N=14(a,b){13.1b=a;13.1A=b;13.4Q={6C:17.1G,6D:1n,6E:1x,5y:1n,6F:10,3k:50,3l:1};13.1F=1n;13.1w=50;13.1j=1x};N.18.1P=14(){19[{'1l':'节点大小','3k':50},{'1l':'分层系数','3l':1}]};N.18.1Q=14(a){16(a){13.4Q.3k=1s(a['3k'])||50;13.4Q.3l=1s(a['3l'])||1}13.1u()};N.18.1R=14(){16(13.1j){13.1r()}};N.18.1u=14(){7 c=13;1y 2I=c.4Q;1y 1b=c.1b;7 d={6G:0,6H:0,w:2I.3k*5,h:2I.3k*5};1y 5z={x:d.6G+d.w/2,y:d.6H+d.h/2};1y 4g=[];1k(1y i=0;i<1b.1a;i++){1y 38=1b[i];1y 1H;1H=(38.1V||[]).1a+(38.1M||[]).1a;4g.1v({1H:1H,38:38})}4g.3E(14(a,b){19 b.1H-a.1H});1y 3l=2I.3l;1y 2k=[[]];1y 3M=2k[0];1k(1y i=0;i<4g.1a;i++){1y 3m=4g[i];16(3M.1a>0){1y 6I=17.1m(3M[0].1H-3m.1H);16(6I>=3l){3M=[];2k.1v(3M)}}3M.1v(3m)}1y 3n=2I.3k+2I.6F;16(2I.5y){1y 6J=2k.1a>0&&2k[0].1a>1;1y 6K=(17.24(d.w,d.h)/2-3n);1y 6L=6K/(2k.1a+6J?1:0);3n=17.24(3n,6L)}1y r=0;1k(1y i=0;i<2k.1a;i++){1y 28=2k[i];1y 6M=2*17.1G-2*17.1G/28.1a;1y 3o=28.3o=6M/(17.1N(1,28.1a-1));16(28.1a>1&&2I.5y){1y 5A=17.26(3o)-17.26(0);1y 5B=17.27(3o)-17.27(0);1y 6N=17.1B(3n*3n/(5A*5A+5B*5B));r=17.1N(6N,r)}28.r=r;r+=3n}16(2I.6E){1y 4R=0;1y r=0;1k(1y i=0;i<2k.1a;i++){1y 28=2k[i];1y 6O=28.r-r;4R=17.1N(4R,6O)}r=0;1k(1y i=0;i<2k.1a;i++){1y 28=2k[i];16(i===0){r=28.r}28.r=r;r+=4R}}1k(1y i=0;i<2k.1a;i++){1y 28=2k[i];1y 3o=28.3o;1y r=28.r;1k(1y j=0;j<28.1a;j++){1y 3m=28[j];1y 2O=2I.6C+(c.6D?1:-1)*3o*j;7 x=5z.x+r*17.26(2O);7 y=5z.y+r*17.27(2O);7 e=c.1z();e.1c=x;e.1d=y;e.1o=(1.0/c.1w)*(x-3m.38.x);e.1p=(1.0/c.1w)*(y-3m.38.y);3m.38.1i=e}}13.1j=1n};N.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};N.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};7 O=14(a,b,c){13.1b=a;13.1A=b;13.2m=c||10;13.1J='5C';13.1F=1n;13.1w=30;13.1j=1x};O.18.1P=14(){19[{'1l':'旋转角度',\"2m\":10},{'1l':'旋转方向','1J':[{1l:'顺时针',1H:'5C'},{1l:'逆时针',1H:'6P'}]}]};O.18.1Q=14(a){16(a){13.2m=1s(a['2m'])||10;13.1J=a['1J']||'5C'}16(13.1J=='6P'){13.2m=17.1m(13.2m)}1g{13.2m=-17.1m(13.2m)}13.1u()};O.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};O.18.1R=14(){16(13.1j){13.1r()}};O.18.1u=14(){7 f=13;13.1j=1n;7 g=17.27(-f.2m*17.1G/3L);7 h=17.26(-f.2m*17.1G/3L);7 i=0;7 j=0;f.1b.1h(14(n){7 a=n.x-i;7 b=n.y-j;7 c=(i+a*h-b*g);7 d=(j+b*h+a*g);7 e=f.1z();e.1c=c;e.1d=d;e.1o=(1.0/f.1w)*(c-n.x);e.1p=(1.0/f.1w)*(d-n.y);n.1i=e})};O.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};7 P=14(a,b,c){13.1b=a;13.1A=b;13.2v=c||1;13.1F=1n;13.1w=30;13.1j=1x};P.18.1P=14(){19[{'1l':'缩放比例','2v':1.1}]};P.18.1Q=14(a){16(a){13.2v=1s(a['2v'])||1.1}13.1u()};P.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};P.18.1R=14(){16(13.1j){13.1r()}};P.18.1u=14(){7 f=13;7 g=f.1b.1a;7 h=0,4h=0;13.1j=1n;f.1b.1h(14(n){h+=n.x;4h+=n.y});h/=g;4h/=g;f.1b.1h(14(n){7 a=(n.x-h)*f.2v;7 b=(n.y-4h)*f.2v;7 c=h+a;7 d=4h+b;7 e=f.1z();e.1c=c;e.1d=d;e.1o=(1.0/f.1w)*(c-n.x);e.1p=(1.0/f.1w)*(d-n.y);n.1i=e})};P.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};7 Q=14(a,b){13.1b=a;13.1A=b;13.4i=0.5;13.5D=89;13.5E=0.8a;13.1j=1x};Q.18.1z=14(){7 a={4j:0.0,4k:0.0,4S:0.0,4T:0.0,1D:0.0,1t:0.0};19 a};Q.18.1P=14(){19[{'1l':'区域大小','6Q':6R},{'1l':'边长度','4i':0.4l},{'1l':'收敛系数','22':10.0}]};Q.18.1Q=14(a){16(a){13.4i=1s(a['4i'])||0.4l;13.5D=1s(a['6Q'])||6R;13.5E=1s(a['22'])||10}13.1u()};Q.18.1R=14(){16(13.1j){13.1r()}};Q.18.1u=14(){7 a=13;a.1b.1h(14(n){n.1i=a.1z()});13.1j=1n};Q.18.1r=14(){7 b=13;b.1b.1h(14(n){7 a=n.1i;a.1D/=4;a.1t/=4;a.4j=a.4k=0;a.4S=a.4T=0});b.6S();b.6T();b.6U()};Q.18.6S=14(){7 l=13;l.1A.1h(14(a){7 b=a.25;7 c=a.1T;7 d=b.x-c.x;7 e=b.y-c.y;7 g=17.1B(d*d+e*e);g=(g==0)?0.6V:g;7 f=l.5E*(1-g)/g;f=f*17.5p(l.4i,2);7 h=f*d;7 i=f*e;7 j=b.1i;7 k=c.1i;j.4j+=h;j.4k+=i;k.4j+=-h;k.4k+=-i})};Q.18.6T=14(){7 i=13;i.1b.1h(14(e){7 f=0,1t=0;i.1b.1h(14(n){16(e.1e!=n.1e){7 a=e.x-n.x;7 b=e.y-n.y;7 c=a*a+b*b;16(c==0){f+=17.3N();1t+=17.3N()}1g 16(c<i.5D){7 d=1;f+=d*a/c;1t+=d*b/c}}});7 g=f*f+1t*1t;16(g>0){g=17.1B(g)/2;7 h=e.1i;h.4S+=f/g;h.4T+=1t/g}})};Q.18.6U=14(){7 c=13;c.1b.1h(14(a){7 b=a.1i;b.1D+=b.4S+b.4j;b.1t+=b.4T+b.4k;a.x+=17.1N(-5,17.24(5,b.1D));a.y+=17.1N(-5,17.24(5,b.1t))})};7 R=14(a,b,c){13.1b=a;13.1A=b;13.1C=c||3I;13.1F=1n;13.1w=30;13.1j=1x};R.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};R.18.1P=14(){19[{'1l':'半径','1C':31}]};R.18.1Q=14(a){16(a){13.1C=1s(a['1C'])||31}13.1u()};R.18.1R=14(){16(13.1j){13.1r()}};R.18.1u=14(){7 g=13;7 h=g.1b.1a;13.1j=1n;7 j=0;g.1b.1h(14(n,i){7 a=17.8b(-1+(2*i)/h);7 b=17.1B(h*17.1G)*a;7 c=17.27(a)*g.1C;7 d=c*17.27(b);7 e=17.26(a)*g.1C;7 f=g.1z();f.1c=d;f.1d=e;f.1o=(1.0/g.1w)*(d-n.x);f.1p=(1.0/g.1w)*(e-n.y);n.1i=f})};R.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};7 S=14(a,b){13.1b=a;13.1A=b;13.1X=[];13.2g=[];13.1I=80;13.29=80;13.2a=0;13.2n=0;13.1J='2J';13.1F=1n;13.1w=50;13.2o=1x;13.1j=1x};S.18.1P=14(){19[{'1l':'点间距','1I':80},{'1l':'层间距','29':49},{'1l':'排列方向','1J':[{1l:'上下',1H:'2J'},{1l:'下上',1H:'39'},{1l:'左右',1H:'5F'},{1l:'右左',1H:'4U'}]}]};S.18.1Q=14(a){16(a){13.1I=1s(a['1I'])||2d;13.29=1s(a['29'])||49;13.1J=a['1J']||'2J'}13.1X=[];13.2g=[];13.1u()};S.18.1u=14(){7 c=13;c.1b.1h(14(a){c.2l(a,[]);c.1X.1v(a.1e);7 b=c.3O(a);c.2g.1v(b)});c.3P();13.1j=1n};S.18.3O=14(g){7 h=13;7 i=[];7 j=g.1M||[];j.1h(14(a){7 b=a.1T;7 c=a.25;16(c.1e!=b.1e&&c.4m&&b.4m){7 d=h.1X.21(b.1e);7 e=h.2g[d]||[];7 f=[];e.1h(14(n){f.1v(n.1e)});16(f.21(g.1e)==-1){i.1v(b)}}});19 i};S.18.1R=14(){16(!13.2o&&13.1j){13.1r()}};S.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};S.18.3P=14(){7 b=13;7 c=b.2P();16(c.1a>0){b.3Q(c);c.1h(14(a){b.2s(a);b.2a+=a.2h/2+b.1I;b.2Q(a,b.2a)})}};S.18.2P=14(){7 b=13;7 c=[];b.1b.1h(14(a){16((a.1V||[]).1a==0){c.1v(a)}});19 c};S.18.3Q=14(e){7 f=13;7 g=0;e.1h(14(b){7 c=f.2b(b);7 d=c.1a;16(d!=0){c.1h(14(a){g+=f.2s(a)+f.1I})}g=17.1N(0,g-f.1I);b.2h=g});19 g};S.18.2s=14(b){7 c=13;7 d=0;7 e=c.2b(b);7 f=e.1a;16(f!=0){e.1h(14(a){d+=c.2s(a)+c.1I})}d=17.1N(0,d-c.1I);b.2h=d;19 d};S.18.2Q=14(a,x){7 b=13;b.2n+=b.29;b.2a=x;b.3R(a);7 c=a.2h;7 d=x-c/2;7 e;7 f;7 g=b.2b(a);g.1h(14(n){e=n.2h;f=d+e/2;b.2Q(n,f);d=d+e+b.1I});b.2n-=b.29};S.18.3R=14(a){7 b=13;7 x=b.2a;7 y=b.2n;7 c=x;16(b.1J=='39'){y=-y}1g 16(b.1J=='5F'){x=y;y=c}1g 16(b.1J=='4U'){x=-y;y=c}7 d=b.1z();d.1c=x;d.1d=y;d.1o=(1.0/b.1w)*(x-a.x);d.1p=(1.0/b.1w)*(y-a.y);a.1i=d};S.18.2b=14(a){7 b=13;7 c=b.1X.21(a.1e);7 d=b.2g[c]||[];19 d};S.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};S.18.2l=14(c,d){7 e=13;(c.1M||[]).1h(14(a){7 b=a.1T;16(c.1e==b.1e||d.21(b.1e)!=-1){e.2o=1n;19}d.1v(b.1e);e.2l(b,d)})};7 T=14(a,b){13.1b=a;13.1A=b;13.1X=[];13.2g=[];13.1I=50;13.29=50;13.2a=0;13.2n=0;13.1C=3h;13.1F=1n;13.1w=50;13.2o=1x;13.1j=1x};T.18.1P=14(){19[{'1l':'区域大小','1C':3h}]};T.18.1Q=14(a){16(a){13.1C=1s(a['1C'])||3h}13.1u()};T.18.1R=14(){16(!13.2o&&13.1j){13.1r()}};T.18.1u=14(){7 c=13;13.1j=1n;c.1X=[];c.2g=[];c.1b.1h(14(a){c.1X.1v(a.1e);7 b=c.3O(a);c.2g.1v(b);c.2l(a,[])});c.3P();c.6W()};T.18.3O=14(g){7 h=13;7 i=[];7 j=g.1M||[];j.1h(14(a){7 b=a.1T;7 c=a.25;16(c.1e!=b.1e&&c.4m&&b.4m){7 d=h.1X.21(b.1e);7 e=h.2g[d]||[];7 f=[];e.1h(14(n){f.1v(n.1e)});16(f.21(g.1e)==-1){i.1v(b)}}});19 i};T.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};T.18.6W=14(){7 a=13;7 b=a.2P();7 c=a.4V();a.5G(b,c,a.1C)};T.18.8c=14(a){a.x=10;a.y=10};T.18.5G=14(a,b,c){7 d=13;7 e=a.1a;16(e==0){19}7 f=17.1N(0,17.1G/2*(1-2.0/e));7 g=c*17.26(f)/(1+17.26(f));7 h=c-g;7 j=17.3N();1k(7 i=0;i<e;i++){7 k=a[i];7 l=i*2*17.1G/e+j;7 x=h*17.26(l);7 y=h*17.27(l);x=x+b.x;y=y+b.y;7 m=d.1z();m.1c=x;m.1d=y;m.1o=(1.0/d.1w)*(x-k.x);m.1p=(1.0/d.1w)*(y-k.y);k.1i=m;7 p={x:x,y:y};7 n=d.2b(k);d.5G(n,p,g)}};T.18.4V=14(a){7 b=13;7 c=b.6X(a);16(c==1f){19 b.4V()}19{x:c.x,y:c.y}};T.18.4V=14(){7 a=13;19{x:0,y:0}};T.18.6X=14(a){7 b=a.1V||[];16(b.1a>0){19 b[0].25}19 1f};T.18.3P=14(){7 b=13;7 c=b.2P();16(c.1a>0){b.3Q(c);c.1h(14(a){b.2s(a);b.2a+=a.2h/2+b.1I;b.2Q(a,b.2a)})}};T.18.2P=14(){7 b=13;7 c=[];b.1b.1h(14(a){16((a.1V||[]).1a==0){c.1v(a)}});19 c};T.18.3Q=14(e){7 f=13;7 g=0;e.1h(14(b){7 c=f.2b(b);7 d=c.1a;16(d!=0){c.1h(14(a){g+=f.2s(a)+f.1I})}g=17.1N(0,g-f.1I);b.2h=g});19 g};T.18.2s=14(b){7 c=13;7 d=0;7 e=c.2b(b);7 f=e.1a;16(f!=0){e.1h(14(a){d+=c.2s(a)+c.1I})}d=17.1N(0,d-c.1I);b.2h=d;19 d};T.18.2Q=14(a,x){7 b=13;b.2n+=b.29;b.2a=x;b.3R(a);7 c=a.2h;7 d=x-c/2;7 e;7 f;7 g=b.2b(a);g.1h(14(n){e=n.2h;f=d+e/2;b.2Q(n,f);d=d+e+b.1I});b.2n-=b.29};T.18.3R=14(a){7 b=13;7 x=b.2a;7 y=b.2n;a.3S=x;a.3T=y};T.18.2b=14(a){7 b=13;7 c=b.1X.21(a.1e);7 d=b.2g[c]||[];19 d};T.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};T.18.2l=14(c,d){7 e=13;(c.1M||[]).1h(14(a){7 b=a.1T;16(c.1e==b.1e||d.21(b.1e)!=-1){e.2o=1n;19}d.1v(b.1e);e.2l(b,d)})};7 U=14(a,b){13.1b=a;13.1A=b;13.1X=[];13.2g=[];13.1I=50;13.29=50;13.2a=0;13.2n=0;13.1F=1n;13.1w=50;13.2o=1x;13.1j=1x};U.18.1P=14(){19[{'1l':'水平间距','1I':50},{'1l':'垂直间距','29':50}]};U.18.1Q=14(a){16(a){13.1I=1s(a['1I'])||50;13.29=1s(a['29'])||50}13.1u()};U.18.1R=14(){16(!13.2o&&13.1j){13.1r()}};U.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};U.18.1u=14(){7 c=13;13.1j=1n;c.1X=[];c.2g=[];c.1b.1h(14(a){c.1X.1v(a.1e);7 b=c.3O(a);c.2g.1v(b);c.2l(a,[])});c.3P();c.6Y()};U.18.2l=14(c,d){7 e=13;(c.1M||[]).1h(14(a){7 b=a.1T;16(c.1e==b.1e||d.21(b.1e)!=-1){e.2o=1n;19}d.1v(b.1e);e.2l(b,d)})};U.18.3O=14(f){7 g=13;7 h=[];7 i=f.1M||[];i.1h(14(a){7 b=a.1T;16(f.1e!=b.1e&&b.4m){7 c=g.1X.21(b.1e);7 d=g.2g[c]||[];7 e=[];d.1h(14(n){e.1v(n.1e)});16(e.21(f.1e)==-1){h.1v(b)}}});19 h};U.18.3P=14(){7 b=13;7 c=b.2P();16(c.1a>0){b.3Q(c);c.1h(14(a){b.2s(a);b.2a+=a.2h/2+b.1I;b.2Q(a,b.2a)})}};U.18.2P=14(){7 b=13;7 c=[];b.1b.1h(14(a){16((a.1V||[]).1a==0){c.1v(a)}});19 c};U.18.3Q=14(e){7 f=13;7 g=0;e.1h(14(b){7 c=f.2b(b);7 d=c.1a;16(d!=0){c.1h(14(a){g+=f.2s(a)+f.1I})}g=17.1N(0,g-f.1I);b.2h=g});19 g};U.18.2s=14(b){7 c=13;7 d=0;7 e=c.2b(b);16(e.1a!=0){e.1h(14(a){d+=c.2s(a)+c.1I})}d=17.1N(0,d-c.1I);b.2h=d;19 d};U.18.2Q=14(a,x){7 b=13;b.2n+=b.29;b.2a=x;b.3R(a);7 c=a.2h;7 d=x-c/2;7 e;7 f;7 g=b.2b(a);g.1h(14(n){e=n.2h;f=d+e/2;b.2Q(n,f);d=d+e+b.1I});b.2n-=b.29};U.18.3R=14(a){7 b=13;7 x=b.2a;7 y=b.2n;a.3S=x;a.3T=y};U.18.2b=14(a){7 b=13;7 c=b.1X.21(a.1e);7 d=b.2g[c]||[];19 d};U.18.6Y=14(){7 e=13;7 f=e.6Z();7 g=f.x;7 h=f.y;7 i=2*17.1G/g;7 j=g/2/h;e.1b.1h(14(a){7 b=a.3S*i;7 c=(a.3T-e.29)*j;7 x=c*17.26(b);7 y=c*17.27(b);7 d=e.1z();d.1c=x;d.1d=y;d.1o=(1.0/e.1w)*(x-a.x);d.1p=(1.0/e.1w)*(y-a.y);a.1i=d})};U.18.6Z=14(){7 b=13;7 c=0,4W=0;b.1b.1h(14(a){16(!a.3S){a.3S=b.2a}16(!a.3T){a.3T=b.2n}c=17.1N(c,a.3S);4W=17.1N(4W,a.3T)});19{x:c,y:4W}};U.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};7 V=14(a,b){13.1b=a;13.1A=b;13.3p=50;13.1F=1n;13.1w=50;13.2o=1x;13.1j=1x};V.18.1P=14(){19[{'1l':'节点大小','3p':50}]};V.18.1Q=14(a){16(a){13.3p=1s(a['3p'])||50}13.1u()};V.18.1u=14(){7 a=13;7 b=a.2P();b[0].5H=b[0].x=3h;b[0].35=b[0].y=31;a.5I(b[0],a.3p);a.1E(b[0],a.3p*3);13.1j=1n};V.18.5I=14(b,c){7 d=13;c=(c==1f?d.3p:c);7 e=d.2b(b);7 f=e.1a;16(f<=1){b.5J=0;b.5K=c;b.5L=c}e.1h(14(a){d.5I(a,c)});16(f>1){7 g=e[0];7 h=g.5L;16(f==2){f=3}7 i=17.1G/f;7 j=h/17.27(i);b.5K=j;b.5L=j+h;b.5J=i*2}};V.18.1E=14(e,f){7 g=13;7 h=g.2b(e);7 i=h.1a;7 j=e.5J;7 r=e.5K;7 k={x:e.5H,y:e.35};h.1h(14(a,b){7 s=17.27(j*b),c=17.26(j*b),x=s*r,y=c*r;x=17.3j(x+k.x);y=17.3j(y+k.y);a.5H=x;a.35=y;7 d=g.1z();d.1c=x;d.1d=y;d.1o=(1.0/g.1w)*(x-a.x);d.1p=(1.0/g.1w)*(y-a.y);a.1i=d;g.1E(a,f)})};V.18.1R=14(){16(!13.2o&&13.1j){13.1r()}};V.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};V.18.2P=14(){7 b=13;7 c=[];b.1b.1h(14(a){16((a.1V||[]).1a==0){c.1v(a)}b.2l(a,[])});19 c};V.18.2l=14(c,d){7 e=13;(c.1M||[]).1h(14(a){7 b=a.1T;16(c.1e==b.1e||d.21(b.1e)!=-1){e.2o=1n;19}d.1v(b.1e);e.2l(b,d)})};V.18.2b=14(a){7 b=13;7 c=[];16(!a){19 c}(a.1M||[]).1h(14(l){c.1v(l.1T)});19 c};V.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};V.18.2l=14(c,d){7 e=13;(c.1M||[]).1h(14(a){7 b=a.1T;16(c.1e==b.1e||d.21(b.1e)!=-1){e.2o=1n;19}d.1v(b.1e);e.2l(b,d)})};7 W=14(a,b){13.1b=a;13.1A=b;13.4n=[6z,8d];13.2z=0.9;13.4X=0.9;13.4o=49;13.4p=0.5M;13.2c=-8e;13.2e=0.4l;13.2O=0.8;13.5N=[];13.5O=[];13.4q=[];13.3U=1x;13.1j=1x};W.18.1P=14(){19[{'1l':'斥力','70':0.95},{'1l':'边长度','4o':4M},{'1l':'边强度','4p':0.5M},{'1l':'引力','2c':-71},{'1l':'重力','2e':0.4l},{'1l':'避免重叠','3U':[{1l:'否',1H:'1x'},{1l:'是',1H:'1n'}]}]};W.18.1Q=14(a){16(a){13.4X=1s(a['70'])||0.95;13.4o=1s(a['4o'])||4M;13.4p=1s(a['4p'])||0.5M;13.2c=1s(a['2c'])||-71;13.2e=1s(a['2e'])||0.4l;13.3U=a['3U']||'1x';13.1u()}};W.18.1R=14(){16(13.1j){13.1r()}};W.18.1u=14(){7 d=13;7 i,j,n=d.1b.1a,m=d.1A.1a,w=d.4n[0],h=d.4n[1],4r=[],o;d.4q=[];1k(i=0;i<n;++i){(o=d.1b[i]).4Y=i;o.3V=0;o.3q=o.x;o.3r=o.y;d.4q[i]=d.2c}1k(i=0;i<m;++i){o=d.1A[i];7 e=o.25;7 f=o.1T;d.5N[i]=d.4o;d.5O[i]=d.4p;++e.3V;++f.3V}13.1j=1n;14 46(a,b){7 c=72(i),j=-1,m=c.1a,x;37(++j<m){16(!4Z(x=c[j][a])){19 x}}19 17.3N()*b};14 72(){1k(j=0;j<n;++j){4r[j]=[]}1k(j=0;j<m;++j){7 o=d.1A[j];4r[o.25.4Y].1v(o.1T);4r[o.1T.4Y].1v(o.25)}19 4r[i]};19 13.73()};W.18.1r=14(){13.5P()};W.18.5Q=14(x){7 a=13;16(!5R.1a){19 a.2z}16(a.2z){16(x>0){a.2z=x}1g{a.2z=0}}1g 16(x>0){a.5P()}19 13};W.18.73=14(){19 13.5Q(0.8)};W.18.8f=14(){19 13.5Q(0)};W.18.5P=14(){7 h=13;16((h.2z*=.99)<.6V){h.2z=0.34;19}7 n=h.1b.1a,m=h.1A.1a,q,i,o,s,t,l,k,x,y;1k(i=0;i<m;++i){o=h.1A[i];s=o.25;t=o.1T;x=t.x-s.x;y=t.y-s.y;16(l=(x*x+y*y)){l=h.2z*h.5O[i]*((l=17.1B(l))-h.5N[i])/l;x*=l;y*=l;t.x-=x*(k=s.3V/(t.3V+s.3V));t.y-=y*k;s.x+=x*(k=1-k);s.y+=y*k}}16(k=h.2z*h.2e){x=h.4n[0]/2;y=h.4n[1]/2;i=-1;16(k){37(++i<n){o=h.1b[i];o.x+=(x-o.x)*k;o.y+=(y-o.y)*k}}}16(h.2c){h.5S(q=h.5T(h.1b),h.2z,h.4q);i=-1;37(++i<n){16(!(o=h.1b[i]).4N){q.2p(74(o))}}}i=-1;37(++i<n){o=h.1b[i];16(o.4N){16(!o.8g){o.x=o.3q;o.y=o.3r}1g{o.3q=o.x;o.3r=o.y}}1g{o.x-=(o.3q-(o.3q=o.x))*h.4X;o.y-=(o.3r-(o.3r=o.y))*h.4X;16(h.3U=='1n'){q.2p(75(o))}}}14 74(g){19 14(a,b,c,d,e){16(a.20!==g){7 f=a.5U-g.x,1t=a.3s-g.y,3t=1/17.1B(f*f+1t*1t);16((d-b)*3t<h.2O){7 k=a.2c*3t*3t;g.3q-=f*k;g.3r-=1t*k;19 1n}16(a.20&&8h(3t)){7 k=a.76*3t*3t;g.3q-=f*k;g.3r-=1t*k}}19!a.2c}};14 75(f){7 r=(f.1C*f.2i)+1,77=f.x-r,78=f.x+r,79=f.y-r,7a=f.y+r;19 14(a,b,c,d,e){16(a.20&&(a.20!==f)){7 x=f.x-a.20.x,y=f.y-a.20.y,l=17.1B(x*x+y*y),r=(f.1C*f.2i)+a.20.1C;16(l<r){l=(l-r)/l*.5;f.x-=x*=l;f.y-=y*=l;a.20.x+=x;a.20.y+=y}}19 b>78||d<77||c>7a||e<79}}};W.18.5S=14(a,b,d){7 e=13;7 f=0,3s=0;a.2c=0;16(!a.3W){7 g=a.1b,n=g.1a,i=-1,c;37(++i<n){c=g[i];16(c==1f){1U}e.5S(c,b,d);a.2c+=c.2c;f+=c.2c*c.5U;3s+=c.2c*c.3s}}16(a.20){16(!a.3W){a.20.x+=17.3N()-.5;a.20.y+=17.3N()-.5}7 k=e.2z*e.4q[a.20.4Y];a.2c+=a.76=k;f+=k*a.20.x;3s+=k*a.20.y}a.5U=f/a.2c;a.3s=3s/a.2c};W.18.5T=14(h,j,k,l,m){7 o=13;7 p,i=-1,n=h.1a;16(n&&4Z(h[0].x)){h=h.8i(14(p){19{x:p[0],y:p[1]}})}16(5R.1a<5){16(5R.1a===3){m=l=k;k=j}1g{j=k=3f;l=m=-3f;37(++i<n){p=h[i];16(p.x<j){j=p.x}16(p.y<k){k=p.y}16(p.x>l){l=p.x}16(p.y>m){m=p.y}}7 q=l-j,1t=m-k;16(q>1t){m=k+q}1g{l=j+1t}}};14 3u(n,p,a,b,c,d){16(4Z(p.x)||4Z(p.y)){19}16(n.3W){7 v=n.20;16(v){16((17.1m(v.x-p.x)+17.1m(v.y-p.y))<.34){4s(n,p,a,b,c,d)}1g{n.20=1f;4s(n,v,a,b,c,d);4s(n,p,a,b,c,d)}}1g{n.20=p}}1g{4s(n,p,a,b,c,d)}};14 4s(n,p,a,b,c,d){7 e=(a+c)*.5,2R=(b+d)*.5,5V=p.x>=e,5W=p.y>=2R,i=(5W<<1)+5V;n.3W=1x;n=n.1b[i]||(n.1b[i]={3W:1n,1b:[],20:1f});16(5V){a=e}1g{c=e}16(5W){b=2R}1g{d=2R}3u(n,p,a,b,c,d)};14 3X(f,a,b,c,d,e){16(!f(a,b,c,d,e)){7 g=(b+d)*.5,2R=(c+e)*.5,2S=a.1b;16(2S[0]){3X(f,2S[0],b,c,g,2R)}16(2S[1]){3X(f,2S[1],g,c,d,2R)}16(2S[2]){3X(f,2S[2],b,2R,g,e)}16(2S[3]){3X(f,2S[3],g,2R,d,e)}}};7 r={3W:1n,1b:[],20:1f};r.3Y=14(p){3u(r,p,j,k,l,m)};r.2p=14(f){3X(f,r,j,k,l,m)};h.1h(r.3Y);19 r};7 X=14(f,g){13.1b=f;13.1A=g;13.5X=5;13.7b=0.5;13.7c=7d;13.7e=3I;13.1j=1x;7 h=1/51;7 k;7 l;7 m;7 n=0;7 o=51;7 p=0;7 q=10;7 r=13;7 s=f.1a;7 t=g.1a;13.1P=14(){19[{'1l':'吸引力','2Z':2},{'1l':'斥力','22':2d}]};13.1Q=14(a){16(a){5X=1s(a['2Z'])||2;m=1s(a['22'])||2d;r.1u()}};13.1u=14(){p=10.0;n=0;k=r.5X*m;l=r.7b*m;r.1j=1n};13.1R=14(){16(r.1j){r.1r()}};13.1r=14(){16(p>(1/51)){7 i,j,2T,2A,22,3v;1k(i=0;i<s;i++){7 a=r.1b[i];a.1E=a.1E||{};16(i===0){a.1E.2U=1q 2B()}a.1E.22=0;a.1E.2K=a.1E.2K||1q 2B().5Y(a);1k(j=i+1;j<s;j++){7 b=r.1b[j];16(i!=j){b.1E=b.1E||{};b.1E.2K=b.1E.2K||1q 2B().5Y(b);2T=a.1E.2K.2V().3Z(b.1E.2K);2A=17.1N(h,17.1B(2T.2V().3w(2T).52()));22=(l*l)/2A;a.1E.22+=22;b.1E.22+=22;16(i===0){b.1E.2U=1q 2B()}3v=2T.2V().3w(1q 2B().4t(22/2A));a.1E.2U.3Y(3v);b.1E.2U.3Z(3v)}}}1k(i=0;i<t;i++){7 c=r.1A[i];2T=c.25.1E.2K.2V().3Z(c.1T.1E.2K);2A=17.1N(h,17.1B(2T.2V().3w(2T).52()));22=(2A*2A)/k;c.25.1E.22-=22;c.1T.1E.22+=22;3v=2T.2V().3w(1q 2B().4t(22/2A));c.1T.1E.2U.3Y(3v);c.25.1E.2U.3Z(3v)}1k(i=0;i<s;i++){7 d=r.1b[i];2A=17.1N(h,17.1B(d.1E.2U.2V().3w(d.1E.2U).52()));d.1E.2K.3Y(d.1E.2U.2V().3w(1q 2B().4t(17.24(2A,p)/2A)));7 e=1q 2B(d.x,d.y,0);e.3Z(d.1E.2K).7f(1q 2B().4t(q));d.x-=e.x;d.y-=e.y}p*=(1-(n/o));n++}}};14 2B(x,y){13.x=x||0;13.y=y||0};8j.8k(2B.18,{8l:14(x,y){13.x=x;13.y=y;19 13},4t:14(a){13.x=a;13.y=a;19 13},5Y:14(v){13.x=v.x||0;13.y=v.y||0;19 13},2V:14(){19 1q 13.8m(13.x,13.y,13.z)},3Y:14(v){13.x+=v.x;13.y+=v.y;19 13},8n:14(s){13.x+=s;13.y+=s;19 13},3Z:14(v){13.x-=v.x;13.y-=v.y;19 13},3w:14(v){13.x*=v.x;13.y*=v.y;19 13},7f:14(v){13.x/=v.x;13.y/=v.y;19 13},52:14(){19 13.x+13.y},8o:14(v){19((v.x===13.x)&&(v.y===13.y))}});7 Y=14(a,b){13.1b=a;13.1A=b;13.1W=2d;13.2W=60;13.53=0;13.1J=\"2J\";13.3a=\"5Z\";13.4u=-1;13.61=0;13.1F=1n;13.1j=1x};Y.18.1P=14(){19[{'1l':'层间距','1W':2d},{'1l':'点间距','2W':2d},{'1l':'排列方式','3a':[{1l:'连线方向',1H:'5Z'},{1l:'度大小',1H:'54'},{1l:'指定点',1H:'55'}]},{'1l':'排列方向','1J':[{1l:'上下',1H:'2J'},{1l:'下上',1H:'39'},{1l:'左右',1H:'5F'},{1l:'右左',1H:'4U'}]}]};Y.18.1Q=14(a){7 b=13;16(a){b.1W=1s(a['1W'])||2d;b.2W=1s(a['2W'])||80;b.3a=a['3a']||'54';b.1J=a['1J']||'2J'}b.1u()};Y.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};Y.18.1u=14(){7 e=13;e.4u=-1;e.61=0;e.2C=[];e.4v=1f;e.56={};e.1K={};e.3b={};e.57={};e.3x={};e.58={};e.7g={};e.4w={};e.59={};e.1O={};e.62={};e.7h();e.7i();e.1b.1h(14(a){7 b=2t(a.1e);7 c=e.1O[b];7 x=0,y=0;16(e.1J=='39'){x=c.x;y=-c.y}1g 16(e.1J=='4U'){x=-c.x;y=c.y}1g{x=c.x;y=c.y}7 d=e.1z();d.1c=x;d.1d=y;d.1o=(1.0/50)*(x-a.x);d.1p=(1.0/50)*(y-a.y);a.1i=d});e.1j=1n};Y.18.7h=14(h){7 j=13;j.1b.1h(14(a){7 b=2t(a.1e);7 c=j.63(b);j.1O[b]=c;j.2C.1v(b)});j.1A.1h(14(a,i){7 b=2t(i+1);7 c=j.7j(a.25.1e,a.1T.1e,b);j.62[b]=c;7 d=c.64;7 e=c.4x;7 f=j.1O[d];16(f.2L.21(b)==-1){f.2L.1v(b)}7 g=j.1O[e];16(g.2L.21(b)==-1){g.2L.1v(b)}});16(j.3a=='55'){7 k=j.1b.8p(14(n){19 n.55==1n});7 l=[];k.1h(14(n){l.1v(2t(n.1e))});j.4v=l}};Y.18.7i=14(){7 b=13;16(b.3a=='54'){b.3y()}1g 16(b.3a=='5Z'){b.5a()}1g 16(b.3a=='55'){b.7k()}b.2C.1h(14(a){16(b.1K[a]==1f){b.1K[a]=0}});7 c=b.7l();b.4y(\"7m\",-1);b.7n(c);b.7o()};Y.18.5a=14(){7 b=13;b.4y(\"5a\",-1);7 c=2D;b.2C.1h(14(a){16(b.1K[a]!=1f){c=17.24(b.1K[a],c)}});b.2C.1h(14(a){16(b.1K[a]!=1f){b.1K[a]=b.1K[a]-c}})};Y.18.7k=14(){7 b=13;16(b.4v==1f){b.3y()}1g{b.4v.1h(14(a){b.1K[a]=0});b.4v.1h(14(a){16(b.1O[a]!=1f){b.4y(\"3y\",a)}});b.3y()}};Y.18.63=14(a){19{1e:2t(a),2L:[],x:0,y:0}};Y.18.7j=14(a,b,c){19{1e:2t(c),64:2t(a),4x:2t(b)}};Y.18.3y=14(){7 c=13;7 d=1;37(d>0){7 e=0;c.2C.1h(14(a){7 b=c.1O[a];16(c.1K[b.1e]==1f){e=b.2L.1a<e?e:b.2L.1a}});d=e;16(d==0){19}c.2C.1h(14(a){7 b=c.1O[a];16(b.2L.1a==d){c.4y(\"3y\",b.1e)}})}};Y.18.7o=14(){7 a=13;7 b=2D,5b=-2D;7 c=2D,5c=-2D;1k(7 i=0;i<a.4u;i++){1k(7 d 65 a.3b){16(i==0&&a.3b[d]==i){7 e=a.2M(a.1O[d]);b=17.24(e,b);5b=17.1N(e,5b)}16(a.3b[d]==i+1){7 e=a.2M(a.1O[d]);c=17.24(e,c);5c=17.1N(e,5c)}}7 f=0;1k(7 d 65 a.3b){16(a.3b[d]==i+1){7 g=a.1O[d];7 e=a.2M(g);a.4z(g,e+f+a.53,-1)}}b=c+f+a.53;5b=5c+f+a.53}};Y.18.8q=14(){7 e=13;7 f=2D,5d=-2D;7 g=2D,5e=-2D;e.2C.1h(14(a){7 b=e.1O[a];g=17.24(g,b.x);5e=17.1N(5e,b.x);f=17.24(f,b.y);5d=17.1N(5d,b.y)});7 h=5e-g;7 i=5d-f;7 j=1,66=1;7 k=8r,67=6t;16(h>k){j=k/h}16(i>67){66=67/i}e.2C.1h(14(a){7 b=e.1O[a];7 c=b.x;b.x=17.3j((c-g)*j);7 d=b.y;b.y=17.3j((d-f)*66)})};Y.18.7l=14(){7 e=13;7 f={};e.2C.1h(14(a){7 b=e.1O[a];7 c=e.1K[a]==1f?0:e.1K[a];16(e.1J=='2J'||e.1J=='39'){b.y=e.1W*c}1g{b.x=e.1W*c}7 d=f[2t(c)];16(d==1f){d=[]}d.1v(b);f[2t(c)]=d});19 f};Y.18.4y=14(c,d){7 e=13;7 f=d;7 g={};7 h=0;16(f==-1){e.2C.1h(14(a){7 b=e.1O[a];16(g[a]==1f){g=e.5f(g,b,c,h);h++}})}1g{7 i=e.1O[f];g=e.5f(g,i,c,-7p)}};Y.18.5f=14(a,b,c,d){7 e=13;16(a[b.1e]==1f){16(d!=-7p){16(e.3b[b.1e]==1f){e.3b[b.1e]=d;e.4u=17.1N(d,e.4u)}}a[b.1e]=1n;7 f=b.2L.1a;1k(7 i=0;i<f;i++){7 g=b.2L[i];7 h=e.62[g];7 j=e.63();16(h.4x==b.1e){j=e.1O[h.64]}1g{j=e.1O[h.4x]}16(b.1e!=j.1e){16(c=='3y'){e.7q(b,j)}1g 16(c=='5a'){e.7r(b,j,h)}1g 16(c=='7m'){e.7s(b,j)}e.5f(a,j,c,d)}}}19 a};Y.18.7q=14(a,b){7 c=13;16(c.1K[b.1e]==1f){16(c.1K[a.1e]==1f){c.1K[a.1e]=0}c.1K[b.1e]=c.1K[a.1e]+1}};Y.18.7r=14(a,b,c){7 d=13;7 e=5t;16(d.1K[a.1e]==1f){d.1K[a.1e]=e}16(c.4x==b.1e){d.1K[b.1e]=d.1K[a.1e]+1}1g{d.1K[b.1e]=d.1K[a.1e]-1}};Y.18.7s=14(a,b){7 c=13;16(c.1K[b.1e]>c.1K[a.1e]){16(c.3x[a.1e]==1f){c.3x[a.1e]=[]}c.3x[a.1e].1v(b.1e);16(c.58[b.1e]==1f){c.58[b.1e]=[]}c.58[b.1e].1v(a.1e)}};Y.18.7n=14(a){7 b=13;1k(7 c 65 a){7 d=a[c];7 e=0;7 f=d.1a;1k(7 i=0;i<f;i++){7 g=d[i];16(b.56[g.1e]==1f){7 h=b.2W*e;16(e>0){h=b.2M(d[i-1])+b.2W}b.4z(g,h,c);b.68(g,c,h);e++}}}};Y.18.2M=14(a){7 b=13;16(b.1J=='2J'||b.1J=='39'){19 a.x}19 a.y};Y.18.4z=14(a,b,c){7 d=13;16(c!=-1){c=2t(c);16(d.4w[c]==1f){d.4w[c]=[];d.59[c]={}}16(d.59[c][a.1e]==1f){d.4w[c].1v(a);d.7g[a.1e]=d.4w[c].1a-1}d.59[c][a.1e]=1n}16(d.1J=='2J'||d.1J=='39'){a.x=b}1g{a.y=b}};Y.18.68=14(a,b,c){7 d=13;b=2t(b);16(d.57[b]!=1f){7 e=d.2M(d.1O[d.57[b]]);16(c-e<d.2W){7 f=e+d.2W-c;d.7t(a.1e,f)}}d.57[b]=a.1e;d.56[a.1e]=1n;d.7u(a,b)};Y.18.7t=14(a,b){7 c=13;16(c.1J=='2J'||c.1J=='39'){7 d=c.1O[a].x;c.1O[a].x=d+b}1g{7 e=c.1O[a].y;c.1O[a].y=e+b}};Y.18.7u=14(a,b){7 c=13;16(c.3x[a.1e]==1f){19}7 d=[];7 e=c.3x[a.1e].1a;1k(7 i=0;i<e;i++){d.1v(c.1O[c.3x[a.1e][i]])}7 f=d.1a;1k(7 i=0;i<f;i++){7 g=d[i];7 h=c.1K[g.1e];16((h>b)&&(c.56[g.1e]==1f)){7 j=0;16(i==0){j=c.2M(c.1O[a.1e])}1g{j=c.2M(d[i-1])+c.2W}c.4z(g,j,h);c.68(g,h,j)}1g 16(c.61!=0){19}}7 k=2D,5g=-2D;1k(7 i=0;i<f;i++){7 g=d[i];k=17.24(k,c.2M(g));5g=17.1N(5g,c.2M(g))}7 l=(k+5g)/2;c.4z(a,l,b)};Y.18.1R=14(){16(13.1j){13.1r()}};Y.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};7 Z=14(a,b){13.1b=a;13.1A=b;13.7v=0;13.1C=50;13.41=5;13.1F=1n;13.1w=50;13.1j=1x};Z.18.1P=14(){19[{'1l':'分支数','41':5}]};Z.18.1Q=14(a){16(a){13.41=1s(a['41'])||5}13.1u()};Z.18.1z=14(){7 a={1c:0.0,1d:0.0,1o:0.0,1p:0.0};19 a};Z.18.1u=14(){7 a=13;7 b=17.1N(13.1b.1a*6,7d);5h 4A=13.1b.1a/13.41;5h 7w=b-(13.7v+13.1C);5h 69=7w/4A;5h 2m=2*17.1G/13.41;1y j=0;1k(1y i=0;i<13.1b.1a;++i){7 c=13.1b[i];7 x=b+(13.1C+69*(i-j*4A))*17.26(2m*j+17.1G/2);7 y=b+(13.1C+69*(i-j*4A))*17.27(2m*j+17.1G/2);j=17.8s(i/4A);7 d=a.1z();d.1c=x;d.1d=y;d.1o=(1.0/a.1w)*(x-c.x);d.1p=(1.0/a.1w)*(y-c.y);c.1i=d}13.1j=1n};Z.18.1R=14(){16(13.1j){13.1r()}};Z.18.1r=14(){7 a=13;7 b=1f;7 c=a.1b;7 d=c.1a;1k(7 i=0;i<d;i++){7 n=c[i];b=n.1i;16(b==1f){1U}16(a.1F){7 e=17.1m(n.x-b.1c);7 f=17.1m((n.x+b.1o)-b.1c);16(f<e){n.x+=b.1o}1g{n.x=b.1c}e=17.1m(n.y-b.1d);f=17.1m((n.y+b.1p)-b.1d);16(f<e){n.y+=b.1p}1g{n.y=b.1d}16(n.x==b.1c&&n.y==b.1d){n.1i=1f}}1g{n.x=b.1c;n.y=b.1d;n.1i=1f}}};7 2X=14(a,b){13.1b=a;13.3z=10;13.6a=10;13.5i=1x;13.1j=1x};2X.18.1R=14(){16(13.1j){13.1r()}};2X.18.1P=14(){7 a=13;19[{'1l':'间距','3z':a.3z}]};2X.18.1Q=14(a){13.1u();16(a){13.3z=1s(a['3z'])||10}};2X.18.1u=14(){13.3z=5;13.6a=1;13.5i=1n;13.1j=1n};2X.18.1r=14(){16(13.5i){7 a=13.7x();16(a<1){13.5i=1x}}};2X.18.7x=14(){7 j=13;7 k=j.1b;7 l=j.7y();l.5j(k.8t(7z,[]));7 m,4B=0;1k(7 i=0;i<j.6a;++i){4B=0;1k(7 n=0;n<k.1a;n++){m=k[n];l.2p(7A)}16(4B<j.3z)1L}19 4B;14 7A(a){7 b=a.3A;7 c=a.2N;16(c){c.1h(7B)}1g{7 d=6b(m.x,b.7C(),b.x+b.23);7 e=6b(m.y,b.7D(),b.y+b.23);7 f=m.x-d;7 g=m.y-e;7 h=(f*f)+(g*g);19 h<(m.1C*m.1C*m.2i)}};14 6b(v,a,b){16(v<a)19 a;16(v>b)19 b;19 v};14 7B(a){7 b=k[a/2];16(b==m)19;7 c=m.x-b.x;7 d=m.y-b.y;7 e=17.1B(c*c+d*d);7 f=(b.1C*b.2i)+(m.1C*m.2i);16(f<=e)19;16(e<=0){19}7 g=(e-f)/e*0.1;7 h=c*g;7 i=d*g;m.x-=h;m.y-=i;b.x+=h;b.y+=i;4B+=17.1m(h)+17.1m(i)};14 7z(a,b){a.1v(b.x,b.y);19 a}};2X.18.7y=14(){7 k=1q 3c();7 l;7 m;7 n={5j:5j,3A:7E,8u:7F,2p:2p};19 n;14 2p(a){19 l.2p(a)};14 7F(x,y,a,b){16(2Y b!=='14'){b=8v}7 c=[];k.x=x;k.y=y;k.23=a;l.42(k,c,m,b);19 c};14 5j(a){16(!a)6c 1q 6d('6e 6f 8w 8x 1k 5T 8y 8z');16(2Y a.1a!=='5k')6c 1q 6d('6e 7G 7H 6f-8A 7I');16(a.1a%2!==0)6c 1q 6d('6e 6f 7G 8B 6g 8C 6g x,y 8D 8E 7H 8F 6g 2');m=a;l=7J(a);1k(7 i=0;i<a.1a;i+=2){l.3u(i,m)}};14 7E(){16(!l)19 8G;19 l.3A};14 7J(a){16(a.1a===0){7 b=1q 3c();19 1q 3B(b)}7 c=1s.7K;7 d=1s.7K;7 e=1s.7L;7 f=1s.7L;1k(7 i=0;i<a.1a;i+=2){7 x=a[i],y=a[i+1];16(x<c)c=x;16(x>e)e=x;16(y<d)d=y;16(y>f)f=y}7 g=17.1N(e-c,f-d);g+=2;c-=1;d-=1;7 h=g/2;7 j=1q 3c(c+h,d+h,h);19 1q 3B(j)};14 3c(x,y,b){13.x=2Y x==='5k'?x:0;13.y=2Y y==='5k'?y:0;13.23=2Y b==='5k'?b:0;13.7C=14(){19 13.x-13.23};13.7D=14(){19 13.y-13.23};13.7c=14(){19 13.23*2};13.7e=14(){19 13.23*2};13.8H=14(){19 13.x};13.8I=14(){19 13.y};13.7M=14(x,y){7 a=13.23;19 13.x-a<=x&&x<13.x+a&&13.y-a<=y&&y<13.y+a}};14 3B(g){13.3A=g;13.3d=1f;13.4C=1f;13.4D=1f;13.4E=1f;13.2N=1f;13.7N=14(){7 a=13.3A;7 b=a.23/2;13.3d=1q 3B(1q 3c(a.x-b,a.y-b,b));13.4C=1q 3B(1q 3c(a.x+b,a.y-b,b));13.4D=1q 3B(1q 3c(a.x-b,a.y+b,b));13.4E=1q 3B(1q 3c(a.x+b,a.y+b,b))};13.3u=14(a,b){7 c=13.3d===1f;16(c){16(13.2N===1f){13.2N=[a]}1g{13.2N.1v(a)}16(13.2N.1a>=4){13.7N();1k(7 i=0;i<13.2N.1a;++i){13.3u(13.2N[i],b)}13.2N=1f}}1g{7 x=b[a],y=b[a+1];7 d=13.3A;7 e=0;16(x>d.x){e+=1}16(y>d.y){e+=2}7 f=7O(13,e);f.3u(a,b)}};13.2p=14(a){16(a(13)&&13.3d){13.3d.2p(a);13.4C.2p(a);13.4D.2p(a);13.4E.2p(a)}};13.42=14(a,b,c,d){16(!d(13.3A,a))19;7 e=13.2N;16(e){1k(7 i=0;i<e.1a;++i){7 f=e[i];7 x=c[f];7 y=c[f+1];16(a.7M(x,y)){b.1v(f)}}}16(!13.3d)19;13.3d.42(a,b,c,d);13.4C.42(a,b,c,d);13.4D.42(a,b,c,d);13.4E.42(a,b,c,d)};14 7O(a,b){16(b===0)19 a.3d;16(b===1)19 a.4C;16(b===2)19 a.4D;16(b===3)19 a.4E};14 8J(a,b){19 a.x-a.23<b.x+b.23&&a.x+a.23>b.x-b.23&&a.y-a.23<b.y+b.23&&a.y+a.23>b.y-b.23}}};7 2u=14(a,b){13.1b=a;13.1A=b;13.33=3I;13.3H=51;13.1Y=2;13.1Z=5;13.1j=1x};2u.18.1P=14(){7 a=13;19[{'1l':'间距','1Y':a.1Y},{'1l':'移动速度','1Z':a.1Z}]};2u.18.1Q=14(a){13.1u();16(a){13.1Y=1s(a['1Y'])||2;13.1Z=1s(a['1Z'])||5}};2u.18.1u=14(){7 a=13;13.1Y=5t;13.1Z=5;13.1b.1h(14(n){n.1i=a.1z()});13.3i=(17.1B(a.3H*a.1Y)/10);13.k=17.1B((a.3H*a.1Y)/(1+a.1b.1a));13.1j=1n};2u.18.1R=14(){16(13.1j){13.1r()}};2u.18.1r=14(){7 a=13;a.7P();a.7Q();a.7R();a.7S()};2u.18.7P=14(){7 h=13;h.1b.1h(14(g,i){h.1b.1h(14(a,j){16(i!=j){7 b=g.x-a.x;7 c=g.y-a.y;7 d=17.1B(b*b+c*c);16(d>0){7 e=h.k*h.k/d;7 f=g.1i;f.1D+=(b/d*e*0.34);f.1t+=(c/d*e*0.34)}}})})};2u.18.7Q=14(){7 i=13;i.1A.1h(14(E){7 a=E.25;7 b=E.1T;7 c=a.x-b.x;7 d=a.y-b.y;7 e=17.1B(c*c+d*d);7 f=e*e/i.k;16(e>0){7 g=a.1i;7 h=b.1i;g.1D-=(c/e*f);g.1t-=(d/e*f);h.1D+=(c/e*f);h.1t+=(d/e*f)}})};2u.18.7R=14(){7 k=13;k.1b.1h(14(h,i){k.1b.1h(14(a,j){16(i!=j&&h.7T==a.7T){7 b=h.x-a.x;7 c=h.y-a.y;7 d=17.1B(b*b+c*c);16(d>0){7 e=d*d/k.k;7 f=h.1i;7 g=a.1i;f.1D-=b/d*e;f.1t-=c/d*e;g.1D+=b/d*e;g.1t+=c/d*e}}})})};2u.18.7S=14(){7 g=13;g.1b.1h(14(a){a.1i.1D*=g.1Z/g.33;a.1i.1t*=g.1Z/g.33;7 b=a.1i;7 c=b.1D;7 d=b.1t;7 e=17.1B(b.1D*b.1D+b.1t*b.1t);16(e>0&&!a.4N){7 f=17.24(g.3i*(g.1Z/g.33),e);a.x=(a.x+c/e*f);a.y=(a.y+d/e*f)}})};2u.18.1z=14(){7 a={1D:0.0,1t:0.0};19 a};7 5l=14(a,b){16(!a||a==1f){19}13.2j=b||{};13.6h={1b:a.1b||[],1A:a.1A||[]}};5l.18.8K=14(a){16(a==1f){19 1f}19 13.7U(a)};5l.18.7U=14(a,b){7 c=13;7 d=c.6h.1b||[];7 e=c.6h.1A||[];7 f;8L(a){1S\"8M\":f=1q N(d,e);1L;1S\"8N\":f=1q D(d,e);1L;1S\"8O\":f=1q F(d,e);1L;1S\"8P\":f=1q G(d,e);1L;1S\"2f\":f=1q H(d,e);1L;1S\"8Q\":f=1q W(d,e);1L;1S\"8R\":f=1q X(d,e);1L;1S\"8S\":f=1q I(d,e);1L;1S\"8T\":f=1q Q(d,e);1L;1S\"8U\":f=1q K(d,e);1L;1S\"8V\":f=1q z(d,e);1L;1S\"8W\":f=1q S(d,e);1L;1S\"8X\":f=1q U(d,e);1L;1S\"8Y\":f=1q T(d,e);1L;1S\"3U\":f=1q 2X(d,e);1L;1S\"8Z\":f=1q R(d,e);1L;1S\"90\":f=1q M(d,e);1L;1S\"91\":f=1q V(d,e);1L;1S\"54\":f=1q Y(d,e);1L;1S\"92\":f=1q Z(d,e);1L;1S\"2v\":f=1q P(d,e,1);1L;1S\"93\":f=1q O(d,e,0);1L;1S\"94\":f=1q J(d,e);1L;1S\"96\":f=1q 2u(d,e);1L;97:1L}16(!f){19 1f}19 f};7 5m=5l;16(2Y 7V!=='7W'&&2Y 7X==='7I'){7V.7X=5m}1g 16(2Y 5n==='14'&&(5n.98||5n.9a)){5n(14(){19 5m})}1g{13.9b=5m}}).9c(13||(2Y 7Y!=='7W'?7Y:9d));",62,572,"|||||||var||||||||||||||||||||||||||||||||||||||||||||||||||||||||||this|function||if|Math|prototype|return|length|nodes|finishx|finishy|id|null|else|forEach|layoutData|inited|for|label|abs|true|xdistance|ydistance|new|goAlgo|Number|dy|initAlgo|push|intSteps|false|let|newLayoutData|links|sqrt|radius|dx|layout|boolTransition|PI|value|distX|direction|hierarchicalLevels|break|outLinks|max|nodesIdMap|getConfig|resetConfig|runLayout|case|target|continue|inLinks|layerDistance|nodeIds|area|speed|point|indexOf|force|half|min|source|cos|sin|level|distY|currentX|getSuccessors|charge|100|gravity|fr|nodeNeighbers|sizeT|scaleX|config|levels|checkHasCycle|angle|currentY|hasCycle|visit|lij|kij|calculateNodeX|String|bb|scale|tmpprimarycirc|fr_x|fr_y|alpha|delta_length|Vector2|nodeIdList|1000000000|secondarynodecount|VECTOR_D1|VECTOR_D2|tempNodes|options|UD|tmp_pos|edgesIds|getPositionForHierarchy|items|theta|getRoots|buildNodeTree|sy|children|delta|offset|clone|nodeDistance|ba|typeof|attraction||500|outCircleNodes|SPEED_DIVISOR|01|tempY|realSize|while|node|DU|sortMethod|hierarchicalTrees|Bounds|nw|forceScale|Infinity|secondry_scale|1000|maxDisplace|round|maxNodeSize|levelWidth|val|minDist|dTheta|raduis|px|py|cy|dn|insert|change|multiply|hierarchicalChildrenReference|determineLevelsByHubsize|maxMove|bounds|TreeNode|neighborAttraction|TWO_PI|sort|cartCoors|nextCircleRaduis|AREA_MULTIPLICATOR|800|tempSize|myD2|180|currentLevel|random|initNodeNeighbers|buildTree|calculateRootsX|setCurrentPositionFor|tempx|tempy|noverlap|weight|leaf|quadtreeVisit|add|sub||nlines|query|diameter|boolfixeddiameter|cumethod|position|correct_theta|currentRoundLong|120|currentIter|horizontalScale|verticalScale|old_y|new_x|new_y|nodeValues|yMean|stretch|edgedx|edgedy|015|visible|size|linkDistance|linkStrength|charges|neighbors|insertChild|setScalar|treeIndex|selectedNodeIds|distributionOrdering|toId|crawlNetwork|setPositionForHierarchy|nodes_segment|totalMovement|ne|sw|se|deltaT|forceCutoff|minY|auto|highdegreeoutside|secondary_theta|nextLayerRoundLong|150|fixed|delta_y|getValue|defaults|rDeltaMax|repulsiondx|repulsiondy|RL|getCenter|maxy|friction|index|isNaN||100000|sum|treeSpacing|hubsize|selected|positionedNodes|lastNodeOnLevel|hierarchicalParentReference|distributionOrderingPresence|determineLevelsByDirected|maxPre|maxAfter|maxY|maxX|crawler|maxPos|const|runFlag|init|number|bc|bd|define|degree|pow|inside|primary_theta|nextLayerNodeRaduis|10000|xGridToScreen|yGridToScreen|log|renderOrbit|avoidOverlap|center|dcos|dsin|sn|repulsion_range_sq|force_multiplier|LR|setPolars|tempX|countRadius|rdegree|mradius|totalRadius|09|distances|strengths|tick|alpha1|arguments|forceAccumulate|quadtree|cx|right|bottom|attraction_multiplier|setVector|directed||continueOrBreak|edges|NodeLocal|fromId|in|ratioH|standardH|validataPositionAndContinue|step|maxIterations|clamp|throw|Error|Points|array|of|graph|neighbers|05|getForceforNode|isAdjacent|distance|autoArea|08|iterations|xOrigin|yOrigin|horizontal|3000|setCanvasSize|shortPath|getMaxDij|getKijLij|8000|1500|ajustSize|360|startAngle|clockwise|equidistant|minNodeSpacing|x1|y1|diff|firstLvlHasMulti|maxR|rStep|sweep|rMin|rDelta|ns|repulsion|1000000|relaxEdges|calculateRepulsion|moveNodes|0001|setRootPolars|getParent|setRadialLocations|getMaxXY|froce|300|neighbor|resume|repulse|collide|pointCharge|nx1|nx2|ny1|ny2|repulsion_multiplier|width|1200|height|divide|distributionIndex|setData|setupHierarchicalLayout|Edge|determineLevelsBySelected|getDistribution|generateMap|placeNodesByHierarchy|condenseHierarchy|111|levelDownstream|levelByDirection|fillInRelations|shiftBlock|placeBranchNodes|margin|segment|removeOverlaps|createTree|toFlatArray|visitTreeNode|moveIfNeeded|left|top|getBounds|getPointsAround|should|be|object|createRootNode|POSITIVE_INFINITY|NEGATIVE_INFINITY|contains|subdivide|getChild|repulsiveForce|attractiveForce|sameTypeAttractive|resetNodePosition|cluster|getLayout|module|undefined|exports|window|03||getDegree|metal|boolNoOverlap|outside|old_dx|old_dy|freeze|00000000001|2000|02|acos|setRootPolar|700|200|stop|isDragging|isFinite|map|Object|assign|set|constructor|addScalar|equals|filter|shiftToCenter|5000|floor|reduce|pointsAround|rectangularCheck|is|required|to|work|like|consist|series|coordinates|and|multiple|EmptyRegion|centerX|centerY|intersects|createLayout|switch|concentric|singleCirlce|dualCirlce|layerCircle|fastFR|frDirect|fruchtermanReingold|spring2|kk|arf|tree|radiatree|balloon|sphere|layered|topoCircle|hive|rotate|grid||gather|default|amd||cmd|LayoutFactory|call|global".split("|"),0,{}))},7146:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"ef-tooltar"},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:4}},[i("el-tooltip",{attrs:{effect:"dark",content:"上传文件",placement:"bottom-start",enterable:!1}},[i("el-button",{attrs:{type:"text",icon:"el-icon-upload2",size:"large"},on:{click:e.openUpload}})],1),i("el-divider",{attrs:{direction:"vertical"}}),i("el-tooltip",{attrs:{effect:"dark",content:"导出文件",placement:"bottom-start",enterable:!1}},[i("el-button",{attrs:{type:"text",icon:"el-icon-download",size:"large"},on:{click:e.openInfo}})],1),i("el-divider",{attrs:{direction:"vertical"}}),i("el-tooltip",{attrs:{enterable:!1,effect:"dark",content:"删除所选数据",placement:"bottom-start"}},[i("el-button",{attrs:{type:"text",icon:"el-icon-delete",size:"large",title:"删除所选数据"},on:{click:e.deleteSelect}})],1),i("el-divider",{attrs:{direction:"vertical"}}),i("el-tooltip",{attrs:{effect:"dark",content:"1:1居中显示",enterable:!1,placement:"bottom-start"}},[i("el-button",{attrs:{type:"text",icon:"el-icon-refresh",size:"large"},on:{click:function(t){return e.setZoom(0)}}})],1),i("el-divider",{attrs:{direction:"vertical"}}),i("el-tooltip",{attrs:{effect:"dark",content:"查找节点",enterable:!1,placement:"bottom-start"}},[i("el-button",{attrs:{type:"text",icon:"el-icon-search",size:"large"},on:{click:function(t){return e.$refs.nodeForm.searchInit()}}})],1),i("el-divider",{attrs:{direction:"vertical"}}),i("el-dropdown",{on:{command:e.handleCommand}},[i("span",{staticClass:"btn-link"},[e._v(" 菜单"),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{staticStyle:{"font-size":"small"},attrs:{icon:"el-icon-view",command:"showAll"}},[e._v("显示所有")]),i("el-dropdown-item",{staticStyle:{"font-size":"small"},attrs:{icon:"el-icon-camera",command:"saveImage"}},[e._v("保存图片")]),i("el-dropdown-item",{staticStyle:{"font-size":"small"},attrs:{command:"hideSuppychain",icon:"el-icon-remove-outline"}},[e._v("隐藏供应链")]),i("el-dropdown-item",{staticStyle:{"font-size":"small"},attrs:{command:"hideRisk",icon:"el-icon-remove-outline"}},[e._v("隐藏风险")]),i("el-dropdown-item",{staticStyle:{"font-size":"small"},attrs:{command:"showOneChild",icon:"el-icon-remove-outline"}},[e._v("只显示一级供应链")])],1)],1)],1),i("el-col",{attrs:{span:5}},[i("el-slider",{attrs:{"show-input":"","input-size":"mini",min:30,max:300,step:10,"format-tooltip":e.formatTooltip},model:{value:e.scale,callback:function(t){e.scale=t},expression:"scale"}})],1),i("el-col",{attrs:{span:14}},[i("div",{staticStyle:{float:"right","line-height":"41px"}},[i("el-button",{attrs:{type:"primary",plain:"",round:"",icon:"el-icon-edit-outline",size:"mini"},on:{click:function(t){return e.$refs.nodeForm.layoutInit(e.layoutSetting)}}},[e._v("布局设置")]),i("el-button",{attrs:{type:"primary",plain:"",round:"",icon:"el-icon-sort",size:"mini"},on:{click:function(t){return e.autoLayout(null,!0)}}},[e._v("自动布局")]),i("el-button",{attrs:{type:"warning",plain:"",round:"",icon:"el-icon-close",size:"mini"},on:{click:e.emptyGraph}},[e._v("清空画布")]),i("el-button",{attrs:{type:"info",plain:"",round:"",icon:"el-icon-document",size:"mini"},on:{click:e.openHelp}},[e._v("帮助")])],1)])],1)],1),i("div",{staticClass:"main"},[i("node-menu",{ref:"nodeMenu"}),i("div",{ref:"efContainer",staticClass:"container",attrs:{id:"efContainer"},on:{drop:e.addNodeForGraph,dragover:function(e){e.preventDefault()},contextmenu:function(t){return t.preventDefault(),e.globalClickedDispatch(t)}}}),i("el-popover",{attrs:{placement:"bottom",width:"180",trigger:"manual",tabindex:-1,"close-delay":0,"open-delay":20},model:{value:e.nodeDetailVisible,callback:function(t){e.nodeDetailVisible=t},expression:"nodeDetailVisible"}},["SERVICE"===e.hoverNodeType?i("div",[i("span",{staticStyle:{"font-weight":"bold","font-size":"13px"}},[e._v(e._s(e.currentService.name))]),(e.currentService.is_online,i("el-tag",{staticStyle:{"margin-left":"5px"},attrs:{size:"mini"}},[e._v("在线")])),i("div",{staticStyle:{"font-size":"12px"}},[i("div",{staticStyle:{color:"#909399",margin:"5px 0 8px 0"}},[e._v(" "+e._s(e.currentService.desc)+" ")]),i("span",[e._v("实例数:"+e._s(e.currentService.instance_count))]),i("span",{staticStyle:{float:"right"}},[e._v("by "+e._s(e.currentService.teamname))])])],1):"RISK"===e.hoverNodeType?i("div",[i("span",{staticStyle:{"font-weight":"bold","font-size":"13px"}},[e._v(e._s(e.currentRisk.vulnerability))]),i("el-tag",{staticStyle:{"margin-left":"5px"},attrs:{size:"mini"}},[e._v(e._s(e.currentRisk.type))]),i("div",{staticStyle:{"font-size":"12px"}},[i("div",{staticStyle:{color:"#909399",margin:"5px 0 8px 0"}},[e._v(" 影响范围:"+e._s(e.currentRisk.affect)+" ")]),i("el-tag",{attrs:{type:e.risk2flag[e.currentRisk.risk],effect:"dark",size:"mini"}},[e._v(e._s(e.risk2level[e.currentRisk.risk])+" ")]),i("span",{staticStyle:{float:"right"}},[e._v(" "+e._s(e.currentRisk.publishedDate))])],1)],1):e._e(),i("div",{staticStyle:{"z-index":"-1",position:"absolute"},attrs:{slot:"reference",id:"nodeDetail"},slot:"reference"})]),i("flow-node-form",{ref:"nodeForm",on:{deleteNode:e.deleteNode,deleteLink:e.deleteLink,autoLayout:e.autoLayout,setNodeStyle:e.setNodeStyle,setLinkStyle:e.setLinkStyle,searchNode:e.searchNode}})],1),e.flowUploadVisible?i("flow-upload",{ref:"flowUpload",on:{uploadGraph:e.uploadGraphFromXml}}):e._e(),e.flowInfoVisible?i("flow-info",{ref:"flowInfo",attrs:{data:e.infoData},on:{downloadData:e.downloadData}}):e._e(),e.flowHelpVisible?i("flow-help",{ref:"flowHelp"}):e._e()],1)},s=[],a=i("c7eb"),o=i("b85c"),r=i("1da1"),l=i("5530"),h=(i("b0c0"),i("9911"),i("4de4"),i("d3b7"),i("c7cd"),i("25f0"),i("159b"),i("caad"),i("2532"),i("d81d"),i("99af"),i("fb6a"),i("a434"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"flow-menu"},e._l(e.menuList,(function(t){return i("div",{key:t.id},[i("span",{staticClass:"ef-node-pmenu ef-node-form-header",on:{click:function(e){t.open=!t.open}}},[i("i",{class:{"el-icon-caret-bottom":t.open,"el-icon-caret-right":!t.open}}),e._v(" "+e._s(t.label))]),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"menu.open"}],staticClass:"ef-node-menu-ul"},e._l(t.children,(function(t){return i("li",{key:t.id,staticClass:"ef-node-menu-li",class:t.type,attrs:{type:t.type,draggable:"true"},on:{dragstart:function(i){return e.move(i,t.type)},dragend:e.end}},[i("i",{class:t.ico}),e._v(" "+e._s(t.label)+" ")])})),0)])})),0)}),c=[],d=(i("e9c4"),{left:-1,top:-1}),u={components:{},data:function(){return{menuList:[{id:"1",type:"serve-node",label:"服务节点",ico:"el-icon-ali-yunfuwuqi",color:"64,158,255",open:!0,children:[{id:"11",type:"SERVICE",label:"服务",ico:"el-icon-ali-yunfuwuqi"}]},{id:"2",type:"external-service-node",label:"外部服务节点",color:"26,185,211",ico:"el-icon-video-play",open:!0,children:[{id:"21",type:"ACCESS",label:"数据接入",ico:"el-icon-ali-shujujieru"},{id:"22",type:"INTERFACE",label:"接口调用",ico:"el-icon-ali-jiekouguanli"}]},{id:"3",type:"supplychain-node",label:"供应链节点",ico:"el-icon-video-pause",color:"103,194,58",open:!0,children:[{id:"31",type:"SOFTWARE",label:"软件",ico:"el-icon-ali-ruanjian-"},{id:"32",type:"COMPONENT",label:"组件",ico:"el-icon-ali-zujianguanli"}]},{id:"5",type:"risk",label:"风险",color:"245,108,108",ico:"el-icon-video-play",open:!0,children:[{id:"51",type:"RISK",label:"风险",ico:"el-icon-ali-fengxian"}]}]}},created:function(){this.isFirefox()&&(document.body.ondrop=function(e){d.left=e.layerX,d.top=e.clientY-50,e.preventDefault(),e.stopPropagation()})},methods:{getMenuByType:function(e){for(var t=0;t<this.menuList.length;t++)for(var i=this.menuList[t].children,n=0;n<i.length;n++)if(i[n].type===e)return Object(l["a"])(Object(l["a"])({},i[n]),{},{color:this.menuList[t].color})},move:function(e,t){var i=this.getMenuByType(t);i.offsetX=e.offsetX,i.offsetY=e.offsetY,i=JSON.stringify(i),e.dataTransfer.setData("nodeInfo",i)},end:function(e){e.dataTransfer.clearData()},isFirefox:function(){var e=navigator.userAgent;return e.indexOf("Firefox")>-1}}},f=u,p=(i("2b55"),i("2877")),b=Object(p["a"])(f,h,c,!1,null,null,null),g=b.exports,v=i("bfa9"),y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"帮助",visible:e.dialogVisible,width:"70%",customClass:"flowHelp"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-tabs",{attrs:{"tab-position":"left"}},[i("el-tab-pane",{attrs:{label:"如何新增"}},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("如何新增节点")]),i("div",[e._v("按住鼠标拖拽左侧组件到中间画布中松开鼠标即可")]),i("el-divider",{attrs:{"content-position":"left"}},[e._v("如何复制节点")]),i("div",[e._v(" 右键需要复制的节点，选择复制节点或按快捷键ctrl+c。在需要粘贴的位置，右键选择粘贴节点，或按快捷键ctrl+v。 ")])],1),i("el-tab-pane",{attrs:{label:"如何删除"}},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("删除单个节点")]),i("div",[e._v(" 右键需要删除的节点，选择删除节点，或键盘Delete键，或右侧编辑框选择删除按钮。 ")]),i("el-divider",{attrs:{"content-position":"left"}},[e._v("批量删除")]),i("div",[e._v(" 右键画布空白处切换鼠标模式为框选，或按住ctrl键，框选需要删除的节点，点击左上角的删除图标，或键盘Delete键。 ")])],1),i("el-tab-pane",{attrs:{label:"如何连线"}},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("如何连线")]),i("div",[e._v("右键需要添加连线的节点，点击开始连线")])],1),i("el-tab-pane",{attrs:{label:"如何修改"}},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("如何修改单个节点标签")]),i("div",[e._v(" 点击需要更改的节点，在页面右侧会出现一个表单，输入新的标签，点击【保存】。 ")]),i("el-divider",{attrs:{"content-position":"left"}},[e._v("如何修改多个节点标签")]),i("div",[e._v(" 右键画布空白处切换鼠标模式为框选，或按住ctrl键，框选或单击需要修改的节点，在右侧编辑栏设置。 ")]),i("el-divider",{attrs:{"content-position":"left"}},[e._v("如何修改单个连线标签")]),i("div",[e._v(" 点击画布中的连线，在页面右侧会出现一个表单，输入新的条件，点击【保存】 ")])],1),i("el-tab-pane",{attrs:{label:"如何展开"}},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("如何隐藏、展开子流程")]),i("div",[e._v("双击父流程，即可自动展开、收缩子流程。")])],1),i("el-tab-pane",{attrs:{label:"如何布局"}},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("如何自动编排节点")]),i("div",[e._v(" 右键画布空白处，在页面右侧会出现一个表单，选择布局方式并输入参数，点击应用。 ")])],1),i("el-tab-pane",{attrs:{label:"如何存储"}},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("导入流程图数据文件")]),i("div",[e._v(" 点击左上角的"),i("i",{staticClass:"el-icon-upload2"}),e._v("按钮即可导入流程图数据文件，文件必须为JSON格式。 ")]),i("el-divider",{attrs:{"content-position":"left"}},[e._v("下载流程图数据")]),i("div",[e._v(" 点击左上角的"),i("i",{staticClass:"el-icon-download"}),e._v("按钮，或右键画布空白处点击导出即可下载流程图文件到本地。 ")])],1),i("el-tab-pane",{attrs:{label:"更多"}},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("项目信息")]),i("div",[e._v(" 请参考:"),i("el-link",[e._v("https://gitee.com/xiaoka2017/easy-flow-sdk")])],1),i("div",[e._v("以及"),i("el-link",[e._v("https://gitee.com/baopengdu/GraphVis")])],1)],1)],1)],1)},m=[],x={data:function(){return{dialogVisible:!1}},components:{},methods:{init:function(){this.dialogVisible=!0}}},k=x,w=(i("d55b"),Object(p["a"])(k,y,m,!1,null,null,null)),L=w.exports,E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"upload-dialog",attrs:{title:"上传图数据",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-alert",{staticClass:"upload-alert",attrs:{title:"请导入GraphXML文件",type:"info",closable:!1,center:""}},[i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:"",limit:1,"auto-upload":!1,"on-exceed":e.handleExceed,"before-upload":e.beforeUpload,"file-list":e.fileList}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击导入")])])])],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.cancel}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.submitUpload}},[e._v("确 定")])],1)],1)},S=[],C=i("5892"),I={components:{},data:function(){return{dialogVisible:!1,file:null,fileList:[]}},methods:{init:function(){this.dialogVisible=!0},handleExceed:function(){this.$message.warning("仅支持导入一个文件！")},beforeUpload:function(e){var t=this,i="text/xml"===e.type;if(!i)return this.$message.error("导入文件只能是GraphXML格式!"),!1;var n=new FileReader;n.readAsText(e),n.onload=function(){try{var e=Object(C["b"])(n.result)}catch(i){return t.$message.error("GraphXML解析失败！请导入有效的XML文件"),!1}return e.nodes&&e.links?(t.$emit("uploadGraph",e,!1),!1):(t.$message.error("导入失败！请输入有效的图数据文件"),!1)}},submitUpload:function(){this.$refs.upload.submit()},cancel:function(){this.$refs.upload.clearFiles(),this.dialogVisible=!1}}},N=I,M=(i("07a8"),Object(p["a"])(N,E,S,!1,null,null,null)),T=M.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-card",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"box-card",attrs:{shadow:"hover"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v(e._s(e.title))]),i("el-button",{staticStyle:{float:"right",padding:"2px 0"},attrs:{icon:"el-icon-close",type:"text"},on:{click:e.closeForm}})],1),i("el-form",{directives:[{name:"show",rawName:"v-show",value:"search"===e.type,expression:"type === 'search'"}],ref:"dataForm",attrs:{"label-position":"right","label-width":"70px",size:"medium",model:e.search}},[i("el-form-item",{attrs:{label:"节点名称"}},[i("el-input",{attrs:{clearable:""},model:{value:e.search.nodeLabel,callback:function(t){e.$set(e.search,"nodeLabel",t)},expression:"search.nodeLabel"}})],1),i("el-button",{staticClass:"applyButton",attrs:{type:"primary"},on:{click:function(t){return e.searchNode(e.search.nodeLabel)}}},[e._v("查找")])],1),i("el-form",{directives:[{name:"show",rawName:"v-show",value:"layout"===e.type,expression:"type === 'layout'"}],ref:"dataForm",attrs:{"label-position":"right","label-width":"70px",size:"medium",model:e.layout}},[i("el-form-item",{attrs:{label:"布局方式"}},[i("el-select",{attrs:{placeholder:"层次布局"},model:{value:e.layout.type,callback:function(t){e.$set(e.layout,"type",t)},expression:"layout.type"}},[i("el-option",{attrs:{label:"层次布局",value:"hubsize"}}),i("el-option",{attrs:{label:"树形布局",value:"tree"}}),i("el-option",{attrs:{label:"快速弹力布局",value:"fastFR"}})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"tree"===e.layout.type,expression:"layout.type === 'tree'"}]},[i("el-form-item",{attrs:{label:"点间距"}},[i("el-input",{attrs:{type:"number",min:"100"},model:{value:e.layout.tree.distX,callback:function(t){e.$set(e.layout.tree,"distX",t)},expression:"layout.tree.distX"}})],1),i("el-form-item",{attrs:{label:"层间距"}},[i("el-input",{attrs:{type:"number",min:"100"},model:{value:e.layout.tree.distY,callback:function(t){e.$set(e.layout.tree,"distY",t)},expression:"layout.tree.distY"}})],1),i("el-form-item",{attrs:{label:"排列方向"}},[i("el-select",{attrs:{placeholder:"左右"},model:{value:e.layout.tree.direction,callback:function(t){e.$set(e.layout.tree,"direction",t)},expression:"layout.tree.direction"}},[i("el-option",{attrs:{label:"左右",value:"LR"}}),i("el-option",{attrs:{label:"上下",value:"UD"}})],1)],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"hubsize"===e.layout.type,expression:"layout.type === 'hubsize'"}]},[i("el-form-item",{attrs:{label:"层间距"}},[i("el-input",{attrs:{type:"number",min:"100"},model:{value:e.layout.hubsize.layerDistance,callback:function(t){e.$set(e.layout.hubsize,"layerDistance",t)},expression:"layout.hubsize.layerDistance"}})],1),i("el-form-item",{attrs:{label:"点间距"}},[i("el-input",{attrs:{type:"number",min:"100"},model:{value:e.layout.hubsize.nodeDistance,callback:function(t){e.$set(e.layout.hubsize,"nodeDistance",t)},expression:"layout.hubsize.nodeDistance"}})],1),i("el-form-item",{attrs:{label:"排列方式"}},[i("el-select",{attrs:{placeholder:"连线方向"},model:{value:e.layout.hubsize.sortMethod,callback:function(t){e.$set(e.layout.hubsize,"sortMethod",t)},expression:"layout.hubsize.sortMethod"}},[i("el-option",{attrs:{label:"度大小",value:"hubsize"}}),i("el-option",{attrs:{label:"连线方向",value:"directed"}}),i("el-option",{attrs:{label:"根节点",value:"selected"}})],1)],1),i("el-form-item",{attrs:{label:"排列方向"}},[i("el-select",{attrs:{placeholder:"左右"},model:{value:e.layout.hubsize.direction,callback:function(t){e.$set(e.layout.hubsize,"direction",t)},expression:"layout.hubsize.direction"}},[i("el-option",{attrs:{label:"左右",value:"LR"}}),i("el-option",{attrs:{label:"上下",value:"UD"}})],1)],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"fastFR"==e.layout.type,expression:"layout.type == 'fastFR'"}]},[i("el-form-item",{attrs:{label:"斥力"}},[i("el-input",{attrs:{type:"number"},model:{value:e.layout.fastFR.force,callback:function(t){e.$set(e.layout.fastFR,"force",t)},expression:"layout.fastFR.force"}})],1),i("el-form-item",{attrs:{label:"边长度"}},[i("el-input",{attrs:{type:"number"},model:{value:e.layout.fastFR.linkDistance,callback:function(t){e.$set(e.layout.fastFR,"linkDistance",t)},expression:"layout.fastFR.linkDistance"}})],1),i("el-form-item",{attrs:{label:"边强度"}},[i("el-input",{attrs:{type:"number"},model:{value:e.layout.fastFR.linkStrength,callback:function(t){e.$set(e.layout.fastFR,"linkStrength",t)},expression:"layout.fastFR.linkStrength"}})],1),i("el-form-item",{attrs:{label:"引力"}},[i("el-input",{attrs:{type:"number"},model:{value:e.layout.fastFR.charge,callback:function(t){e.$set(e.layout.fastFR,"charge",t)},expression:"layout.fastFR.charge"}})],1),i("el-form-item",{attrs:{label:"重力"}},[i("el-input",{attrs:{type:"number"},model:{value:e.layout.fastFR.gravity,callback:function(t){e.$set(e.layout.fastFR,"gravity",t)},expression:"layout.fastFR.gravity"}})],1),i("el-form-item",{attrs:{label:"避免重叠"}},[i("el-select",{model:{value:e.layout.fastFR.noverlap,callback:function(t){e.$set(e.layout.fastFR,"noverlap",t)},expression:"layout.fastFR.noverlap"}},[i("el-option",{attrs:{label:"是",value:!0}}),i("el-option",{attrs:{label:"否",value:!1}})],1)],1)],1),i("el-button",{staticClass:"applyButton",attrs:{type:"primary"},on:{click:function(t){return e.autoLayout(e.layout)}}},[e._v("应用")])],1),i("el-form",{directives:[{name:"show",rawName:"v-show",value:"node"===e.type,expression:"type === 'node'"}],ref:"nodeForm",attrs:{rules:e.nodeRules,model:e.node,"label-width":"53px",size:"medium"}},[i("el-form-item",{attrs:{label:"类型"}},[i("el-input",{attrs:{disabled:""},model:{value:e.node.type,callback:function(t){e.$set(e.node,"type",t)},expression:"node.type"}})],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"SERVICE"===e.node.type,expression:"node.type === 'SERVICE'"}],attrs:{label:"服务",prop:"label"}},[i("el-select",{directives:[{name:"focus",rawName:"v-focus",value:{text:e.node.label},expression:"{ text: node.label }"}],attrs:{disabled:null!=e.node.serviceId,filterable:"",remote:"",placeholder:"请选择服务","popper-append-to-body":!1,"remote-method":e.remoteServiceSearch,loading:e.loading,"value-key":"name"},model:{value:e.node.label,callback:function(t){e.$set(e.node,"label",t)},expression:"node.label"}},e._l(e.services,(function(t){return i("el-option",{key:t.id,staticClass:"tag-option",attrs:{label:t.name,value:t.name},nativeOn:{click:function(i){return e.handleSelectService(t)}}})})),1)],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"RISK"===e.node.type,expression:"node.type === 'RISK'"}],attrs:{label:"风险",prop:"label"}},[i("el-select",{directives:[{name:"focus",rawName:"v-focus",value:{text:e.node.label},expression:"{ text: node.label }"}],attrs:{filterable:"","value-key":"vulnerability",disabled:null!=e.node.riskId,remote:"",placeholder:"请选择风险","popper-append-to-body":!1,"remote-method":e.remoteRiskSearch,loading:e.loading},model:{value:e.node.label,callback:function(t){e.$set(e.node,"label",t)},expression:"node.label"}},e._l(e.risks,(function(t){return i("el-option",{key:t.id,staticClass:"tag-option",attrs:{label:t.vulnerability,value:t.vulnerability},nativeOn:{click:function(i){return e.handleSelectRisk(t)}}})})),1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"SOFTWARE"===e.node.type||"COMPONENT"===e.node.type,expression:"node.type === 'SOFTWARE' || node.type === 'COMPONENT'"}]},[i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"SOFTWARE"===e.node.type,expression:"node.type === 'SOFTWARE'"}],attrs:{label:"软件",prop:"label"}},[i("el-select",{directives:[{name:"focus",rawName:"v-focus",value:{text:e.node.label},expression:"{ text: node.label }"}],attrs:{filterable:"","value-key":"artifactId",remote:"",placeholder:"请选择软件","popper-append-to-body":!1,"remote-method":e.remoteSupplychainSearch,loading:e.loading},model:{value:e.node.label,callback:function(t){e.$set(e.node,"label",t)},expression:"node.label"}},e._l(e.supplychains,(function(t){return i("el-option",{key:t.id,staticClass:"tag-option",attrs:{label:t.artifactId,value:t.artifactId},nativeOn:{click:function(i){return e.handleArtifactIdSelected(t)}}})})),1)],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"COMPONENT"===e.node.type,expression:"node.type === 'COMPONENT'"}],attrs:{label:"组件",prop:"label"}},[i("el-select",{directives:[{name:"focus",rawName:"v-focus",value:{text:e.node.label},expression:"{ text: node.label }"}],attrs:{filterable:"","value-key":"artifactId",remote:"",placeholder:"请选择组件","popper-append-to-body":!1,"remote-method":e.remoteSupplychainSearch,loading:e.loading},model:{value:e.node.label,callback:function(t){e.$set(e.node,"label",t)},expression:"node.label"}},e._l(e.supplychains,(function(t){return i("el-option",{key:t.id,staticClass:"tag-option",attrs:{label:t.artifactId,value:t.artifactId},nativeOn:{click:function(i){return e.handleArtifactIdSelected(t)}}})})),1)],1),i("el-form-item",{attrs:{label:"厂商",prop:"groupId"}},[i("el-select",{attrs:{"value-key":"groupId",placeholder:"请选择厂商","popper-append-to-body":!1,loading:e.loading},model:{value:e.node.groupId,callback:function(t){e.$set(e.node,"groupId",t)},expression:"node.groupId"}},e._l(e.groupIds,(function(t){return i("el-option",{key:t.id,staticClass:"tag-option",attrs:{label:t.groupid,value:t.groupid},nativeOn:{click:function(i){return e.handleGroupIdSelected(t)}}})})),1)],1),i("el-form-item",{attrs:{label:"版本",prop:"version"}},[i("el-select",{attrs:{"value-key":"version",placeholder:"请选择版本号","popper-append-to-body":!1,loading:e.loading},on:{change:e.handleVersionChange},model:{value:e.node.version,callback:function(t){e.$set(e.node,"version",t)},expression:"node.version"}},e._l(e.versions,(function(e){return i("el-option",{key:e.v_id,staticClass:"tag-option",attrs:{label:e.version,value:e.version}})})),1)],1)],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"RISK"!=e.node.type&&"COMPONENT"!=e.node.type&&"SOFTWARE"!=e.node.type&&"SERVICE"!=e.node.type,expression:"\n        node.type != 'RISK' &&\n        node.type != 'COMPONENT' &&\n        node.type != 'SOFTWARE' &&\n        node.type != 'SERVICE'\n      "}],attrs:{label:"名称",prop:"label"}},[i("el-input",{directives:[{name:"focus",rawName:"v-focus",value:{text:e.node.label},expression:"{ text: node.label }"}],attrs:{clearable:""},model:{value:e.node.label,callback:function(t){e.$set(e.node,"label",t)},expression:"node.label"}})],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"SERVICE"!=e.node.type&&"RISK"!=e.node.type,expression:"node.type != 'SERVICE' && node.type != 'RISK'"}],attrs:{label:"标签"}},[e._l(e.node.tags,(function(t){return i("el-tag",{key:t,attrs:{"disable-transitions":"",closable:""},on:{close:function(i){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),i("el-autocomplete",{directives:[{name:"show",rawName:"v-show",value:e.tagInputVisible,expression:"tagInputVisible"}],ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small","fetch-suggestions":e.suggestTag,"popper-append-to-body":!1},on:{select:e.handleTagSelect,change:e.handleTagInput},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item;return[i("span",{staticClass:"tag-option"},[e._v(e._s(n.value))])]}}]),model:{value:e.tagInputValue,callback:function(t){e.tagInputValue=t},expression:"tagInputValue"}}),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.tagInputVisible,expression:"!tagInputVisible"}],staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showTagInput}},[e._v("+ New Tag")])],2),i("div",{staticClass:"form-buttons"},[i("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-check"},on:{click:e.setNodeStyle}},[e._v("保存")]),i("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteNode}},[e._v("删除")])],1)],1),i("el-form",{directives:[{name:"show",rawName:"v-show",value:"link"===e.type,expression:"type === 'link'"}],ref:"linkForm",attrs:{model:e.link,"label-width":"53px",rules:e.linkRules}},[i("el-form-item",{attrs:{label:"标签",prop:"label"}},[i("el-input",{directives:[{name:"focus",rawName:"v-focus",value:{text:e.link.label},expression:"{ text: link.label }"}],attrs:{clearable:"",placeholder:"请输入连线关系"},model:{value:e.link.label,callback:function(t){e.$set(e.link,"label",t)},expression:"link.label"}})],1),i("div",{staticClass:"form-buttons"},[i("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-check"},on:{click:e.setLinkStyle}},[e._v("保存")]),i("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteLink}},[e._v("删除")])],1)],1)],1)},j=[],A=i("2909"),P=(i("ac1f"),i("5319"),i("ad8f")),R=i("61f7"),D={data:function(){var e=this;return{visible:!1,title:"布局信息",type:"",layout:{tree:{},fastFR:{},hubsize:{}},search:{},node:{},link:{},services:[],risks:[],supplychains:[],groupIds:[],versions:[],tagOptions:[],loading:!1,tagInputVisible:!1,tagInputValue:"",linkRules:{label:[{required:!0,message:"请输入连线关系!",trigger:"blur"},{validator:R["b"]}]},nodeRules:{label:[{required:!0,message:"请填写节点信息!",trigger:"blur"}],groupId:[{validator:function(t,i,n){"SOFTWARE"!==e.node.type&&"COMPONENT"!==e.node.type||i&&""!==i||n(new Error("请选择厂商信息!")),n()},trigger:"blur"}],version:[{validator:function(t,i,n){"SOFTWARE"!==e.node.type&&"COMPONENT"!==e.node.type||i&&""!==i||n(new Error("请选择版本!")),n()},trigger:"blur"}]}}},watch:{},mounted:function(){this.tagOptions=this.fetchTags()},directives:{focus:{update:function(e,t){""===t.value.text&&(e.querySelector("select")?e.querySelector("select").focus():e.querySelector("input").focus())}}},methods:{fetchTags:function(){return[{value:"WEB"},{value:"LINUX"},{value:"SERVER"},{value:"MODULE"}]},suggestTag:function(e,t){var i=this.tagOptions,n=e?i.filter(this.createFilter(e)):i;t(n)},createFilter:function(e){return function(t){return-1!=t.value.toLowerCase().indexOf(e.toLowerCase())}},getColorRgb:function(e){return e=e&&e.length>0?e.replace("rgb(","").replace(")",""):null,e},nodeInit:function(e){if(this.tagOptions=this.fetchTags(),this.title="节点信息",this.visible=!0,this.type="node",this.node={type:e.type,label:e.label,tags:Object(A["a"])(e.properties.tags)},this.node.version=e.properties.version||"",this.node.serviceId=e.properties.serviceId,this.node.serviceNodeId=e.properties.serviceNodeId,this.node.riskId=e.properties.riskId,this.node.riskNodeId=e.properties.riskNodeId,"SERVICE"===this.node.type&&"服务"===this.node.label)this.node.label="";else if("RISK"===this.node.type&&"风险"===this.node.label)this.node.label="";else if("COMPONENT"===this.node.type&&"组件"===this.node.label)this.node.label="";else if("SOFTWARE"===this.node.type&&"软件"===this.node.label)this.node.label="";else if("SOFTWARE"===this.node.type||"COMPONENT"===this.node.type){var t=this.node.label.lastIndexOf(".");this.node.groupId=this.node.label.slice(0,t),this.node.label=this.node.label.slice(t+1)}this.link={}},linkInit:function(e){this.title="连线信息",this.visible=!0,this.type="link",this.link={label:e.label||""},this.node={}},layoutInit:function(e){this.title="布局信息",this.visible=!0,this.type="layout",this.layout=e,this.node={},this.link={}},searchInit:function(){this.title="查找节点",this.visible=!0,this.type="search",this.node={},this.link={}},closeForm:function(){this.visible=!1},deleteNode:function(){this.$emit("deleteNode")},deleteLink:function(){this.$emit("deleteLink")},autoLayout:function(e){this.$emit("autoLayout",e,!0)},searchNode:function(e){this.$emit("searchNode",e)},setLinkStyle:function(){var e=this;this.$refs.linkForm.validate((function(t){if(!t)return!1;e.$emit("setLinkStyle",e.link)}))},setNodeStyle:function(){var e=this;this.$refs.nodeForm.validate((function(t){if(!t)return!1;e.$emit("setNodeStyle",e.node)}))},handleClose:function(e){this.node.tags.splice(this.node.tags.indexOf(e),1)},showTagInput:function(){var e=this;this.tagInputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleTagInput:function(){var e=this.tagInputValue;e&&-1==this.node.tags.indexOf(e)&&this.node.tags.push(e),this.tagInputVisible=!1,this.tagInputValue=""},handleTagSelect:function(e){-1==this.node.tags.indexOf(e.value)&&this.node.tags.push(e.value),this.tagInputVisible=!1,this.tagInputValue=""},handleSelectService:function(e){var t=this;Object(P["k"])({label:"ServiceId="+e.id}).then((function(i){i.node&&i.node.length>0?(t.node.serviceNodeId=i.node[0].id,t.node.serviceId=e.id):t.$message.error("未找到该服务节点")}))},handleSelectRisk:function(e){var t=this;this.node.riskId=e.id,Object(P["k"])({label:"RiskId="+e.id}).then((function(e){e.node&&e.node.length>0?t.node.riskNodeId=e.node[0].id:t.node.riskNodeId=null}))},remoteRiskSearch:function(e){var t=this;""!==e?(this.loading=!0,Object(P["p"])({keyword:e}).then((function(e){t.risks=e.results,t.loading=!1}))):(this.risks=[],this.loading=!1)},remoteServiceSearch:function(e){var t=this;""!==e?(this.loading=!0,Object(P["m"])({keyword:e}).then((function(e){t.services=e.services,t.loading=!1}))):(this.services=[],this.loading=!1)},remoteSupplychainSearch:function(e){var t=this;""!==e?(this.loading=!0,Object(P["n"])({artifactId:e,rowPerPage:1e3,page:1}).then((function(e){e.TotalCount>0?t.supplychains=e.project:t.supplychains=[],t.loading=!1}))):(this.supplychains=[],this.loading=!1)},handleArtifactIdSelected:function(e){""!=this.node.label&&(this.groupIds=this.supplychains.filter((function(t){return t.artifactId===e.artifactId})),this.handleGroupIdSelected(e))},handleGroupIdSelected:function(e){var t=this;this.node.groupId=e.groupid,this.node.version="",Object(P["o"])({artifactId:e.artifactId,groupId:e.groupid}).then((function(e){e.versions&&e.versions.length>0?t.versions=e.versions:t.versions=[]}))},handleVersionChange:function(e){e?this.$set(this.node,this.node.version,e):this.$set(this.node,this.node.version,"")}}},z=D,_=(i("0649"),Object(p["a"])(z,O,j,!1,null,"13abb0c0",null)),B=_.exports,G=i("88b5"),X=i.n(G),F=i("83d6"),Y=i.n(F),V=i("6d29"),q=i.n(V),W=i("2f62"),H=i("df4a"),$={components:{nodeMenu:g,FlowInfo:v["a"],FlowNodeForm:B,FlowHelp:L,FlowUpload:T},computed:Object(l["a"])({},Object(W["b"])(["sidebar"])),data:function(){return{visGraph:null,infoData:"",flowInfoVisible:!1,flowFormVisible:!1,flowHelpVisible:!1,flowUploadVisible:!1,nodeDetailVisible:!1,deleteNodeWarning:!0,copiedNode:null,mouseEvent:void 0,onMouseOver:!1,layoutSetting:{},currentService:{},currentRisk:{},hoverNodeType:"",scale:100,risk2flag:{C:"danger",M:"warning",H:"warning",L:"info"},risk2level:{C:"Critical",M:"Medium",H:"High",L:"Low"}}},watch:{sidebar:{handler:function(e,t){var i=document.getElementsByTagName("canvas")[0];e.opened?i.width-=200:i.width+=200,this.visGraph.refresh()},deep:!0},scale:{handler:function(e,t){this.visGraph.scene.scaleX=e/100,this.visGraph.scene.scaleY=e/100,this.visGraph.refresh()}},"visGraph.scene.scaleX":function(e,t){e>=3&&(this.visGraph.scene.scaleX=3),e<=.3&&(this.visGraph.scene.scaleX=.3),this.scale=Math.round(100*e)}},mounted:function(){var e=this;if(this.initVisgraph(),this.$route.params.name){var t={};switch(this.$route.params.option){case"root":t={root:this.$route.params.name};break;case"rootName":t={rootName:this.$route.params.name};break;case"end":t={end:this.$route.params.name};break;case"endName":t={endName:this.$route.params.name};break}Object(P["j"])(t).then((function(i){i.nodes&&0!=i.nodes.length?e.uploadGraph(i,!0):"rootName"===e.$route.params.option&&e.$route.query.serviceId&&Object(P["c"])({label:"SERVICE",name:e.$route.params.name}).then((function(i){"Succeed"===i.result?Object(P["b"])({id:i.id,label:"ServiceId="+e.$route.query.serviceId}).then((function(i){"Succeed"===i.result?Object(P["j"])(t).then((function(t){e.uploadGraph(t,!0)})):e.$message({message:"ServiceId添加出错",type:"warning"})})):e.$message({message:"节点添加出错",type:"error"})}))}))}},beforeRouteLeave:function(e,t,i){var n=this;return Object(r["a"])(Object(a["a"])().mark((function e(){var t,s,o;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i(),e.abrupt("return");case 5:if((s=t.n()).done){e.next=28;break}if(o=s.value,"RISK"!==o.type||"风险"!==o.label){e.next=11;break}return n.$message.error("图中含有未选择的风险节点!"),i(!1),e.abrupt("return");case 11:if("SOFTWARE"!=o.type||"软件"!==o.label){e.next=15;break}return n.$message.error("图中含有未选择的软件!"),i(!1),e.abrupt("return");case 15:if("COMPONENT"!=o.type||"组件"!==o.label){e.next=19;break}return n.$message.error("图中含有未选择的组件!"),i(!1),e.abrupt("return");case 19:if(0!=(o.inLinks||[]).length||0!=(o.outLinks||[]).length){e.next=26;break}if(!n.$route.params.rootName||"SERVICE"!==o.type||o.label!==n.$route.params.rootName){e.next=23;break}e.next=26;break;case 23:return n.$message.error("图中含有孤立节点!"),i(!1),e.abrupt("return");case 26:e.next=5;break;case 28:e.next=33;break;case 30:e.prev=30,e.t0=e["catch"](3),t.e(e.t0);case 33:return e.prev=33,t.f(),e.finish(33);case 36:if(0!==n.visGraph.nodes.length){e.next=40;break}i(),e.next=42;break;case 40:return e.next=42,n.$confirm("将离开工作区，是否保存当前修改并离开？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1,closeOnHashChange:!1}).then((function(){i()})).catch((function(){i(!1)}));case 42:case"end":return e.stop()}}),e,null,[[3,30,33,36]])})))()},methods:{initVisgraph:function(){var e=this,t=Y.a.workspace;this.layoutSetting=Y.a.layout,t.node.onClick=function(t,i){return e.$refs.nodeForm.nodeInit(i)},t.link.onClick=function(t,i){return e.$refs.nodeForm.linkInit(i)},t.noElementClick=function(){e.visGraph.currentNode||e.visGraph.currentLink||e.$refs.nodeForm.closeForm()},t.node.ondblClick=function(t,i){return e.toggleChildNode(i)},t.node.onMouseOver=function(t,i){return e.showNodeDetail(t,i)},t.node.onMouseOut=function(t,i){return e.closeNodeDetail(t,i)},t.node.onMousedrag=function(t,i){return e.closeNodeDetail(t,i)},t.link.beforebegainAddLine=function(t,i){return e.isAllowedAddLink(t,i)},t.link.afterbegainAddLine=function(t){return e.addDefaultLink(t)},this.visGraph=new X.a(document.getElementById("efContainer"),t),this.setZoom("auto")},showNodeDetail:function(e,t){var i=this;this.onMouseOver=!0,0==this.nodeDetailVisible&&"SERVICE"===t.type&&t.properties.serviceId?Object(P["m"])({id:t.properties.serviceId}).then((function(e){i.currentService=e.services,i.currentService?(i.hoverNodeType="SERVICE",i.onMouseOver&&(i.nodeDetailVisible=!0)):console.error("showNodeDetail函数出错，找不到该服务id".concat(serviceId))})):0==this.nodeDetailVisible&&"RISK"===t.type&&t.properties.riskId&&Object(P["p"])({keyword:t.label}).then((function(e){if(0!==e.totalCount){if(i.currentRisk=e.results.filter((function(e){return e.id==t.properties.riskId})),!(i.currentRisk.length>0))return i.currentRisk={},void console.error("showNodeDetail函数出错，找不到该风险".concat(t.label));i.currentRisk=i.currentRisk[0],i.onMouseOver&&(i.hoverNodeType="RISK",i.nodeDetailVisible=!0)}else console.error("showNodeDetail函数出错，找不到该风险".concat(t.label))}));var n=document.getElementById("nodeDetail"),s=this.visGraph.scene.scaleX/this.visGraph.stage.pixelRatio,a=t.x+this.visGraph.scene.translateX,o=t.y+this.visGraph.scene.translateY,r=(this.visGraph.scene.scaleX-1)*(a-this.visGraph.canvas.width/2),l=(this.visGraph.scene.scaleY-1)*(o-this.visGraph.canvas.height/2);n.style.left=(a+r)/this.visGraph.stage.pixelRatio+120+"px",n.style.top=(o+l)/this.visGraph.stage.pixelRatio+43+"px",n.style.width=140*s+"px",n.style.height=40*s+"px",n.style.display="block"},closeNodeDetail:function(e,t){this.nodeDetailVisible=!1,this.onMouseOver=!1,document.getElementById("nodeDetail").style.display="none"},globalClickedDispatch:function(e){var t=this;if(this.visGraph.currentLink||this.visGraph.currentNode||this.$refs.nodeForm.closeForm(),this.visGraph.currentLink&&!this.visGraph.currentLink.selected&&this.$refs.nodeForm.closeForm(),this.visGraph.currentNode&&!this.visGraph.currentNode.selected&&this.$refs.nodeForm.closeForm(),2===e.button)if(this.visGraph.drawLinkFlag=!1,this.visGraph.virNode.show&&(this.visGraph.virNode.show=!1,this.visGraph.scene.remove(this.visGraph.virLink)),this.visGraph.virLink&&(this.visGraph.scene.remove(this.visGraph.virLink),this.visGraph.virLink=null,this.visGraph.currentNode=null),this.visGraph.currentNode&&this.visGraph.currentNode.selected){var i=!0,n=this.visGraph.currentNode;("SERVICE"!==n.type||n.properties.serviceNodeId)&&("RISK"!==n.type||n.properties.riskNodeId)||(i=!1);var s=[];n.properties.serviceNodeId?s.push({label:"查看该服务",icon:"el-icon-view",onClick:function(){return t.$router.push({path:"/workspace/rootName/"+n.label})}}):n.properties.version&&s.push({label:"查看供应链",icon:"el-icon-view",onClick:function(){return t.$router.push({path:"/workspace/rootName/"+n.label})}}),i&&s.length>0&&s.push({label:"开始连线",icon:"el-icon-right",onClick:function(){return t.addLink()}}),s.length>0?this.$contextmenu({items:s,event:e,zIndex:3}):i&&this.addLink()}else this.visGraph.currentLink&&this.visGraph.currentLink.selected&&this.$contextmenu({items:[{label:"删除连线",icon:"el-icon-delete",onClick:function(){return t.deleteLink()}}],event:e,customClass:"custom-class",zIndex:3})},formatTooltip:function(e){return e/100},addNodeForGraph:function(e){var t=e.dataTransfer.getData("nodeInfo");t=JSON.parse(t),Object(H["a"])([t],!1),this.addNodeForDrag(t)},addNodeForDrag:function(e){var t=this;this.visGraph.stage.removeEventListener("mousemove"),this.visGraph.stage.mousemove((function(i){var n=t.visGraph.scene.toSceneEvent(i);t.visGraph.stage.removeEventListener("mousemove"),t.visGraph.stage.mousemove((function(e){t.mouseEvent=t.visGraph.scene.toSceneEvent(e)})),e.id=null==e.id?t.visGraph.nodeIdIndex++:e.id,e.x=n.x-e.offsetX*t.visGraph.stage.pixelRatio,e.y=n.y-e.offsetY*t.visGraph.stage.pixelRatio;var s=t.visGraph.newNode(e);s.fixed=!0,"RISK"!=s.type&&"SERVICE"!=s.type?t.addNodePromise(s).then((function(e){s.id=e,t.visGraph.nodes.push(s),t.visGraph.scene.add(s),t.visGraph.refresh()})):(s.id=Math.random().toString(36).substr(3,10),t.visGraph.nodes.push(s),t.visGraph.scene.add(s),t.visGraph.refresh())}))},pasteNode:function(e){var t=this,i={label:this.copiedNode.label,color:this.copiedNode.fillColor,properties:Object(l["a"])({},this.copiedNode.properties),x:e.x-70,y:e.y-20,type:this.copiedNode.type};"SERVICE"!=i.type&&"RISK"!=i.type&&("contextmenu"===e.type&&(i.x=e.offsetX-this.visGraph.scene.translateX+70,i.y=e.offsetY-this.visGraph.scene.translateY+20),this.addNodePromise(i).then((function(e){i.id=e,t.visGraph.addNode(i)})))},getUUID:function(){return Math.random().toString(36).substr(3,10)},goToService:function(){this.$router.push({name:"service"})},hideType:function(e){var t=this;this.visGraph.links.forEach((function(i){if(!e.includes(i.source.type)&&e.includes(i.target.type)){var n=[];t.deepFindChildNode(i.target,n),n.push(i.target),t.contractChild(i.source,n)}}))},showOneChild:function(e){var t=this;this.visGraph.links.forEach((function(i){if(!e.includes(i.source.type)&&e.includes(i.target.type)){var n=[];i.target.outLinks||(i.target.outLinks=[]),i.target.outLinks.forEach((function(i){if(e.includes(i.target.type)){var s=[];t.deepFindChildNode(i.target,s),s.push(i.target),n.push.apply(n,s)}})),t.contractChild(i.target,n)}}))},deepFindChildNode:function(e,t){var i=this,n=e.outLinks||[],s=n.map((function(e){return e.target}));s.forEach((function(e){return t.push(e)})),s.forEach((function(e){return!e.contract&&i.deepFindChildNode(e,t)}))},toggleChildNode:function(e){e=e||this.visGraph.currentNode,e.contract&&1==e.contract?this.expendChild(e):this.contractChild(e)},contractSupplychain:function(){var e=this,t=["COMPONENT","SOFTWARE"];this.visGraph.links.forEach((function(i){if(!t.includes(i.source.type)&&t.includes(i.target.type)){var n=[];e.deepFindChildNode(i.target,n),e.contractChild(i.target,n)}}))},showAll:function(){var e=this;this.visGraph.nodes.forEach((function(t){t.contract&&1==t.contract&&e.expendChild(t)}))},addLink:function(e){e=e||this.visGraph.currentNode,e&&this.visGraph.begainAddLine(this.visGraph.currentNode)},searchNode:function(e){this.visGraph.findNode(e),this.$refs.nodeForm.closeForm()},setNodeStyle:function(e){var t=this;return Object(r["a"])(Object(a["a"])().mark((function i(){var n,s,r,l,h,c,d,u,f,p;return Object(a["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=t.visGraph.currentNode,"SERVICE"!==n.type||!e.serviceId||!e.serviceNodeId){i.next=9;break}return n.label=e.label,n.properties.serviceId=e.serviceId,n.properties.serviceNodeId=e.serviceNodeId,t.visGraph.refresh(),i.abrupt("return");case 9:if("RISK"!==n.type||!e.riskId){i.next=27;break}if(n.label=e.label,n.properties.riskId=e.riskId,e.riskNodeId){i.next=23;break}return i.next=15,t.addNodePromise(n);case 15:return s=i.sent,n.properties.riskNodeId=s,n.id=s,i.next=20,t.addLabelPromise("RiskId="+e.riskId,n);case 20:return i.abrupt("return");case 23:n.properties.riskNodeId=e.riskNodeId;case 24:return i.abrupt("return");case 27:e.groupId&&(e.label=e.groupId+"."+e.label);case 28:if(r=[],l=[],""!=e.version&&(n.properties.version?n.properties.version!=e.version&&(l.push("Version="+n.properties.version),r.push("Version="+e.version)):r.push("Version="+e.version)),e.tags){h=Object(o["a"])(e.tags);try{for(h.s();!(c=h.n()).done;)d=c.value,-1==n.properties.tags.indexOf(d)&&r.push(d)}catch(a){h.e(a)}finally{h.f()}}if(n.properties.tags){u=Object(o["a"])(n.properties.tags);try{for(u.s();!(f=u.n()).done;)p=f.value,-1==e.tags.indexOf(p)&&l.push(p)}catch(a){u.e(a)}finally{u.f()}}return i.prev=33,i.next=36,t.addLabelsAsync(r,n);case 36:i.next=41;break;case 38:i.prev=38,i.t0=i["catch"](33),console.error("SetNodeStyle函数出错".concat(i.t0));case 41:return i.prev=41,i.next=44,t.deleteLabelsAsync(l,n);case 44:i.next=49;break;case 46:i.prev=46,i.t1=i["catch"](41),console.error("SetNodeStyle函数出错".concat(i.t1));case 49:n.label!=e.label&&Object(P["t"])({id:n.id,name:e.label}).then((function(e){"Succeed"===e.result?(n.label=e.node.name,t.visGraph.refresh()):t.$message.error("节点更新失败")}));case 50:case"end":return i.stop()}}),i,null,[[33,38],[41,46]])})))()},setLinkStyle:function(e){var t=this,i=this.visGraph.currentLink;if("SERVICE"!==i.target.type||i.target.properties.serviceNodeId)if("RISK"!==i.target.type||i.target.properties.riskNodeId){if(i.id)Object(P["u"])({id:i.id,type:e.label,startId:i.source.properties.serviceNodeId||i.source.properties.riskNodeId||i.source.id,endId:i.target.properties.serviceNodeId||i.target.properties.riskNodeId||i.target.id}).then((function(n){"Succeed"===n.result?(i.label=e.label,i.id=n.relation.id,i.showlabel=!0):t.$message.error("关系更新失败")}));else{var n=i.source.properties.serviceNodeId||i.source.properties.riskNodeId||i.source.id,s=i.target.properties.serviceNodeId||i.target.properties.riskNodeId||i.target.id;this.addLinkPromise(e.label,n,s).then((function(t){i.label=e.label,i.id=t,i.showlabel=!0}))}this.visGraph.refresh()}else this.$message({showClose:!0,message:"请先选择风险！",type:"warning"});else this.$message({showClose:!0,message:"请先选择服务！",type:"warning"})},isAllowedAddLink:function(e,t){if(e.id===t.id)return!1;if("SERVICE"===t.type&&!t.properties.serviceNodeId)return this.$message.warning("请先选择服务再连线！"),!1;if("RISK"===t.type&&!t.properties.riskNodeId)return this.$message.warning("请先选择风险再连线！"),!1;var i,n=Object(o["a"])(this.visGraph.links);try{for(n.s();!(i=n.n()).done;){var s=i.value;if(s.source.id===e.id&&s.target.id===t.id||s.target.id===e.id&&s.source.id===t.id)return!1}}catch(a){n.e(a)}finally{n.f()}return!0},addDefaultLink:function(e){var t=e.source.properties.serviceNodeId||e.source.properties.riskNodeId||e.source.id,i=e.target.properties.serviceNodeId||e.target.properties.riskNodeId||e.target.id;this.addLinkPromise(e.label,t,i).then((function(t){e.id=t}))},deleteNode:function(e){var t=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e=e||this.visGraph.currentNode,e){if(this.deleteNodeWarning&&e.inLinks&&e.inLinks.length>0||this.deleteNodeWarning&&e.outLinks&&e.outLinks.length>0)return this.deleteNodeWarning=!1,void this.$message({showClose:!0,message:"节点含有关联，删除节点将删除所有关联！",type:"warning",onClose:function(){t.deleteNodeWarning=!1}});if("SERVICE"===e.type){if("rootName"===this.$route.params.option&&e.label===this.$route.params.name)return void this.$message({showClose:!0,message:"无法删除服务根节点！",type:"error"});var n=(e.inLinks||[]).concat(e.outLinks||[]);this.deleteLinksAsync(n).then((function(){t.visGraph.deleteNode(e),t.visGraph.currentNode=null}))}else if("RISK"===e.type){var s=(e.inLinks||[]).concat(e.outLinks||[]);this.deleteLinksAsync(s).then((function(){t.visGraph.deleteNode(e),t.visGraph.currentNode=null}))}else Object(P["f"])({id:e.id,isHard:i}).then((function(i){"Succeed"===i.result||i.message.indexOf(!0)?(t.visGraph.deleteNode(e),t.visGraph.currentNode=null):t.$message.error("节点删除失败")}))}this.$refs.nodeForm.closeForm(),this.nodeDetailVisible=!1},deleteLink:function(e){var t=this;e=e||this.visGraph.currentLink,this.deleteLinkPromise(e).then((function(){t.$refs.nodeForm.closeForm()}))},deleteSelect:function(){var e=this;return Object(r["a"])(Object(a["a"])().mark((function t(){var i,n;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=[],e.visGraph.nodes.forEach((function(e){e.selected&&i.push(e)})),t.next=4,e.deleteNodesAsync(i);case 4:n=[],e.visGraph.links.forEach((function(e){e.selected&&n.push(e)})),e.deleteLinksAsync(n);case 7:case"end":return t.stop()}}),t)})))()},uploadGraph:function(e,t){this.visGraph.drawData({nodes:Object(H["a"])(e.nodes,t),links:e.links}),this.autoLayout(null,!1),this.setZoom("auto"),this.flowUploadVisible=!1},uploadGraphFromXml:function(e){var t=this;return Object(r["a"])(Object(a["a"])().mark((function i(){var n,s,r,l,h,c,d,u,f,p,b,g,v,y,m;return Object(a["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:e.nodes=Object(H["a"])(e.nodes,!1),n={},s=Object(o["a"])(e.nodes),i.prev=3,s.s();case 5:if((r=s.n()).done){i.next=58;break}if(l=r.value,h=l.tags||[],l.version&&h.push("Version="+l.version),i.prev=9,"SERVICE"!==l.type){i.next=32;break}return i.next=13,Object(P["m"])({name:l.label});case 13:if(c=i.sent,0!=c.totalCount){i.next=19;break}return t.$message.error("上传失败！数据库中没有该服务节点：".concat(l.label)),i.abrupt("return");case 19:return l.properties.serviceId=c.services[0].id,i.next=22,Object(P["k"])({label:"ServiceId="+l.properties.serviceId});case 22:if(c=i.sent,0!==c.node.length){i.next=28;break}return t.$message.error("上传失败！图数据库中没有该服务节点：".concat(l.label)),i.abrupt("return");case 28:return l.properties.serviceNodeId=c.node[0].id,n[l.id]=l.properties.serviceNodeId,l.id=l.properties.serviceNodeId,i.abrupt("continue",56);case 32:if(d=-1,-1==l.label.indexOf(".")){i.next=44;break}return u=l.label,i.next=37,t.addNodePromise(l);case 37:return d=i.sent,i.next=40,Object(P["t"])({id:d,name:u});case 40:f=i.sent,"Succeed"===f.result?l.label=f.node.name:t.$message.error("节点update失败：".concat(u)),i.next=47;break;case 44:return i.next=46,t.addNodePromise(l);case 46:d=i.sent;case 47:return n[l.id]=d,l.id=d,i.next=51,t.addLabelsAsync(h,l);case 51:i.next=56;break;case 53:i.prev=53,i.t0=i["catch"](9),console.error("uploadGraphForXML函数:addNode出错".concat(i.t0));case 56:i.next=5;break;case 58:i.next=63;break;case 60:i.prev=60,i.t1=i["catch"](3),s.e(i.t1);case 63:return i.prev=63,s.f(),i.finish(63);case 66:p=Object(o["a"])(e.links),i.prev=67,p.s();case 69:if((b=p.n()).done){i.next=89;break}if(g=b.value,g.source=n[g.source],g.target=n[g.target],g.id&&g.label&&""!==g.label){i.next=75;break}return i.abrupt("continue",87);case 75:return v=g.serviceNodeId||g.source,y=g.serviceNodeId||g.target,i.prev=77,i.next=80,t.addLinkPromise(g.label,v,y);case 80:m=i.sent,g.id=m,i.next=87;break;case 84:i.prev=84,i.t2=i["catch"](77),console.error("uploadGraphForXML函数:addLink出错".concat(i.t2));case 87:i.next=69;break;case 89:i.next=94;break;case 91:i.prev=91,i.t3=i["catch"](67),p.e(i.t3);case 94:return i.prev=94,p.f(),i.finish(94);case 97:t.visGraph.drawData({nodes:e.nodes,links:e.links}),t.autoLayout(null,!1),t.flowUploadVisible=!1;case 100:case"end":return i.stop()}}),i,null,[[3,60,63,66],[9,53],[67,91,94,97],[77,84]])})))()},openInfo:function(){this.flowInfoVisible=!0,this.infoData=Object(C["a"])(Object(H["c"])(this.visGraph.nodes,this.visGraph.links)),this.$nextTick((function(){this.$refs.flowInfo.init()}))},handleCommand:function(e){switch(e){case"showAll":this.showAll();break;case"saveImage":this.visGraph.saveImage(5e3,5e3,"png");break;case"hideRisk":this.hideType(["RISK"]);break;case"hideSuppychain":this.hideType(["COMPONENT","SOFTWARE"]);break;case"showOneChild":this.showOneChild(["COMPONENT","SOFTWARE"]);break}},autoLayout:function(e,t){var i=this;e&&(this.layoutSetting=e);var n=new q.a(this.visGraph.getVisibleData()).createLayout(this.layoutSetting.type);if("hubsize"===this.layoutSetting.type&&"selected"==this.layoutSetting.hubsize.sortMethod&&"rootName"===this.$route.params.option){this.visGraph.scene.cancleAllSelected();var s=this.visGraph.nodes.filter((function(e){if(null==e.label)return!1;var t=e.label+"";return t==i.$route.params.name}));if(s.length>0){var a=s[0];a.selected=!0,this.currentNode=a}}n.resetConfig(this.layoutSetting[this.layoutSetting.type]);var o=this;if(t)var r=function e(){cancelAnimationFrame(h),n.runLayout(),o.setZoom("auto"),h=requestAnimationFrame(e),200==l++&&cancelAnimationFrame(h)},l=0,h=(this.visGraph,requestAnimationFrame(r));else{var c=0;while(c++<200)n.runLayout()}var d=new q.a(this.visGraph.getVisibleData()).createLayout("noverlap");l=0;while(l++<60)d.runLayout();o.setZoom("auto")},expendChild:function(e){var t=[];this.deepFindChildNode(e,t),t.length>0&&(t.forEach((function(t){t.oldX=t.x,t.oldY=t.y,t.x=e.x,t.y=e.y,t.visible=!0,t.alpha=1,t.inLinks&&t.inLinks.forEach((function(e){return e.visible=!0}))})),e.contract=0,e.tipText=null,this.autoLayout(null,!0))},contractChild:function(e,t){var i=this,n=[];t?n=t:this.deepFindChildNode(e,n),n.length>0&&(e.contract=1,e.tipText="...",n.forEach((function(t){1==t.visible&&(t.oldX=t.x,t.oldY=t.y,i.visGraph.animate({alpha:{from:t.alpha,to:0},x:{from:t.x,to:e.x},y:{from:t.y,to:e.y}},500,"easeOutQuart",(function(e){t.alpha=e.alpha,t.x=e.x,t.y=e.y}),(function(){t.visible=!1,(t.inLinks||[]).forEach((function(e){e.visible=!1}))})))})))},setZoom:function(e){switch(e){case 1:this.visGraph.scene.scaleX<3&&this.visGraph.setZoom("zoomOut");break;case-1:this.visGraph.scene.scaleX>.3&&this.visGraph.setZoom("zoomIn");break;case 0:this.visGraph.setZoom("zoom1");break;default:this.visGraph.setZoom("auto")}},emptyGraph:function(){var e=this;return Object(r["a"])(Object(a["a"])().mark((function t(){var i;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=[],i=e.visGraph.nodes.filter((function(e){return"SERVICE"!=e.type&&"RISK"!=e.type})),t.next=4,e.deleteNodesAsync(i);case 4:return t.next=6,e.deleteLinksAsync(e.visGraph.links);case 6:if("rootName"!==e.$route.params.option){t.next=14;break}return i=e.visGraph.nodes.filter((function(t){return t.label!=e.$route.params.name})),t.next=10,e.deleteNodesAsync(i);case 10:e.visGraph.drawLinkFlag=!1,e.visGraph.virLink=null,t.next=15;break;case 14:e.visGraph.clearAll();case 15:case"end":return t.stop()}}),t)})))()},downloadData:function(){var e=this;this.$confirm("确定要下载该流程数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then((function(){var t="data:text/xml;charset=utf-8,"+encodeURIComponent(e.infoData),i=document.createElement("a");i.setAttribute("href",t),i.setAttribute("download","data.xml"),i.click(),i.remove(),e.$message.success("正在下载中,请稍后...")})).catch((function(e){console.log(e)}))},openHelp:function(){this.flowHelpVisible=!0,this.$nextTick((function(){this.$refs.flowHelp.init()}))},openUpload:function(){this.flowUploadVisible=!0,this.$nextTick((function(){this.$refs.flowUpload.init()}))},addNodePromise:function(e){var t=this;return new Promise((function(i,n){Object(P["c"])({name:e.label,label:e.type}).then((function(e){"Succeed"===e.result?i(e.id):(t.$message.error("节点添加失败"),n())}))}))},addLinkPromise:function(e,t,i){var n=this;return new Promise((function(s,a){Object(P["d"])({type:e,startId:t,endId:i}).then((function(e){"Succeed"===e.result?s(e.id):(n.$message.error("关系添加失败"),a())}))}))},deleteNodePromise:function(e){var t=this;return new Promise((function(i,n){e?"SERVICE"===e.type||"RISK"===e.type?(t.visGraph.deleteNode(e),i(!0)):Object(P["f"])({id:e.id,isHard:!0}).then((function(s){"Succeed"===s.result||s.message.indexOf(!0)?(t.visGraph.deleteNode(e),i(!0)):(t.$message.error("节点删除失败"),n())})):i(!0)}))},deleteLinkPromise:function(e){var t=this;return new Promise((function(i,n){e?e.id?Object(P["h"])({id:e.id}).then((function(s){"Succeed"===s.result?(t.visGraph.deleteLink(e),t.visGraph.currentLink=null,i()):(t.$message.error("关系删除失败"),n())})):(t.visGraph.deleteLink(e),t.visGraph.currentLink=null,i(!0)):i(!0)}))},addLabelPromise:function(e,t){var i=this;return new Promise((function(n,s){e?Object(P["b"])({id:t.id,label:e}).then((function(a){"Succeed"===a.result?(-1!=e.indexOf("Version")?t.properties.version=e.slice(8):-1!=e.indexOf("RiskId")?t.properties.riskId=e.slice(7):-1==t.properties.tags.indexOf(e)&&t.properties.tags.push(e),n()):(i.$message.error("tag：".concat(e,"添加失败")),s())})):n(!0)}))},deleteLabelPromise:function(e,t){var i=this;return new Promise((function(n,s){e?Object(P["g"])({id:t.id,label:e}).then((function(a){"Succeed"===a.result?("Service"!=t.type||-1==e.indexOf("Version")?t.properties.tags.splice(t.properties.tags.indexOf(e),1):"Version="+t.properties.version===e&&(t.properties.version=null),n(!0)):(i.$message.error("tag：".concat(e,"删除失败")),s())})):n(!0)}))},findServicePromise:function(e){return new Promise((function(t){Object(P["m"])({name:e}).then((function(e){t(e)}))}))},addLabelsAsync:function(e,t){var i=this;return Object(r["a"])(Object(a["a"])().mark((function n(){var s,r,l;return Object(a["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:s=Object(o["a"])(e),n.prev=1,s.s();case 3:if((r=s.n()).done){n.next=15;break}return l=r.value,n.prev=5,n.next=8,i.addLabelPromise(l,t);case 8:n.next=13;break;case 10:return n.prev=10,n.t0=n["catch"](5),n.abrupt("return",Promise.reject());case 13:n.next=3;break;case 15:n.next=20;break;case 17:n.prev=17,n.t1=n["catch"](1),s.e(n.t1);case 20:return n.prev=20,s.f(),n.finish(20);case 23:return n.abrupt("return",Promise.resolve());case 24:case"end":return n.stop()}}),n,null,[[1,17,20,23],[5,10]])})))()},deleteLabelsAsync:function(e,t){var i=this;return Object(r["a"])(Object(a["a"])().mark((function n(){var s,r,l;return Object(a["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:s=Object(o["a"])(e),n.prev=1,s.s();case 3:if((r=s.n()).done){n.next=15;break}return l=r.value,n.prev=5,n.next=8,i.deleteLabelPromise(l,t);case 8:n.next=13;break;case 10:return n.prev=10,n.t0=n["catch"](5),n.abrupt("return",Promise.reject());case 13:n.next=3;break;case 15:n.next=20;break;case 17:n.prev=17,n.t1=n["catch"](1),s.e(n.t1);case 20:return n.prev=20,s.f(),n.finish(20);case 23:return n.abrupt("return",Promise.resolve());case 24:case"end":return n.stop()}}),n,null,[[1,17,20,23],[5,10]])})))()},deleteNodesAsync:function(e){var t=this;return Object(r["a"])(Object(a["a"])().mark((function i(){var n,s,r;return Object(a["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:n=Object(o["a"])(e),i.prev=1,n.s();case 3:if((s=n.n()).done){i.next=15;break}return r=s.value,i.prev=5,i.next=8,t.deleteNodePromise(r);case 8:i.next=13;break;case 10:return i.prev=10,i.t0=i["catch"](5),i.abrupt("return",Promise.reject());case 13:i.next=3;break;case 15:i.next=20;break;case 17:i.prev=17,i.t1=i["catch"](1),n.e(i.t1);case 20:return i.prev=20,n.f(),i.finish(20);case 23:return i.abrupt("return",Promise.resolve());case 24:case"end":return i.stop()}}),i,null,[[1,17,20,23],[5,10]])})))()},deleteLinksAsync:function(e){var t=this;return Object(r["a"])(Object(a["a"])().mark((function i(){var n,s,r;return Object(a["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e&&0!==e.length){i.next=2;break}return i.abrupt("return",Promise.resolve());case 2:n=Object(o["a"])(e),i.prev=3,n.s();case 5:if((s=n.n()).done){i.next=17;break}return r=s.value,i.prev=7,i.next=10,t.deleteLinkPromise(r);case 10:i.next=15;break;case 12:return i.prev=12,i.t0=i["catch"](7),i.abrupt("return",Promise.reject());case 15:i.next=5;break;case 17:i.next=22;break;case 19:i.prev=19,i.t1=i["catch"](3),n.e(i.t1);case 22:return i.prev=22,n.f(),i.finish(22);case 25:return i.abrupt("return",Promise.resolve());case 26:case"end":return i.stop()}}),i,null,[[3,19,22,25],[7,12]])})))()}}},U=$,K=(i("f9ea"),Object(p["a"])(U,n,s,!1,null,"52c5fb72",null));t["default"]=K.exports},"88b5":function(e,t,i){(function(n){var s,a=i("7037").default;i("d3b7"),i("159b"),i("b0c0"),i("a9e3"),i("99af"),i("fb6a"),i("ac1f"),i("466d"),i("cb29"),i("5319"),i("4de4"),i("4e82"),i("25f0"),i("a15b"),i("00b4"),i("9911"),i("c7cd"),i("d81d"),i("e9c4"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("b680"),i("a434"),i("13d5"),i("4ec9"),function(){function n(){this.initialize=function(){this.elementType="element",this.serializedProperties=["elementType"],this.propertiesStack=[],this._id=""+(new Date).getTime()},this.distroy=function(){},this.removeHandler=function(){},this.attr=function(e,t){if(null!=name&&null!=value)this[name]=value;else if(null!=name)return this[name];return this},this.save=function(){var e=this,t={};this.serializedProperties.forEach((function(i){t[i]=e[i]})),this.propertiesStack.push(t)},this.restore=function(){if(null!=this.propertiesStack&&0!=this.propertiesStack.length){var e=this,t=this.propertiesStack.pop();this.serializedProperties.forEach((function(i){e[i]=t[i]}))}}}CanvasRenderingContext2D.prototype.DGraphRoundRect=function(e,t,i,n,s){"undefined"==typeof s&&(s=5),this.beginPath(),this.moveTo(e+s,t),this.lineTo(e+i-s,t),this.quadraticCurveTo(e+i,t,e+i,t+s),this.lineTo(e+i,t+n-s),this.quadraticCurveTo(e+i,t+n,e+i-s,t+n),this.lineTo(e+s,t+n),this.quadraticCurveTo(e,t+n,e,t+n-s),this.lineTo(e,t+s),this.quadraticCurveTo(e,t,e+s,t),this.closePath()},CanvasRenderingContext2D.prototype.DGraphDashedLineTo=function(e,t,i,n,s){"undefined"==typeof s&&(s=5);var a=i-e,o=n-t,r=Math.floor(Math.sqrt(a*a+o*o)),l=0>=s?r:r/s,h=o/r*s,c=a/r*s;this.beginPath();for(var d=0;l>d;d++)d%2?this.lineTo(e+d*c,t+d*h):this.moveTo(e+d*c,t+d*h);this.stroke()};var o={version:"3.5.0",zIndex_Box:1,zIndex_Link:2,zIndex_Node:3,SceneMode:{normal:"normal",drag:"drag",edit:"edit",select:"select"},MouseCursor:{normal:"default",pointer:"pointer",move:"move"},Element:n};!function(e){function t(e){var t=this;this.name=e,this.messageMap={},this.messageCount=0,this.subscribe=function(e,i){var n=t.messageMap[e];null==n&&(t.messageMap[e]=[]),t.messageMap[e].push(i),t.messageCount++},this.unsubscribe=function(e){var i=t.messageMap[e];null!=i&&(t.messageMap[e]=null,delete t.messageMap[e],t.messageCount--)},this.publish=function(e,i,n){var s=t.messageMap[e];if(null!=s)for(var a=0;a<s.length;a++)n?function(e,t){setTimeout((function(){e(t)}),10)}(s[a],i):s[a](i)}}function i(e,t,i,n){var s,a;return null==i&&null==n?(s=t.x-e.x,a=t.y-e.y):(s=i-e,a=n-t),Math.sqrt(s*s+a*a)}function n(t){for(var i={left:Number.MAX_VALUE,right:-Number.MAX_VALUE,top:Number.MAX_VALUE,bottom:-Number.MAX_VALUE},n=0;n<t.length;n++){var s=t[n];s instanceof e.Link||1==s.visible&&(i.left>s.x&&(i.left=s.x,i.leftNode=s),i.right<s.x+s.width&&(i.right=s.x+s.width,i.rightNode=s),i.top>s.y&&(i.top=s.y,i.topNode=s),i.bottom<s.y+s.height&&(i.bottom=s.y+s.height,i.bottomNode=s))}return i.width=i.right-i.left,i.height=i.bottom-i.top,i}function s(e){return e=o(e),e.pageX||(e.pageX=e.clientX+document.body.scrollLeft-document.body.clientLeft,e.pageY=e.clientY+document.body.scrollTop-document.body.clientTop),e}function a(e){return s(e)}function o(e){var t={};for(var i in e)"returnValue"!=i&&"keyLocation"!=i&&(t[i]=e[i]);return t}function r(e){var t={};for(var i in e)t[i]=e[i];return t}function l(e,t){var i=t.x,n=t.y,s=t.width,a=t.height;return e.x>i&&e.x<i+s&&e.y>n&&e.y<n+a}function h(t,i,n){var s=e.util.getDistance(i,n),a=e.util.getDistance(i,t),o=e.util.getDistance(n,t),r=Math.abs(a+o-s)<=.5;return r}function c(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n===t){e=e.del(i);break}}return e}function d(){return Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())}function u(e){if(!e)return{left:0,top:0};var t=0,i=0;if("getBoundingClientRect"in document.documentElement){var n=e.getBoundingClientRect(),s=e.ownerDocument,a=s.body,o=s.documentElement,r=o.clientTop||a.clientTop||0,l=o.clientLeft||a.clientLeft||0;t=n.top+(self.pageYOffset||o&&o.scrollTop||a.scrollTop)-r,i=n.left+(self.pageXOffset||o&&o.scrollLeft||a.scrollLeft)-l}else do{t+=e.offsetTop||0,i+=e.offsetLeft||0,e=e.offsetParent}while(e);return{left:i,top:t}}function f(e,t,i,n){function s(e){return e*a+o}var a=(n-t)/(i-e),o=t-e*a;return s.k=a,s.b=o,s.x1=e,s.x2=i,s.y1=t,s.y2=n,s}function p(e,t,i){var n=Math.abs(t-i),s=Math.abs(t-e),a=Math.abs(i-e),o=Math.abs(n-(s+a));return 1e-6>o}function b(e,t,i){return p(e,i.x1,i.x2)&&p(t,i.y1,i.y2)}function g(e,t){var i,n;return e.k==t.k?null:(1/0==e.k||e.k==-1/0?(i=e.x1,n=t(e.x1)):1/0==t.k||t.k==-1/0?(i=t.x1,n=e(t.x1)):(i=(t.b-e.b)/(e.k-t.k),n=e(i)),0==b(i,n,e)||0==b(i,n,t)?null:{x:i,y:n})}function v(t,i){var n=e.util.lineF(i.left,i.top,i.left,i.bottom),s=e.util.intersection(t,n);return null==s&&(n=e.util.lineF(i.left,i.top,i.right,i.top),s=e.util.intersection(t,n),null==s&&(n=e.util.lineF(i.right,i.top,i.right,i.bottom),s=e.util.intersection(t,n),null==s&&(n=e.util.lineF(i.left,i.bottom,i.right,i.bottom),s=e.util.intersection(t,n)))),s}requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},Array.prototype.del=function(e){if("number"!=typeof e){for(var t=0;t<this.length;t++)if(this[t]===e)return this.slice(0,t).concat(this.slice(t+1,this.length));return this}return 0>e?this:this.slice(0,e).concat(this.slice(e+1,this.length))},[].indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1});var y=document.createElement("canvas");y.getContext("2d");e.util={getDistance:i,getEventPosition:a,mouseCoords:s,MessageBus:t,isFirefox:navigator.userAgent.indexOf("Firefox")>0,isIE:!(!window.attachEvent||-1!==navigator.userAgent.indexOf("Opera")),isChrome:null!=navigator.userAgent.toLowerCase().match(/chrome/),clone:r,isPointInRect:l,isPointInLine:h,removeFromArray:c,cloneEvent:o,randomColor:d,getElementsBound:n,getOffsetPosition:u,lineF:f,intersection:g,intersectionLineBound:v}}(o),function(e){function t(e){return{hgap:2,visible:!1,exportCanvas:document.createElement("canvas"),getImage:function(t,i,n){var s=e.getBound(),a=1,o=1,r=s.width,l=s.height,h=0,c=0;if(null!=t&&null!=i){"node"==s.leftNode.elementType&&"node"==s.rightNode.elementType&&(h=s.leftNode.radius*s.leftNode.scaleX+s.rightNode.radius*s.rightNode.scaleX,c=s.topNode.radius*s.topNode.scaleY+s.bottomNode.radius*s.bottomNode.scaleY);var d=Math.min(t,r),u=Math.min(i,l);this.exportCanvas.width=d+h,this.exportCanvas.height=u+c}else this.exportCanvas.width=Math.max(r,e.canvas.width),this.exportCanvas.height=Math.max(l,e.canvas.height);var f=this.exportCanvas.getContext("2d");return e.childs.length>0&&(f.save(),f.clearRect(0,0,this.exportCanvas.width,this.exportCanvas.height),e.childs.forEach((function(e){1==e.visible&&(e.save(),e.translateX=0,e.translateY=0,e.scaleX=1,e.scaleY=1,f.scale(a,o),s.left<0&&(e.translateX=Math.abs(s.left)+h),s.top<0&&(e.translateY=Math.abs(s.top)+c),e.repaint(f),e.restore())})),f.restore()),this.exportCanvas.toDataURL("image/"+(n||"png"),1)},getImageUrlData:function(t,i,n){var s=e.getBound();if(s.width<0)return null;var a=s.width,o=s.height,r=0,l=0;"node"==s.leftNode.elementType&&"node"==s.rightNode.elementType&&(r=s.leftNode.radius*s.leftNode.scaleX+s.rightNode.radius*s.rightNode.scaleX,l=s.topNode.radius*s.topNode.scaleY+s.bottomNode.radius*s.bottomNode.scaleY),a+=r,o+=l,this.width=this.exportCanvas.width=Math.min(t||1e4,a),this.height=this.exportCanvas.height=Math.min(i||1e4,o);var h=Math.min(this.width/a,this.height/o);if(a<500||o<500){var c=Math.max(Math.max(a,o),500);this.width=this.exportCanvas.width=c,this.height=this.exportCanvas.height=c,h=1}var d=this.exportCanvas.getContext("2d");if(e.childs.length>0){e.childs.forEach((function(e){1==e.visible&&(e.save(),e.centerAndZoom(h,h,d),e.repaint(d,!0),e.restore())}));var u=null;try{u=this.exportCanvas.toDataURL("image/"+(n||"png"),1)}catch(f){}return u}return null},canvas:document.createElement("canvas"),update:function(){this.eagleImageDatas=this.getData(e)},setSize:function(e,t){this.width=this.canvas.width=e,this.height=this.canvas.height=t},getData:function(t,i){function n(e){var t=e.stage.canvas.width,i=e.stage.canvas.height,n=t/e.scaleX/2,s=i/e.scaleY/2;return{translateX:e.translateX+n-n*e.scaleX,translateY:e.translateY+s-s*e.scaleY}}null!=f&&null!=p?this.setSize(t,i):this.setSize(200,160);var s=e.getBound();if(s.width<0)return null;var a=null,o=200/s.width,r=160/s.height;a=Math.min(o,r);var l=this.canvas.getContext("2d");if(e.childs.length>0){l.save(),l.clearRect(0,0,this.canvas.width,this.canvas.height),e.childs.forEach((function(e){1==e.visible&&(e.save(),e.centerAndZoom(a,a,l),e.paintNodes(l),e.restore())}));var h=n(e.childs[0]),c=h.translateX*(this.canvas.width/e.canvas.width)*e.childs[0].scaleX,d=h.translateY*(this.canvas.height/e.canvas.height)*e.childs[0].scaleY,u=e.getBound(),f=e.canvas.width/e.childs[0].scaleX/u.width,p=e.canvas.height/e.childs[0].scaleY/u.height;f>1&&(f=1),p>1&&(f=1),c*=f,d*=p,u.left<0&&(c-=Math.abs(u.left)*(this.width/u.width)),u.top<0&&(d-=Math.abs(u.top)*(this.height/u.height)),l.save(),l.lineWidth=1,l.strokeStyle="rgba(0,250,0,1)",l.strokeRect(-c,-d,l.canvas.width*f,l.canvas.height*p),l.restore();var b=null;try{b=l.getImageData(0,0,l.canvas.width,l.canvas.height)}catch(g){}return b}return null},paint:function(){if(null!=this.eagleImageDatas){var t=e.graphics;t.beginPath(),t.save(),t.fillStyle="rgba(30,250,30,0.5)",t.fillRect(e.canvas.width-this.canvas.width-2*this.hgap,e.canvas.height-this.canvas.height-1,e.canvas.width-this.canvas.width,this.canvas.height+1),t.fill(),t.restore(),t.save(),t.lineWidth=1,t.strokeStyle="rgba(120,120,200,1)",t.rect(e.canvas.width-this.canvas.width-2*this.hgap,e.canvas.height-this.canvas.height-1,e.canvas.width-this.canvas.width,this.canvas.height+1),t.stroke(),t.restore(),t.save(),t.putImageData(this.eagleImageDatas,e.canvas.width-this.canvas.width-this.hgap,e.canvas.height-this.canvas.height),t.restore(),t.closePath()}else this.eagleImageDatas=this.getData(e)},eventHandler:function(e,t,i){var n=t.x,s=t.y;if(n>i.canvas.width-this.canvas.width&&s>i.canvas.height-this.canvas.height&&(n=t.x-this.canvas.width,s=t.y-this.canvas.height,"mousedown"==e&&(this.lastTranslateX=i.childs[0].translateX,this.lastTranslateY=i.childs[0].translateY),"mousedrag"==e&&i.childs.length>0)){var a=t.dx,o=t.dy,r=i.getBound(),l=this.canvas.width/i.childs[0].scaleX/r.width,h=this.canvas.height/i.childs[0].scaleY/r.height;i.childs[0].translateX=this.lastTranslateX-a/l,i.childs[0].translateY=this.lastTranslateY-o/h}}}}function i(i){var n=document.createElement("canvas");n.style.position="relative",n.style.width="100%",n.style.height="100%",i.appendChild(n);var s=o(n);function a(t){var i=e.util.getEventPosition(t),n=e.util.getOffsetPosition(g.canvas);return i.offsetLeft=i.pageX-n.left,i.offsetTop=i.pageY-n.top,i.x=i.offsetLeft*s,i.y=i.offsetTop*s,i.target=null,i}function o(e){var t=e.getContext("2d");if(void 0!==t){var i=1;"undefined"!==typeof window&&(i=window.devicePixelRatio||1);var n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n}}function r(e){document.onselectstart=function(){return!1},this.mouseOver=!0;var t=a(e);g.dispatchEventToScenes("mouseover",t),g.dispatchEvent("mouseover",t)}function l(e){document.onselectstart=function(){return!0};var t=a(e);g.dispatchEventToScenes("mouseout",t),g.dispatchEvent("mouseout",t),g.needRepaint=0!=g.animate}function h(e){var t=a(e);g.mouseDown=!0,g.mouseDownX=t.x,g.mouseDownY=t.y,g.dispatchEventToScenes("mousedown",t),g.dispatchEvent("mousedown",t)}function c(e){var t=a(e);g.dispatchEventToScenes("mouseup",t),g.dispatchEvent("mouseup",t),g.mouseDown=!1,g.needRepaint=0!=g.animate}function d(e){var t=a(e);g.mouseDown?0==e.button&&(t.dx=t.x-g.mouseDownX,t.dy=t.y-g.mouseDownY,g.dispatchEventToScenes("mousedrag",t),g.dispatchEvent("mousedrag",t),1==g.thumbnail.visible&&g.thumbnail.update()):(g.dispatchEventToScenes("mousemove",t),g.dispatchEvent("mousemove",t))}function u(e){var t=a(e);g.dispatchEventToScenes("click",t),g.dispatchEvent("click",t)}function f(e){var t=a(e);g.dispatchEventToScenes("dbclick",t),g.dispatchEvent("dbclick",t)}function p(e){var t=a(e);g.dispatchEventToScenes("mousewheel",t),g.dispatchEvent("mousewheel",t),null!=g.wheelZoom&&(e.preventDefault?e.preventDefault():(e=e||window.event,e.returnValue=!1),1==g.thumbnail.visible&&g.thumbnail.update())}function b(t){e.util.isIE||!window.addEventListener?(t.onmouseout=l,t.onmouseover=r,t.onmousedown=h,t.onmouseup=c,t.onmousemove=d,t.onclick=u,t.ondblclick=f,t.onmousewheel=p,t.touchstart=h,t.touchmove=d,t.touchend=c):(t.addEventListener("mouseout",l),t.addEventListener("mouseover",r),t.addEventListener("mousedown",h),t.addEventListener("mouseup",c),t.addEventListener("mousemove",d),t.addEventListener("click",u),t.addEventListener("dblclick",f),e.util.isFirefox?t.addEventListener("DOMMouseScroll",p):t.addEventListener("mousewheel",p)),window.addEventListener&&(window.addEventListener("keydown",(function(t){g.dispatchEventToScenes("keydown",e.util.cloneEvent(t));var i=t.keyCode;(37==i||38==i||39==i||40==i)&&(t.preventDefault?t.preventDefault():(t=t||window.event,t.returnValue=!1))}),!0),window.addEventListener("keyup",(function(t){g.dispatchEventToScenes("keyup",e.util.cloneEvent(t));var i=t.keyCode;(37==i||38==i||39==i||40==i)&&(t.preventDefault?t.preventDefault():(t=t||window.event,t.returnValue=!1))}),!0))}n.width=Math.round(n.clientWidth*s),n.height=Math.round(n.clientHeight*s),window.addEventListener("resize",(function(e){var t=Math.round(n.clientWidth*s),i=Math.round(n.clientHeight*s);n.width==t&&n.height==i||(n.width=t,n.height=i),g.paint()}));var g=this;e.stage=this,this.initialize=function(i){b(i),this.canvas=i,this.graphics=i.getContext("2d"),this.childs=[],this.fps=-100,this.messageBus=new e.util.MessageBus,this.thumbnail=t(this),this.wheelZoom=null,this.mouseDownX=0,this.mouseDownY=0,this.mouseDown=!1,this.mouseOver=!1,this.needRepaint=!0,this.serializedProperties=["fps","wheelZoom"],this.pixelRatio=o(i)},null!=n&&this.initialize(n);var v=!0;document.oncontextmenu=function(){return v},this.dispatchEventToScenes=function(e,t){if(0!=this.fps&&(this.needRepaint=!0),1==this.thumbnail.visible&&-1!=e.indexOf("mouse")){var i=t.x,n=t.y;if(i>this.width-this.thumbnail.width&&n>this.height-this.thumbnail.height)return void this.thumbnail.eventHandler(e,t,this)}this.childs.forEach((function(i){if(1==i.visible){var n=i[e+"Handler"];if(null==n)throw new Error("Function not found:"+e+"Handler");n.call(i,t)}}))},this.add=function(e){for(var t=0;t<this.childs.length;t++)if(this.childs[t]===e)return;e.addTo(this),this.childs.push(e)},this.remove=function(e){if(null==e)throw new Error("Stage.remove error! params is null!");for(var t=0;t<this.childs.length;t++)if(this.childs[t]===e)return e.stage=null,this.childs=this.childs.del(t),this;return this},this.clear=function(){this.childs=[]},this.addEventListener=function(e,t){var i=this,n=function(e){t.call(i,e)};return this.messageBus.subscribe(e,n),this},this.removeEventListener=function(e){this.messageBus.unsubscribe(e)},this.removeAllEventListener=function(){this.messageBus=new e.util.MessageBus},this.dispatchEvent=function(e,t){return this.messageBus.publish(e,t),this};var y="click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(","),m=this;y.forEach((function(e){m[e]=function(t){null!=t?this.addEventListener(e,t):this.dispatchEvent(e)}})),this.saveAsLocalImage=function(e,t,i){i=i||"png";var n=this.thumbnail.getImageUrlData(e,t,i||"png");function s(e){var t=function(e){e=e.toLowerCase().replace(/jpg/i,"jpeg");var t=e.match(/png|jpeg|bmp|gif/)[0];return"image"+t};e=e.replace(t(i),"image/octet-stream");var n=function(e,t){var i=document.createElement("a");i.href=e,i.download=t;var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(n)},s="GraphVis_"+(new Date).getTime()+"."+i;n(e,s)}null!=n&&s(n)},this.paint=function(){null!=this.canvas&&(this.graphics.save(),this.graphics.clearRect(0,0,this.width,this.height),this.childs.forEach((function(e){1==e.visible&&e.repaint(g.graphics)})),1==this.thumbnail.visible&&this.thumbnail.paint(this),this.graphics.restore())},this.repaint=function(){0!=this.fps&&(this.fps<0&&0==this.needRepaint||(this.paint(),this.fps<0&&(this.needRepaint=!1)))},this.zoom=function(e){this.childs.forEach((function(t){0!=t.visible&&t.zoom(e)}))},this.zoomOut=function(e){this.childs.forEach((function(t){0!=t.visible&&t.zoomOut(e)}))},this.zoomIn=function(e){this.childs.forEach((function(t){0!=t.visible&&t.zoomIn(e)}))},this.centerAndZoom=function(){this.childs.forEach((function(e){0!=e.visible&&e.centerAndZoom()}))},this.setCenter=function(e,t){var i=this;this.childs.forEach((function(n){var s=e-i.canvas.width/2,a=t-i.canvas.height/2;n.translateX=-s,n.translateY=-a}))},this.getBound=function(){var e={left:Number.MAX_VALUE,right:Number.MIN_VALUE,top:Number.MAX_VALUE,bottom:Number.MIN_VALUE};return 0==this.childs.length?null:(this.childs.forEach((function(t){var i=t.getElementsBound();i.left<e.left&&(e.left=i.left,e.leftNode=i.leftNode),i.top<e.top&&(e.top=i.top,e.topNode=i.topNode),i.right>e.right&&(e.right=i.right,e.rightNode=i.rightNode),i.bottom>e.bottom&&(e.bottom=i.bottom,e.bottomNode=i.bottomNode)})),e.width=e.right-e.left,e.height=e.bottom-e.top,e)},function(){0==g.fps?setTimeout(arguments.callee,100):g.fps<0?(g.repaint(),setTimeout(arguments.callee,1e3/-g.fps)):(g.repaint(),setTimeout(arguments.callee,1e3/g.fps))}(),setTimeout((function(){g.mousewheel((function(e){var t=null==e.wheelDelta?e.detail:e.wheelDelta;null!=this.wheelZoom&&(t>0?this.zoomOut(this.wheelZoom):this.zoomIn(this.wheelZoom))})),g.paint()}),300),setTimeout((function(){g.paint()}),3e3)}i.prototype={get width(){return this.canvas.width},get height(){return this.canvas.height},set mode(e){this.childs.forEach((function(t){t.mode=e}))}},e.Stage=i}(o),function(e){function t(i){var n=this;this.initialize=function(){t.prototype.initialize.apply(this,arguments),this.messageBus=new e.util.MessageBus,this.elementType="scene",this.childs=[],this.zIndexMap={},this.zIndexArray=[],this.backgroundColor="255,255,255",this.visible=!0,this.alpha=0,this.scaleX=1,this.scaleY=1,this.mode=e.SceneMode.normal,this.translate=!0,this.translateX=0,this.translateY=0,this.lastTranslateX=0,this.lastTranslateY=0,this.mouseDown=!1,this.mouseDownX=null,this.mouseDownY=null,this.mouseDownEvent=null,this.areaSelect=!0,this.operations=[],this.selectedElements=[],this.paintAll=!1;var i="background,backgroundColor,mode,paintAll,areaSelect,translate,translateX,translateY,lastTranslatedX,lastTranslatedY,alpha,visible,scaleX,scaleY".split(",");this.serializedProperties=this.serializedProperties.concat(i)},this.initialize(),this.scene=function(e){this.background=e},this.addTo=function(e){this.stage!==e&&null!=e&&(this.stage=e)},null!=i&&(i.add(this),this.addTo(i)),this.show=function(){this.visible=!0},this.hide=function(){this.visible=!1},this.paint=function(e,t){if(0!=this.visible&&null!=this.stage){if(e.save(),this.paintBackgroud(e),e.restore(),e.save(),e.scale(this.scaleX,this.scaleY),1==this.translate){var i=this.getOffsetTranslate(e);e.translate(i.translateX,i.translateY)}t?this.paintAllChilds(e):this.paintChilds(e),e.restore(),e.save(),this.paintOperations(e,this.operations),e.restore()}},this.repaint=function(e,t){0!=this.visible&&this.paint(e,t)},this.paintBackgroud=function(e){null!=this.background?e.drawImage(this.background,0,0,e.canvas.width,e.canvas.height):(e.beginPath(),e.fillStyle="rgba("+this.backgroundColor+","+this.alpha+")",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.closePath())},this.getDisplayedElements=function(){for(var e=[],t=0;t<this.zIndexArray.length;t++)for(var i=this.zIndexArray[t],n=this.zIndexMap[i],s=0;s<n.length;s++){var a=n[s];this.isVisiable(a)&&e.push(a)}return e},this.getDisplayedNodes=function(){for(var t=[],i=0;i<this.childs.length;i++){var n=this.childs[i];n instanceof e.Node&&this.isVisiable(n)&&t.push(n)}return t},this.paintChilds=function(t){for(var i=this.scaleX<.1,n=this.getDisplayedElements(),s=[],a=[],o=[],r=n.length-1;r>=0;r--){var l=n[r];if(l instanceof e.Node)s.push(l);else if(l instanceof e.Box)o.push(l);else if(l instanceof e.Edge){if(i)continue;-1==s.indexOf(l.source)&&-1==s.indexOf(l.target)||a.push(l)}}var h=o.concat(a).concat(s),c=this.scaleX<.3;h.forEach((function(i){if(1==i.visible){if(t.save(),1==i.transformAble){var n=i.getCenterLocation();t.translate(n.x,n.y),i.rotate&&t.rotate(i.rotate),i.scaleX&&i.scaleY?t.scale(i.scaleX,i.scaleY):i.scaleX?t.scale(i.scaleX,1):i.scaleY&&t.scale(1,i.scaleY)}i instanceof e.InteractiveElement&&(i.selected&&1==i.showSelected&&i.paintSelected(t),1==i.isMouseOver&&i.paintMouseover(t)),i.paint(t,c),t.restore()}}))},this.paintAllChilds=function(t){for(var i=0;i<this.zIndexArray.length;i++)for(var n=this.zIndexArray[i],s=this.zIndexMap[n],a=0;a<s.length;a++){var o=s[a];if(1==o.visible){if(t.save(),1==o.transformAble){var r=o.getCenterLocation();t.translate(r.x,r.y),o.rotate&&t.rotate(o.rotate),o.scaleX&&o.scaleY?t.scale(o.scaleX,o.scaleY):o.scaleX?t.scale(o.scaleX,1):o.scaleY&&t.scale(1,o.scaleY)}o instanceof e.InteractiveElement&&(o.selected&&1==o.showSelected&&o.paintSelected(t),1==o.isMouseOver&&o.paintMouseover(t)),o.paint(t),t.restore()}}},this.paintNodes=function(t){if(t.save(),t.scale(this.scaleX,this.scaleY),1==this.translate){var i=this.getOffsetTranslate(t);t.translate(i.translateX,i.translateY)}var n=this.childs.filter((function(t){return t instanceof e.Node}));n.forEach((function(e){if(1==e.visible){if(t.save(),1==e.transformAble){var n=e.getCenterLocation();t.translate(n.x,n.y),e.rotate&&t.rotate(e.rotate),e.scaleX&&e.scaleY?t.scale(e.scaleX,e.scaleY):e.scaleX?t.scale(e.scaleX,1):e.scaleY&&i.scale(1,e.scaleY)}e.paint(t,!0),t.restore()}})),t.restore()},this.getOffsetTranslate=function(e){var t=this.stage.canvas.width,i=this.stage.canvas.height;null!=e&&"move"!=e&&(t=e.canvas.width,i=e.canvas.height);var n=t/this.scaleX/2,s=i/this.scaleY/2,a={translateX:this.translateX+(n-n*this.scaleX),translateY:this.translateY+(s-s*this.scaleY)};return a},this.isVisiable=function(t){if(1!=t.visible)return!1;if(t instanceof e.Link)return!0;var i=this.getOffsetTranslate(),n=t.x+i.translateX,s=t.y+i.translateY;n*=this.scaleX,s*=this.scaleY;var a=n+t.width*this.scaleX,o=s+t.height*this.scaleY;return!(n>this.stage.canvas.width||s>this.stage.canvas.height||0>a||0>o)},this.paintOperations=function(e,t){for(var i=0;i<t.length;i++)t[i](e)},this.findElements=function(e){for(var t=[],i=0;i<this.childs.length;i++)1==e(this.childs[i])&&t.push(this.childs[i]);return t},this.getElementsByClass=function(e){return this.findElements((function(t){return t instanceof e}))},this.addOperation=function(e){return this.operations.push(e),this},this.clearOperations=function(){return this.operations=[],this},this.getElementByXY=function(t,i){for(var n=null,s=this.zIndexArray.length-1;s>=0;s--)for(var a=this.zIndexArray[s],o=this.zIndexMap[a],r=o.length-1;r>=0;r--){var l=o[r];if(l instanceof e.InteractiveElement&&this.isVisiable(l)&&l.isInBound(t,i))return l}return n},this.add=function(e){this.childs.push(e),null==this.zIndexMap[e.zIndex]&&(this.zIndexMap[e.zIndex]=[],this.zIndexArray.push(e.zIndex),this.zIndexArray.sort((function(e,t){return e-t}))),this.zIndexMap[""+e.zIndex].push(e)},this.remove=function(t){this.childs=e.util.removeFromArray(this.childs,t);var i=this.zIndexMap[t.zIndex];i&&(this.zIndexMap[t.zIndex]=e.util.removeFromArray(i,t)),t.removeHandler(this)},this.clear=function(){var e=this;this.childs.forEach((function(t){t.removeHandler(e)})),this.childs=[],this.operations=[],this.zIndexArray=[],this.zIndexMap={}},this.addToSelected=function(e){this.selectedElements.push(e)},this.cancleAllSelected=function(e){for(var t=0;t<this.selectedElements.length;t++)this.selectedElements[t].unselectedHandler(e);this.selectedElements=[]},this.notInSelectedNodes=function(e){for(var t=0;t<this.selectedElements.length;t++)if(e===this.selectedElements[t])return!1;return!0},this.removeFromSelected=function(e){for(var t=0;t<this.selectedElements.length;t++){var i=this.selectedElements[t];e===i&&(this.selectedElements=this.selectedElements.del(t))}},this.toSceneEvent=function(t){var i=e.util.clone(t);if(i.x/=this.scaleX,i.y/=this.scaleY,1==this.translate){var n=this.getOffsetTranslate();i.x-=n.translateX,i.y-=n.translateY}return null!=i.dx&&(i.dx/=this.scaleX,i.dy/=this.scaleY),null!=this.currentElement&&(i.target=this.currentElement),i.scene=this,i},this.selectElement=function(e){var t=n.getElementByXY(e.x,e.y);if(null!=t)if(e.target=t,t.mousedownHander(e),t.selectedHandler(e),n.notInSelectedNodes(t))e.ctrlKey||n.cancleAllSelected(),n.addToSelected(t);else{1==e.ctrlKey&&(t.unselectedHandler(),this.removeFromSelected(t));for(var i=0;i<this.selectedElements.length;i++){var s=this.selectedElements[i];s.selectedHandler(e)}}else e.ctrlKey||n.cancleAllSelected();this.currentElement=t},this.mousedownHandler=function(t){var i=this.toSceneEvent(t);if(this.mouseDown=!0,this.mouseDownX=i.x,this.mouseDownY=i.y,this.mouseDownEvent=i,this.mode==e.SceneMode.normal)this.selectElement(i),(null==this.currentElement||this.currentElement instanceof e.Link)&&1==this.translate&&(this.lastTranslateX=this.translateX,this.lastTranslateY=this.translateY);else{if(this.mode==e.SceneMode.drag&&1==this.translate)return this.lastTranslateX=this.translateX,void(this.lastTranslateY=this.translateY);this.mode==e.SceneMode.select?this.selectElement(i):this.mode==e.SceneMode.edit&&(this.selectElement(i),(null==this.currentElement||this.currentElement instanceof e.Link)&&1==this.translate&&(this.lastTranslateX=this.translateX,this.lastTranslateY=this.translateY))}n.dispatchEvent("mousedown",i)},this.mouseupHandler=function(t){this.stage.cursor!=e.MouseCursor.normal&&(this.stage.cursor=e.MouseCursor.normal),n.clearOperations();var i=this.toSceneEvent(t);null!=this.currentElement&&(i.target=n.currentElement,this.currentElement.mouseupHandler(i)),this.dispatchEvent("mouseup",i),this.mouseDown=!1},this.dragElements=function(t){if(null!=this.currentElement&&1==this.currentElement.dragable)for(var i=0;i<this.selectedElements.length;i++){var n=this.selectedElements[i];if(0!=n.dragable){var s=e.util.clone(t);s.target=n,n.mousedragHandler(s)}}},this.mousedragHandler=function(t){var i=this.toSceneEvent(t);this.mode==e.SceneMode.normal?null==this.currentElement||this.currentElement instanceof e.Link?1==this.translate&&(this.translateX=this.lastTranslateX+i.dx,this.translateY=this.lastTranslateY+i.dy):this.dragElements(i):this.mode==e.SceneMode.drag?1==this.translate&&(this.translateX=this.lastTranslateX+i.dx,this.translateY=this.lastTranslateY+i.dy):this.mode==e.SceneMode.select?null!=this.currentElement?1==this.currentElement.dragable&&this.dragElements(i):1==this.areaSelect&&this.areaSelectHandle(i):this.mode==e.SceneMode.edit&&(null==this.currentElement||this.currentElement instanceof e.Link?1==this.translate&&(this.translateX=this.lastTranslateX+i.dx,this.translateY=this.lastTranslateY+i.dy):this.dragElements(i)),this.dispatchEvent("mousedrag",i)},this.areaSelectHandle=function(e){var t=e.offsetLeft,i=e.offsetTop,s=this.mouseDownEvent.offsetLeft,a=this.mouseDownEvent.offsetTop,o=t>=s?s:t,r=i>=a?a:i,l=Math.abs(e.dx)*this.scaleX,h=Math.abs(e.dy)*this.scaleY,c=new b(o*this.stage.pixelRatio,r*this.stage.pixelRatio,l,h);n.clearOperations().addOperation(c),t=e.x,i=e.y,s=this.mouseDownEvent.x,a=this.mouseDownEvent.y,o=t>=s?s:t,r=i>=a?a:i,l=Math.abs(e.dx),h=Math.abs(e.dy);for(var d=o+l,u=r+h,f=0;f<n.childs.length;f++){var p=n.childs[f];"link"!=p.elementType&&(p.x>o&&p.x+p.width<d&&p.y>r&&p.y+p.height<u&&n.notInSelectedNodes(p)&&(p.selectedHandler(e),n.addToSelected(p)))}function b(e,t,i,n){return function(s){s.beginPath(),s.strokeStyle="rgba(0,225,0,0.8)",s.fillStyle="rgba(0,225,0,0.1)",s.rect(e,t,i,n),s.fill(),s.stroke(),s.closePath()}}},this.mousemoveHandler=function(t){this.mousecoord={x:t.x,y:t.y};var i=this.toSceneEvent(t);if(this.mode!=e.SceneMode.drag){(this.mode==e.SceneMode.normal||this.mode==e.SceneMode.select)&&(this.stage.cursor=e.MouseCursor.normal);var s=n.getElementByXY(i.x,i.y);null!=s?(n.mouseOverelement&&n.mouseOverelement!==s&&(i.target=s,n.mouseOverelement.mouseoutHandler(i)),n.mouseOverelement=s,0==s.isMouseOver?(i.target=s,s.mouseoverHandler(i),n.dispatchEvent("mouseover",i)):(i.target=s,s.mousemoveHandler(i),n.dispatchEvent("mousemove",i))):n.mouseOverelement?(i.target=s,n.mouseOverelement.mouseoutHandler(i),n.mouseOverelement=null,n.dispatchEvent("mouseout",i)):(i.target=null,n.dispatchEvent("mousemove",i))}else this.stage.cursor=null},this.mouseoverHandler=function(e){var t=this.toSceneEvent(e);this.dispatchEvent("mouseover",t)},this.mouseoutHandler=function(e){var t=this.toSceneEvent(e);this.dispatchEvent("mouseout",t)},this.clickHandler=function(e){var t=this.toSceneEvent(e);this.currentElement&&(t.target=this.currentElement,this.currentElement.clickHandler(t)),this.dispatchEvent("click",t)},this.dbclickHandler=function(e){var t=this.toSceneEvent(e);this.currentElement?(t.target=this.currentElement,this.currentElement.dbclickHandler(t)):n.cancleAllSelected(),this.dispatchEvent("dbclick",t)},this.mousewheelHandler=function(e){var t=this.toSceneEvent(e);this.dispatchEvent("mousewheel",t)},this.touchstart=this.mousedownHander,this.touchmove=this.mousedragHandler,this.touchend=this.mousedownHander,this.keydownHandler=function(e){this.dispatchEvent("keydown",e)},this.keyupHandler=function(e){this.dispatchEvent("keyup",e)},this.addEventListener=function(e,t){var i=this,n=function(e){t.call(i,e)};return this.messageBus.subscribe(e,n),this},this.removeEventListener=function(e){this.messageBus.unsubscribe(e)},this.removeAllEventListener=function(){this.messageBus=new e.util.MessageBus},this.dispatchEvent=function(e,t){return this.messageBus.publish(e,t),this};var s="click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(","),a=this;return s.forEach((function(e){a[e]=function(t){null!=t?this.addEventListener(e,t):this.dispatchEvent(e)}})),this.zoom=function(e,t){null!=e&&0!=e&&(this.scaleX=e),null!=t&&0!=t&&(this.scaleY=t)},this.zoomOut=function(e){0!=e&&(null==e&&(e=.1),this.scaleX+=e,this.scaleY+=e)},this.zoomIn=function(e){0!=e&&(null==e&&(e=.1),this.scaleX-=e,this.scaleY-=e)},this.getBound=function(){return{left:0,top:0,right:this.stage.canvas.width,bottom:this.stage.canvas.height,width:this.stage.canvas.width,height:this.stage.canvas.height}},this.getElementsBound=function(){return 0==this.childs.length?null:e.util.getElementsBound(this.childs)},this.translateToCenter=function(e){var t=this.getElementsBound();if(null!=t){var i=this.stage.canvas.width/2-(t.left+t.right)/2,n=this.stage.canvas.height/2-(t.top+t.bottom)/2;e&&(i=e.canvas.width/2-(t.left+t.right)/2,n=e.canvas.height/2-(t.top+t.bottom)/2),this.translateX=i,this.translateY=n}},this.setCenter=function(e,t){var i=e-this.stage.canvas.width/2,n=t-this.stage.canvas.height/2;this.translateX=-i,this.translateY=-n},this.centerAndZoom=function(e,t,i){if(this.translateToCenter(i),null==e||null==t){var n=this.getElementsBound();if(null!=n){var s=n.right+n.rightNode.radius*n.rightNode.scaleX-(n.left-n.leftNode.radius*n.leftNode.scaleX)+40,a=n.bottom+n.bottomNode.radius*n.bottomNode.scaleX-(n.top-n.topNode.radius*n.topNode.scaleX)+15,o=this.stage.canvas.width/s,r=this.stage.canvas.height/a;i&&(o=i.canvas.width/s,r=i.canvas.height/a);var l=Math.min(o,r);if(l>1)return;this.zoom(l,l)}}else this.zoom(e,t)},this.getCenterLocation=function(){return{x:n.stage.canvas.width/2,y:n.stage.canvas.height/2}},this.doLayout=function(e){e&&e(this,this.childs)},n}t.prototype=new e.Element;var i={};Object.defineProperties(t.prototype,{background:{get:function(){return this._background},set:function(e){if("string"==typeof e){var t=i[e];null==t&&(t=new Image,t.src=e,t.onload=function(){i[e]=t}),this._background=t}else this._background=e}}}),e.Scene=t}(o),function(e){function t(){this.initialize=function(){t.prototype.initialize.apply(this,arguments),this.elementType="displayElement",this.x=0,this.y=0,this.width=32,this.height=32,this.visible=!0,this.alpha=1,this.rotate=0,this.scaleX=1,this.scaleY=1,this.strokeColor="22,255,22",this.borderColor="22,255,22",this.fillColor="22,255,22",this.shadow=!1,this.shadowBlur=5,this.shadowColor="rgba(20,200,20,0.5)",this.shadowOffsetX=3,this.shadowOffsetY=6,this.transformAble=!1,this.zIndex=0;var e="x,y,width,height,visible,alpha,rotate,scaleX,scaleY,strokeColor,fillColor,shadow,shadowColor,shadowOffsetX,shadowOffsetY,transformAble,zIndex".split(",");this.serializedProperties=this.serializedProperties.concat(e)},this.initialize(),this.paint=function(e){e.beginPath(),e.fillStyle="rgba("+this.fillColor+","+this.alpha+")",e.rect(-this.width/2,-this.height/2,this.width,this.height),e.fill(),e.stroke(),e.closePath()},this.getLocation=function(){return{x:this.x,y:this.y}},this.setLocation=function(e,t){return this.x=e,this.y=t,this},this.getCenterLocation=function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},this.setCenterLocation=function(e,t){return this.x=e-this.width/2,this.y=t-this.height/2,this},this.getSize=function(){return{width:this.width,height:this.heith}},this.setSize=function(e,t){return this.width=e,this.height=t,this.raduis=this.width/2,this},this.getBound=function(){return{left:this.x,top:this.y,right:this.x+this.width,bottom:this.y+this.height,width:this.width,height:this.height}},this.setBound=function(e,t,i,n){return this.setLocation(e,t),this.setSize(i,n),this},this.getDisplayBound=function(){return{left:this.x,top:this.y,right:this.x+this.width*this.scaleX,bottom:this.y+this.height*this.scaleY}},this.getDisplaySize=function(){return{width:this.width*this.scaleX,height:this.height*this.scaleY}},this.getPosition=function(e){var t,i=this.getBound();switch(e){case"Top_Left":t={x:i.left,y:i.top};break;case"Top_Center":t={x:this.cx,y:i.top};break;case"Top_Right":t={x:i.right,y:i.top};break;case"Middle_Left":t={x:i.left,y:this.cy};break;case"Middle_Center":t={x:this.cx,y:this.cy};break;case"Middle_Right":t={x:i.right,y:this.cy};break;case"Bottom_Left":t={x:i.left,y:i.bottom};break;case"Bottom_Center":t={x:this.cx,y:i.bottom};break;case"Bottom_Right":t={x:i.right,y:i.bottom};break;default:t={x:this.cx,y:this.cy};break}return t}}function i(){this.initialize=function(){i.prototype.initialize.apply(this,arguments),this.elementType="interactiveElement",this.dragable=!1,this.selected=!1,this.showSelected=0,this.selectedLocation=null,this.isMouseOver=!1;var e="dragable,selected,showSelected,isMouseOver".split(",");this.serializedProperties=this.serializedProperties.concat(e)},this.initialize(),this.paintSelected=function(e){(this.showSelected||this.selected)&&(e.save(),e.beginPath(),this.image?this.selected||(e.lineWidth=this.selectedBorderWidth,e.strokeStyle="rgba("+this.selectedBorderColor+","+this.alpha*this.selectedBorderAlpha+")","rect"==this.shape?e.rect(-this.width/2,-this.height/2,this.width,this.height):e.arc(0,0,this.width/2,0,2*Math.PI,!0)):(e.lineWidth=this.selectedBorderWidth,e.strokeStyle="rgba("+this.selectedBorderColor+","+this.alpha*this.selectedBorderAlpha+")",this.paintShape(e)),e.closePath(),e.stroke(),e.restore())},this.paintShape=function(e){},this.paintMouseover=function(e){return this.showSelected=1,this.paintSelected(e)},this.isInBound=function(e,t){return e>this.x&&e<this.x+this.width*Math.abs(this.scaleX)&&t>this.y&&t<this.y+this.height*Math.abs(this.scaleY)},this.selectedHandler=function(){this.selected=!0,this.selectedLocation={x:this.x,y:this.y}},this.unselectedHandler=function(){this.selected=!1,this.selectedLocation=null},this.dbclickHandler=function(e){this.dispatchEvent("dbclick",e)},this.clickHandler=function(e){this.dispatchEvent("click",e)},this.mousedownHander=function(e){this.dispatchEvent("mousedown",e)},this.mouseupHandler=function(e){this.dispatchEvent("mouseup",e)},this.mouseoverHandler=function(e){this.isMouseOver=!0,this.dispatchEvent("mouseover",e)},this.mousemoveHandler=function(e){this.dispatchEvent("mousemove",e)},this.mouseoutHandler=function(e){this.isMouseOver=!1,this.showSelected=0,this.dispatchEvent("mouseout",e)},this.mousedragHandler=function(e){var t=this.selectedLocation.x+e.dx,i=this.selectedLocation.y+e.dy;this.setLocation(t,i),this.dispatchEvent("mousedrag",e)},this.addEventListener=function(t,i){var n=this,s=function(e){i.call(n,e)};return this.messageBus||(this.messageBus=new e.util.MessageBus),this.messageBus.subscribe(t,s),this},this.dispatchEvent=function(e,t){return this.messageBus?(this.messageBus.publish(e,t),this):null},this.removeEventListener=function(e){this.messageBus.unsubscribe(e)},this.removeAllEventListener=function(){this.messageBus=new e.util.MessageBus};var t="click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,touchstart,touchmove,touchend".split(","),n=this;t.forEach((function(e){n[e]=function(t){null!=t?this.addEventListener(e,t):this.dispatchEvent(e)}}))}function n(){this.initialize=function(){n.prototype.initialize.apply(this,arguments),this.editAble=!1,this.selectedPoint=null},this.getCtrlPosition=function(e){var t=5,i=5,n=this.getPosition(e);return{left:n.x-t,top:n.y-i,right:n.x+t,bottom:n.y+i}},this.selectedHandler=function(t){n.prototype.selectedHandler.apply(this,arguments),this.selectedSize={width:this.width,height:this.height},t.scene.mode==e.SceneMode.edit&&(this.editAble=!0)},this.unselectedHandler=function(){n.prototype.unselectedHandler.apply(this,arguments),this.selectedSize=null,this.editAble=!1};var t=["Top_Left","Top_Center","Top_Right","Middle_Left","Middle_Right","Bottom_Left","Bottom_Center","Bottom_Right"];this.paintCtrl=function(e){if(0!=this.editAble){e.save();for(var i=0;i<t.length;i++){var n=this.getCtrlPosition(t[i]);n.left-=this.cx,n.right-=this.cx,n.top-=this.cy,n.bottom-=this.cy;var s=n.right-n.left,a=n.bottom-n.top;e.beginPath(),e.strokeStyle="rgba(0,0,0,0.8)",e.rect(n.left,n.top,s,a),e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle="rgba(255,255,255,0.3)",e.rect(n.left+1,n.top+1,s-2,a-2),e.stroke(),e.closePath()}e.restore()}},this.isInBound=function(e,i){if(this.selectedPoint=null,1==this.editAble)for(var s=0;s<t.length;s++){var a=this.getCtrlPosition(t[s]);if(e>a.left&&e<a.right&&i>a.top&&i<a.bottom)return this.selectedPoint=t[s],!0}return n.prototype.isInBound.apply(this,arguments)},this.mousedragHandler=function(e){if(null==this.selectedPoint){var t=this.selectedLocation.x+e.dx,i=this.selectedLocation.y+e.dy;this.setLocation(t,i),this.dispatchEvent("mousedrag",e)}else{if("Top_Left"==this.selectedPoint){var n=this.selectedSize.width-e.dx,s=this.selectedSize.height-e.dy;t=this.selectedLocation.x+e.dx,i=this.selectedLocation.y+e.dy;t<this.x+this.width&&(this.x=t,this.width=n),i<this.y+this.height&&(this.y=i,this.height=s)}else if("Top_Center"==this.selectedPoint){s=this.selectedSize.height-e.dy,i=this.selectedLocation.y+e.dy;i<this.y+this.height&&(this.y=i,this.height=s)}else if("Top_Right"==this.selectedPoint){n=this.selectedSize.width+e.dx,i=this.selectedLocation.y+e.dy;i<this.y+this.height&&(this.y=i,this.height=this.selectedSize.height-e.dy),n>1&&(this.width=n)}else if("Middle_Left"==this.selectedPoint){n=this.selectedSize.width-e.dx,t=this.selectedLocation.x+e.dx;t<this.x+this.width&&(this.x=t),n>1&&(this.width=n)}else if("Middle_Right"==this.selectedPoint){n=this.selectedSize.width+e.dx;n>1&&(this.width=n)}else if("Bottom_Left"==this.selectedPoint){n=this.selectedSize.width-e.dx,t=this.selectedLocation.x+e.dx;n>1&&(this.x=t,this.width=n);s=this.selectedSize.height+e.dy;s>1&&(this.height=s)}else if("Bottom_Center"==this.selectedPoint){s=this.selectedSize.height+e.dy;s>1&&(this.height=s)}else if("Bottom_Right"==this.selectedPoint){n=this.selectedSize.width+e.dx;n>1&&(this.width=n);s=this.selectedSize.height+e.dy;s>1&&(this.height=s)}this.dispatchEvent("resize",e)}}}t.prototype=new e.Element,Object.defineProperties(t.prototype,{cx:{get:function(){return this.x+this.width/2},set:function(e){this.x=e-this.width/2}},cy:{get:function(){return this.y+this.height/2},set:function(e){this.y=e-this.height/2}}}),i.prototype=new t,n.prototype=new i,e.DisplayElement=t,e.InteractiveElement=i,e.EditableElement=n}(o),function(e){function t(i){this.initialize=function(i){t.prototype.initialize.apply(this,arguments),this.elementType="node",this.zIndex=e.zIndex_Node,this.text=i,this.font="13px Consolas",this.fontColor="20,20,20",this.borderWidth=0,this.borderColor="20,255,20",this.selectedBorderColor="255,0,0",this.selectedBorderWidth=10,this.selectedBorderAlpha=.7,this.borderRadius=0,this.shadowColor="20,255,20",this.dragable=!0,this.textPosition="Middle_Center",this.textOffsetX=0,this.textOffsetY=0,this.transformAble=!0,this.inLinks=null,this.outLinks=null,this.radius=50,this.width=40,this.height=80,this.labelBackGround=null,this.labelBorderWidth=0,this.labelBorderColor="255,255,255",this.textLines=[i],this.maxLineWidth=0,this.icon={font:"bold 20px Consolas",text:null,color:"255,255,255",left:-this.width,top:this.height/2},"rect"!=this.shape&&(this.width=this.height=this.radius);var n="text,font,fontColor,textPosition,textOffsetX,textOffsetY,borderRadius".split(",");this.serializedProperties=this.serializedProperties.concat(n)},this.initialize(i),this.drawNodeImg=function(e,t,i,n,s){if("rect"==this.shape)e.drawImage(t,i,n,this.width,this.height);else{var a=2*s,o=i+s,r=n+s;e.arc(o,r,s,0,2*Math.PI),e.clip(),e.drawImage(t,i,n,a,a)}},this.paint=function(e,t){if("rect"!=this.shape&&(this.width=this.height=this.radius),this.image){this.paintBorder(e);var i=e.globalAlpha;e.save(),e.globalAlpha=this.alpha,this.drawNodeImg(e,this.image,-this.width/2,-this.height/2,this.width/2),e.globalAlpha=i,e.restore()}else this.selected&&!t&&this.paintSelected(e),e.save(),e.beginPath(),this.paintShape(e),e.closePath(),this.borderWidth>0&&!t&&(this.lineDash&&this.lineDash.length>1&&e.setLineDash(this.lineDash),e.lineWidth=this.borderWidth,e.strokeStyle="rgba("+this.borderColor+","+this.alpha+")",e.stroke()),this.paintShadow(e),e.fillStyle="rgba("+this.fillColor+","+this.alpha+")",e.fill(),e.restore(),this.icon&&this.icon.text&&this.paintIcon(e);t||(this.paintText(e),this.paintCtrl(e),this.paintTipText(e))},this.paintShape=function(e){switch(this.shape){case"rect":if(this.borderRadius){var t=Math.PI/180,i=this.borderRadius,n=-this.width/2,s=-this.height/2;this.width-2*i<0&&(i=this.width/2),this.height-2*i<0&&(i=this.height/2),e.moveTo(n+i,s),e.lineTo(n+this.width-i,s),e.arc(n+this.width-i,s+i,i,270*t,360*t,!1),e.lineTo(n+this.width,s+this.height-i),e.arc(n+this.width-i,s+this.height-i,i,0,90*t,!1),e.lineTo(n+i,s+this.height),e.arc(n+i,s+this.height-i,i,90*t,180*t,!1),e.lineTo(n,s+i),e.arc(n+i,s+i,i,180*t,270*t,!1)}else e.rect(-this.width/2,-this.height/2,this.width,this.height);break;case"square":e.rect(-this.width/2,-this.height/2,this.width,this.height);break;case"ellipse":e.ellipse(0,0,2*this.width/3,this.width/2,0,0,2*Math.PI);break;case"triangle":e.moveTo(0,-this.width/2),e.lineTo(-this.width/2,this.width/2),e.lineTo(this.width/2,this.width/2);break;case"text":e.font=this.font,e.textAlign="center",e.textBaseline="middle",e.fillStyle="rgba("+this.fillColor+","+this.alpha+")",this.processLabel(e);var a=e.measureText("田").width,o=this.textLines.length;if(1==o)e.fillText(this.textLines[0],0,0);else for(var r=0;r<o;r++)e.fillText(this.textLines[r],0,r*a+(0==r?0:2*r));break;case"star":i=.41*this.width;for(var l=0;l<10;l++){var h=l%2===0?1.3*i:.5*i;e.lineTo(h*Math.sin(2*l*Math.PI/10),.1*i-h*Math.cos(2*l*Math.PI/10))}break;case"polygon":for(var c=2*Math.PI/6,d=0;d<6;d++){n=Math.cos(d*c),s=Math.sin(d*c);e.lineTo(n*(this.width/2),s*(this.width/2))}break;default:e.arc(0,0,this.width/2,0,2*Math.PI,!0);break}},this.paintTipText=function(e){if(null!=this.tipText&&""!=this.tipText){var t=this.alarmColor||"0,250,0",i=this.alarmAlpha||.8*this.alpha;e.beginPath(),e.font=this.alarmFont||"10px Consolas";var n=e.measureText(this.tipText).width+6,s=e.measureText("田").width+6;this.width,this.height;e.strokeStyle="rgba("+t+", "+i+")",e.fillStyle="rgba("+t+", "+i+")",e.DGraphRoundRect(this.width/3,-this.height/2,n+5,s,8),e.stroke(),e.fill(),e.beginPath(),e.fillStyle="rgba(250,250,250, "+this.alpha+")",e.fillText(this.tipText,this.width/3+5,-this.height/2+12),e.closePath()}},this.paintText=function(e){if(!this.shape||"text"!=this.shape){var t,i=this;if(this.showlabel&&1==this.showlabel){if(t=this.text=this.label,null!=t&&""!=t){var n;e.save(),e.fillStyle="rgba("+this.fontColor+", "+this.alpha+")",e.font=this.font,this.processLabel(e);var s=e.measureText("田").width;if(1==this.wrapText){var a=this.buildTextArray(t),o=0;a.forEach((function(t,r){t=String(t);var l=e.measureText(t.replace(/ /g,"a")).width;o=Math.max(o,l),n=i.getTextPostion(i.textPosition,l,s),e.fillText(t,n.x,-s/2*a.length+(r+1)*s)})),this.radius=o+8<this.width?this.width:o+8}else{var r=this.textLines.length,l=r*s;if(this.labelBackGround&&(n=this.getTextPostion(this.textPosition,this.maxLineWidth,s),e.save(),e.fillStyle="rgba("+this.labelBackGround+","+this.alpha+")",e.fillRect(n.x-3,n.y-s-s/2,this.maxLineWidth+6,l+s+6),e.restore()),this.labelBorderWidth>0&&(e.lineWidth=this.labelBorderWidth,e.strokeStyle="rgba("+this.labelBorderColor+","+this.alpha+")",e.lineJoin="round"),1==r){var h=e.measureText(this.textLines[0]).width;n=this.getTextPostion(this.textPosition,h,s),this.labelBorderWidth>0&&e.strokeText(this.textLines[0],n.x,n.y),e.fillText(this.textLines[0],n.x,n.y)}else for(var c=0;c<r;c++){h=e.measureText(this.textLines[c]).width;n=this.getTextPostion(this.textPosition,h,s),this.labelBorderWidth>0&&e.strokeText(this.textLines[c],n.x,n.y+c*s+(0==c?0:2*c)),e.fillText(this.textLines[c],n.x,n.y+c*s+(0==c?0:2*c))}}e.restore()}}else t=this.text=null}},this.processLabel=function(e){var t=[];if(this.label&&""!=this.label){t=String(this.label).split("\n");for(var i=0;i<t.length;i++)this.maxLineWidth=Math.max(e.measureText(t[i]).width,this.maxLineWidth)}this.textLines=t},this.buildTextArray=function(e){var t=String(e).length,i=[];return t<5?i.push(e):t>=5&&t<=9?(i.push(e.substring(0,4)),i.push(e.substring(4))):t>9&&t<=13?(i.push(e.substring(0,4)),i.push(e.substring(4,9)),i.push(e.substring(9))):(i.push(e.substring(0,4)),i.push(e.substring(4,9)),i.push(e.substring(9,12)+"..")),i},this.paintShadow=function(e){this.showShadow&&this.selected&&(e.shadowBlur=20,e.shadowColor="rgba("+this.shadowColor+","+.9*this.alpha+")",e.shadowOffsetX=0,e.shadowOffsetY=0)},this.paintIcon=function(e){e.save(),e.fillStyle="rgba("+this.icon.color+", "+this.alpha+")",e.font=this.icon.font,e.fillText(this.icon.text,this.icon.left||5,this.icon.top||5),e.restore()},this.paintBorder=function(e){e.save(),e.beginPath(),this.showShadow&&this.selected&&this.paintShadow(e);var t=0;(this.selected||this.showSelected)&&(t=this.selectedBorderWidth),"rect"==this.shape?e.rect(-this.width/2,-this.height/2,this.width,this.height):e.arc(0,0,this.width/2,0,2*Math.PI,!1),e.closePath(),t>0&&(this.selected||this.showSelected)&&(e.lineWidth=this.borderWidth+t,e.strokeStyle="rgba("+this.selectedBorderColor+","+this.alpha*this.selectedBorderAlpha+")",e.stroke()),this.borderWidth>0&&(this.lineDash&&this.lineDash.length>1&&e.setLineDash(this.lineDash),e.lineWidth=this.borderWidth,e.strokeStyle="rgba("+this.borderColor+","+this.alpha+")",e.stroke()),e.fillStyle="rgba("+this.fillColor+","+this.alpha+")",e.fill(),e.restore()},this.getTextPostion=function(e,t,i){var n=null;return null==e||"Bottom_Center"==e?n={x:-this.width/2+(this.width-t)/2,y:this.height/2+i}:"Top_Center"==e?n={x:-this.width/2+(this.width-t)/2,y:-this.height/2-i/2}:"Top_Right"==e?n={x:this.width/2,y:-this.height/2-i/2}:"Top_Left"==e?n={x:-this.width/2-t,y:-this.height/2-i/2}:"Bottom_Right"==e?n={x:this.width/2,y:this.height/2+i}:"Bottom_Left"==e?n={x:-this.width/2-t,y:this.height/2+i}:"Middle_Center"==e?n={x:-this.width/2+(this.width-t)/2,y:i/2}:"Middle_Right"==e?n={x:this.width/2,y:i/2}:"Middle_Left"==e&&(n={x:-this.width/2-t,y:i/2}),null==n&&(n={x:-this.width/2+(this.width-t)/2,y:this.height/2+i}),null!=this.textOffsetX&&(n.x+=this.textOffsetX),null!=this.textOffsetY&&(n.y+=this.textOffsetY),n},this.setImage=function(e,t){if(null==e)throw new Error("Node.setImage error! image is null!");var i=this;if("string"==typeof e){var s=n[e];null==s?(s=new Image,s.setAttribute("crossOrigin","Anonymous"),s.src=e,s.onload=function(){i.image=s}):(this.setSize(s.width,s.height),this.image=s)}else this.image=e,this.setSize(e.width,e.height)},this.removeHandler=function(e){var t=this;this.outLinks&&(this.outLinks.forEach((function(i){i.source===t&&e.remove(i)})),this.outLinks=null),this.inLinks&&(this.inLinks.forEach((function(i){i.target===t&&e.remove(i)})),this.inLinks=null)}}function i(){i.prototype.initialize.apply(this,arguments)}var n={};t.prototype=new e.EditableElement,i.prototype=new t,e.Node=i}(o),function(e){function t(e,t){var i=[];if(null==e||null==t)return i;if(e&&t&&e.outLinks&&t.inLinks)for(var n=0;n<e.outLinks.length;n++)for(var s=e.outLinks[n],a=0;a<t.inLinks.length;a++){var o=t.inLinks[a];s===o&&i.push(o)}return i}function i(e,i,n){if(null!=n&&1==n){var s=t(e,i),a=t(i,e),o=s.concat(a);return o}return t(e,i)}function n(e){var t=i(e.source,e.target);return t.filter((function(t){return e!==t}))}function s(e,t,n){return i(e,t,n).length}function a(t,i,o){function r(t,i){var n=e.util.lineF(t.cx,t.cy,i.cx,i.cy),s=t.getBound(),a=e.util.intersectionLineBound(n,s);return a}this.initialize=function(t,i,n){if(a.prototype.initialize.apply(this,arguments),this.elementType="link",this.zIndex=e.zIndex_Link,0!=arguments.length){this.text=n,this.source=t,this.target=i,this.source&&null==this.source.outLinks&&(this.source.outLinks=[]),this.source&&null==this.source.inLinks&&(this.source.inLinks=[]),this.target&&null==this.target.inLinks&&(this.target.inLinks=[]),this.target&&null==this.target.outLinks&&(this.target.outLinks=[]),null!=this.source&&this.source.outLinks.push(this),null!=this.target&&this.target.inLinks.push(this),this.caculateIndex(),this.font="13px Consolas",this.fontColor="120,120,120",this.lineWidth=3,this.lineJoin="round",this.showShadow=!0,this.shadowColor="10,250,10",this.selectedColor="10,10,230",this.selectedAlpha=1,this.transformAble=!1,this.textOffsetX=0,this.textOffsetY=0,this.curverness=.5,this.arrowsRadius=null,this.arrowsOffset=0,this.dashedPattern=null,this.path=[];var s="text,font,fontColor,lineWidth,lineJoin".split(",");this.serializedProperties=this.serializedProperties.concat(s)}},this.caculateIndex=function(){var e=s(this.source,this.target,!1);e>0&&(this.nodeIndex=e-1)},this.initialize(t,i,o),this.removeHandler=function(){var e=this;this.source&&this.source.outLinks&&(this.source.outLinks=this.source.outLinks.filter((function(t){return t!==e}))),this.target&&this.target.inLinks&&(this.target.inLinks=this.target.inLinks.filter((function(t){return t!==e})));var t=n(this);t.forEach((function(e,t){e.nodeIndex=t}))},this.getStartPosition=function(){var e={x:this.source.cx,y:this.source.cy};return e},this.getEndPosition=function(){var e={x:this.target.cx,y:this.target.cy};return e=r(this.target,this.source),null==e&&(e={x:this.target.cx,y:this.target.cy}),e},this.getPath=function(){var e=this.getStartPosition(),t=this.getEndPosition();return[e,t]},this.paintPath=function(e,t){},this.paintLoop=function(e){var t=this.source.radius/2,i=Math.round(t+(this.nodeIndex+1));e.beginPath(),e.arc(this.source.x-t/2,this.source.y-t/2,i,0,2*Math.PI),e.stroke(),e.closePath()},this.paintArrow=function(e,t,i){},this.paint=function(e){},this.paintText=function(e,t){},this.paintSelected=function(e){this.showShadow&&(e.shadowBlur=5,e.shadowColor="rgba("+this.shadowColor+",0.8)",e.shadowOffsetX=0,e.shadowOffsetY=0)},this.isInBound=function(t,i){if(this.source===this.target){var n=Math.round(this.source.radius/2+(this.nodeIndex+1)),s=e.util.getDistance(this.source,{x:t,y:i})-n;return Math.abs(s)<=3}for(var a=!1,o=1;o<this.path.length;o++){var r=this.path[o-1],l=this.path[o];if(1==e.util.isPointInLine({x:t,y:i},r,l)){a=!0;break}}return a}}function r(e,t,i){this.initialize=function(){r.prototype.initialize.apply(this,arguments)},this.initialize(e,t,i),this.getStartPosition=function(){var e={x:this.source.cx,y:this.source.cy};return e},this.getEndPosition=function(){var e={x:this.target.cx,y:this.target.cy};return e},this.getPath=function(e){var t=this.getStartPosition(),i=this.getEndPosition();return[t,i]},this.paintText=function(e,t){}}function l(e,t,i){this.initialize=function(){r.prototype.initialize.apply(this,arguments)},this.initialize(e,t,i),this.paint=function(e,i){if(null!=this.source&&null!=!this.target){if(this.source.showSelected||this.target.showSelected?this.showSelected=1:this.showSelected=0,"source"==this.colorType?this.strokeColor=this.source.fillColor:"target"!=this.colorType&&"both"!=this.colorType||(this.strokeColor=this.target.fillColor),this.source===this.target)return this.setLineStyle(e),this.paintLoop(e),void(this.showlabel?(this.text=this.label,this.paintText(e,t)):this.text=null);s(this.target,this.source,!0)>1&&(this.lineType="curver"),this.paintPath(e,t),this.showlabel&&!i?(this.text=this.label,this.paintText(e,t)):this.text=null,this.showArrow&&this.paintArrow(e)}},this.paintPath=function(e,t){var i=this.lineType;switch(i){case"direct":this.paintDrirectLine(e,t);break;case"curver":this.paintCurverLink(e,t);break;case"vdirect":this.lineDash=[8,5],this.paintDrirectLine(e,t);break;case"vcurver":this.lineDash=[8,5],this.paintCurverLink(e,t);break;case"vlink":this.paintVerticalLink(e,t);break;case"hlink":this.paintHorizolLink(e,t);break;case"bezier":this.paintBezierLink(e,t);break;case"vbezier":this.paintVBezierLink(e,t);break;case"hbezier":this.paintHBezierLink(e,t);break;case"arrowline":this.paintArrowLine(e,t);break;case"minderline":this.paintXMinderLine(e,t);break;default:this.paintDrirectLine(e,t);break}},this.paintText=function(e,t){if(this.source===this.target){var i=-(Math.PI/2+Math.PI/4),n=this.width/2*(this.nodeIndex+1)/2,s=this.source.x+n*Math.cos(i),a=this.source.y+n*Math.sin(i);return e.save(),e.beginPath(),e.fillStyle="rgba("+this.fontColor+", "+this.alpha+")",e.fillText(this.text,s,a),e.stroke(),e.closePath(),void e.restore()}"direct"!=this.lineType&&"vdirect"!=this.lineType||this.paintDrirectLineText(e,t)},this.paintArrow=function(e){"direct"!=this.lineType&&"vdirect"!=this.lineType||this.paintDrirectLineArrow(e)},this.setLineStyle=function(e){if(e.lineJoin="round","both"==this.colorType){var t=e.createLinearGradient(this.source.cx,this.source.cy,this.target.cx,this.target.cy);t.addColorStop(0,"rgba("+this.source.fillColor+","+this.alpha+")"),t.addColorStop(1,"rgba("+this.target.fillColor+","+this.alpha+")"),e.strokeStyle=t}else e.strokeStyle="rgba("+this.strokeColor+","+this.alpha+")";(this.selected||this.showSelected)&&(e.strokeStyle="rgba("+this.selectedColor+","+this.selectedAlpha+")"),e.lineWidth=this.lineWidth,this.lineDash&&this.lineDash.length>1&&e.setLineDash(this.lineDash)},this.paintCurverLink=function(e){var t=this.source,i=this.target,n=t.radius/2*t.scaleX||20,s=i.radius/2*i.scaleX||20,a=t.cx,o=t.cy;if(this.showArrow)var r=this.getArrowRadius(),l=Math.atan2(i.cy-t.cy,i.cx-t.cx),h=-(this.target.radius/2+r/2)*this.target.scaleX,c=this.target.cx+h*Math.cos(l),d=this.target.cy+h*Math.sin(l);else c=this.target.cx,d=this.target.cy;var u,f,p,b,g,v,y,m=c-a,x=d-o,k=a<c?1:-1,w={},L=.5;if(t.id===i.id)w=this.getSelfLoopControlPoints(a,o,n),u=this.getPointOnBezierCurve(L,a,o,c,d,w.x1,w.y1,w.x2,w.y2),f=Math.atan2(1,1);else{var E=4-.5*this.nodeIndex;this.nodeIndex/2==0&&(E=-E),w=this.getQuadraticControlPoint(a,o,c,d,E,this.curverness),u=this.getPointOnQuadraticCurve(L,a,o,c,d,w.x,w.y),f=Math.atan2(x*k,m*k)}e.beginPath(),e.moveTo(a,o),this.setLineStyle(e),t.id===i.id?e.bezierCurveTo(w.x1,w.y1,w.x2,w.y2,c,d):e.quadraticCurveTo(w.x,w.y,c,d),e.stroke(),e.closePath(),this.path=[],this.path.push({x:a,y:o}),this.path.push({x:(a+w.x)/2,y:(o+w.y)/2}),this.path.push({x:(c+w.x)/2,y:(d+w.y)/2}),this.path.push({x:c,y:d}),this.showArrow&&(t.id===i.id?(p=Math.sqrt(Math.pow(c-w.x1,2)+Math.pow(d-w.y1,2)),b=w.x1+(c-w.x1)*(p-r-s)/p,g=w.y1+(d-w.y1)*(p-r-s)/p,v=(c-w.x1)*r/p,y=(d-w.y1)*r/p):(p=Math.sqrt(Math.pow(c-w.x,2)+Math.pow(d-w.y,2)),b=w.x+(c-w.x)*(p-r/2)/p,g=w.y+(d-w.y)*(p-r/2)/p,v=(c-w.x)*r/p,y=(d-w.y)*r/p),e.save(),e.beginPath(),e.moveTo(b+v,g+y),e.lineTo(b+y*L,g-v*L),e.lineTo(b-y*L,g+v*L),e.lineTo(b+v,g+y),e.closePath(),this.selected||this.showSelected?e.fillStyle="rgba("+this.selectedColor+","+this.selectedAlpha+")":e.fillStyle="rgba("+this.strokeColor+","+this.alpha+")",e.fill(),e.restore()),this.showlabel&&this.text&&this.text.length>0&&(e.save(),e.font=this.font,e.fillStyle="rgba("+this.fontColor+", "+this.alpha+")",e.textAlign="center",e.textBaseline="alphabetic",e.translate(u.x,u.y),e.rotate(f),e.fillText(this.text,0,-this.lineWidth/2-3),e.restore())},this.paintArrowLine=function(e,t){var i,n,s,a,o=this.lineWidth;o=o<3?3:o,this.showArrow?(i=this.source.cx,n=this.source.cy,s=this.target.cx,a=this.target.cy):(i=this.target.cx,n=this.target.cy,s=this.source.cx,a=this.source.cy);var r=function(e,t,i,n){var s=i*Math.cos(n),a=i*Math.sin(n);return s+=e,a+=t,{x:s,y:a}},l=Math.sqrt((a-n)*(a-n)+(s-i)*(s-i)),h=Math.asin(Math.abs(a-n)/l);i>s&&a>n?h=Math.PI-h:i>s&&n>a?h+=Math.PI:s>i&&n>a&&(h=2*Math.PI-h);var c=r(i,n,l-2*o,h),d=c.x,u=c.y,f=r(d,u,o,h-.5*Math.PI),p=r(d,u,2*o,h-.5*Math.PI),b=r(d,u,o,h+.5*Math.PI),g=r(d,u,2*o,h+.5*Math.PI);if(e.save(),e.beginPath(),e.moveTo(i,n),e.lineTo(f.x,f.y),e.lineTo(p.x,p.y),this.showArrow&&e.lineTo(s,a),e.lineTo(g.x,g.y),e.lineTo(b.x,b.y),e.closePath(),e.lineJoin="round","both"==this.colorType){var v=e.createLinearGradient(this.source.cx,this.source.cy,this.target.cx,this.target.cy);v.addColorStop(0,"rgba("+this.source.fillColor+","+this.alpha+")"),v.addColorStop(1,"rgba("+this.target.fillColor+","+this.alpha+")"),e.fillStyle=v}else e.fillStyle="rgba("+this.strokeColor+","+this.alpha+")";(this.selected||this.showSelected)&&(e.fillStyle="rgba("+this.selectedColor+","+this.selectedAlpha+")"),e.fill(),e.restore(),this.path=[],this.path.push({x:this.source.cx,y:this.source.cy}),this.path.push({x:this.target.cx,y:this.target.cy})},this.paintXMinderLine=function(e,t){var i=this.source,n=this.target,s=i.cx,a=i.cy,o=n.cx,r=n.cy;s>o?o=n.x+n.width/2:s<o&&(o=n.x),e.beginPath(),this.setLineStyle(e),e.moveTo(i.cx,i.cy),e.lineTo((s+o)/2,a),e.lineTo((s+o)/2,r),e.lineTo(n.cx,n.cy),e.stroke(),e.closePath(),this.path=[],this.path.push({x:s,y:a}),this.path.push({x:(s+o)/2,y:a}),this.path.push({x:(s+o)/2,y:r}),this.path.push({x:o,y:r})},this.paintDrirectLine=function(e){var t=this.target.cx,i=this.target.cy;if(this.showArrow){var n,s;if(this.arrowsRadius=this.getArrowRadius(),"rect"==this.target.shape){var a=this.getPath();n=a[0],s=a[1];var o=Math.atan2(s.y-n.y,s.x-n.x);s.x=s.x-this.arrowsRadius*Math.cos(o),s.y=s.y-this.arrowsRadius*Math.sin(o)}else n={x:this.source.cx,y:this.source.cy},s={x:this.target.cx,y:this.target.cy},this.arrowsOffset=-this.target.radius/2*this.target.scaleX-this.arrowsRadius;var r=this.arrowsOffset;o=Math.atan2(s.y-n.y,s.x-n.x),t=s.x+r*Math.cos(o),i=s.y+r*Math.sin(o)}e.beginPath(),e.moveTo(this.source.cx,this.source.cy),this.setLineStyle(e),e.lineTo(t,i),e.stroke(),e.closePath(),this.path=[],this.path.push({x:this.source.cx,y:this.source.cy}),this.path.push({x:t,y:i})},this.paintDrirectLineText=function(e,t){var i=this.source,n=this.target,s={x:i.cx+(n.cx-i.cx)/2,y:i.cy+(n.cy-i.cy)/2},a={x:n.cx-i.cx,y:n.cy-i.cy},o=Math.atan2(a.y,a.x);o>Math.PI/2&&(o=-(Math.PI-o)),o<-Math.PI/2&&(o=-(-Math.PI-o)),e.save(),e.beginPath(),e.font=this.font,e.translate(s.x,s.y),e.rotate(o),e.textAlign="center",e.textBaseline="bottom",e.fillStyle="rgba("+this.fontColor+", "+this.alpha+")",e.fillText(this.text,0,0),e.stroke(),e.closePath(),e.restore()},this.paintDrirectLineArrow=function(e){var t,i;if("rect"==this.target.shape){var n=this.getPath();t=n[0],i=n[1]}else t={x:this.source.cx,y:this.source.cy},i={x:this.target.cx,y:this.target.cy},this.arrowsOffset=-this.target.radius/2*this.target.scaleX;this.arrowsRadius=this.getArrowRadius();var s=this.arrowsOffset,a=this.arrowsRadius/2,r=Math.atan2(i.y-t.y,i.x-t.x),l=o.util.getDistance(t,i)-this.arrowsRadius,h=t.x+(l+s)*Math.cos(r),c=t.y+(l+s)*Math.sin(r),d=i.x+s*Math.cos(r),u=i.y+s*Math.sin(r);r-=Math.PI/2;var f={x:h+a*Math.cos(r),y:c+a*Math.sin(r)},p={x:h+a*Math.cos(r-Math.PI),y:c+a*Math.sin(r-Math.PI)};e.beginPath(),this.selected||this.showSelected?e.fillStyle="rgba("+this.selectedColor+","+this.selectedAlpha+")":e.fillStyle="rgba("+this.strokeColor+","+this.alpha+")",e.moveTo(f.x,f.y),e.lineTo(d,u),e.lineTo(p.x,p.y),e.closePath(),e.fill()},this.getArrowRadius=function(){var e=Math.round(3*this.lineWidth);return Math.min(Math.max(e,10),100)},this.getTargetBorderPoint=function(){var e=0;if(this.showArrow){var t=this.target;e=t.radius,e="rect"==t.shape?-1!=["bezier","vbezier","vlink"].indexOf(this.lineType)?(t.height/2+t.borderWidth)*t.scaleX:(t.width/2+t.borderWidth)*t.scaleX:(t.radius/2+t.borderWidth)*t.scaleX}return e},this.paintSpecialArrow=function(e,t,i){var n={x:t.x,y:t.y},s={x:i.x,y:i.y};this.arrowsRadius=this.getArrowRadius();var a=this.lineWidth,o=this.arrowsRadius/2,r=Math.atan2(s.y-n.y,s.x-n.x),l=Math.sqrt((n.x-s.x)*(n.x-s.x)+(n.y-s.y)*(n.y-s.y))-this.arrowsRadius,h=n.x+(l+a)*Math.cos(r),c=n.y+(l+a)*Math.sin(r),d=s.x+a*Math.cos(r),u=s.y+a*Math.sin(r);r-=Math.PI/2;var f={x:h+o*Math.cos(r),y:c+o*Math.sin(r)},p={x:h+o*Math.cos(r-Math.PI),y:c+o*Math.sin(r-Math.PI)};e.beginPath(),this.selected||this.showSelected?e.fillStyle="rgba("+this.selectedColor+","+this.selectedAlpha+")":e.fillStyle="rgba("+this.strokeColor+","+this.alpha+")",e.moveTo(f.x,f.y),e.lineTo(d,u),e.lineTo(p.x,p.y),e.closePath(),e.fill()},this.paintVerticalLink=function(e){var t=this.source,i=this.target,n=t.cx,s=t.cy,a=i.cx,o=i.cy,r=this.getTargetBorderPoint();s>o&&(r=-r),e.beginPath(),this.setLineStyle(e),e.moveTo(n,s),e.lineTo(n,(s+o)/2),e.lineTo(a,(s+o)/2),e.lineTo(a,o-r),e.stroke(),e.closePath(),this.path=[],this.path.push({x:n,y:s}),this.path.push({x:n,y:(s+o)/2}),this.path.push({x:a,y:(s+o)/2}),this.path.push({x:a,y:o}),this.showArrow&&this.paintSpecialArrow(e,{x:a,y:(s+o)/2},{x:a,y:o-r})},this.paintHorizolLink=function(e){var t=this.source,i=this.target,n=t.cx,s=t.cy,a=i.cx,o=i.cy,r=this.getTargetBorderPoint();n>a&&(r=-r),e.beginPath(),this.setLineStyle(e),e.moveTo(t.cx,t.cy),e.lineTo((n+a)/2,s),e.lineTo((n+a)/2,o),e.lineTo(a-r,o),e.stroke(),e.closePath(),this.path=[],this.path.push({x:n,y:s}),this.path.push({x:(n+a)/2,y:s}),this.path.push({x:(n+a)/2,y:o}),this.path.push({x:a,y:o}),this.showArrow&&this.paintSpecialArrow(e,{x:(n+a)/2,y:o},{x:a-r,y:o})},this.paintBezierLink=function(e){var t=this.source,i=this.target,n=t.cx,s=t.cy,a=i.cx,o=i.cy,r=this.getArrowRadius(),l=o-s,h=Math.max(l/6,10),c=n,d=s,u=a,f=o-h-i.width/4*i.scaleX-r*i.scaleX,p=this.getTargetBorderPoint();s>o&&(f=o+h+i.width/4*i.scaleX+r*i.scaleX,p=-p,r=-r);var b=n,g=(d+f)*this.curverness,v=a,y=(d+f)*this.curverness;e.beginPath(),this.setLineStyle(e),e.moveTo(n,s),e.lineTo(c,d),e.bezierCurveTo(b,g,v,y,u,f),e.lineTo(a,o-p),e.stroke(),e.closePath(),this.path=[],this.path.push({x:n,y:s}),this.path.push({x:c,y:d}),this.path.push({x:b,y:g}),this.path.push({x:v,y:y}),this.path.push({x:u,y:f}),this.path.push({x:a,y:o}),this.showArrow&&this.paintSpecialArrow(e,{x:u,y:f},{x:a,y:o-p})},this.paintHBezierLink=function(e){var t=this.source,i=this.target,n=t.cx,s=t.cy,a=i.cx-i.width/2*i.scaleX-this.getArrowRadius()*i.scaleX-10,o=i.cy,r=this.getTargetBorderPoint();n>i.cx&&(a=i.cx+i.width/2*i.scaleX+this.getArrowRadius()*i.scaleX+10,r=-r);var l=(n+a)*this.curverness;y3=s,x4=(n+a)*this.curverness,y4=o,e.beginPath(),this.setLineStyle(e),e.moveTo(t.cx,t.cy),e.bezierCurveTo(l,y3,x4,y4,a,o),e.lineTo(i.cx-r,i.cy),e.stroke(),e.closePath(),this.path=[],this.path.push({x:n,y:s}),this.path.push({x:l,y:y3}),this.path.push({x:x4,y:y4}),this.path.push({x:a,y:o}),this.path.push({x:i.cx,y:i.cy}),this.showArrow&&this.paintSpecialArrow(e,{x:a,y:o},{x:i.cx-r,y:i.cy})},this.paintVBezierLink=function(e){var t=this.source,i=this.target,n=t.cx,s=t.cy,a=i.cx,o=i.cy-i.width/2*i.scaleX-this.getArrowRadius()*i.scaleX,r=this.getTargetBorderPoint();s>i.cy&&(o=i.cy+i.width/2*i.scaleX+this.getArrowRadius()*i.scaleX,r=-r);var l=n,h=(s+o)*this.curverness,c=a,d=(s+o)*this.curverness;e.beginPath(),this.setLineStyle(e),e.moveTo(t.cx,t.cy),e.bezierCurveTo(l,h,c,d,a,o),e.lineTo(a,i.cy-r),e.stroke(),e.closePath(),this.path=[],this.path.push({x:n,y:s}),this.path.push({x:l,y:h}),this.path.push({x:c,y:d}),this.path.push({x:a,y:o}),this.path.push({x:i.cx,y:i.cy}),this.showArrow&&this.paintSpecialArrow(e,{x:a,y:o},{x:i.cx,y:i.cy-r})},this.getSelfLoopControlPoints=function(e,t,i){return{x1:e-7*i,y1:t,x2:e,y2:t+7*i}},this.getPointOnBezierCurve=function(e,t,i,n,s,a,o,r,l){var h=Math.pow(1-e,3),c=3*e*Math.pow(1-e,2),d=3*Math.pow(e,2)*(1-e),u=Math.pow(e,3);return{x:h*t+c*a+d*r+u*n,y:h*i+c*o+d*l+u*s}},this.getQuadraticControlPoint=function(e,t,i,n,s,a){return a=a||.5,{x:(e+i)*a+(n-t)/(s||4),y:(t+n)*a+(e-i)/(s||4)}},this.getPointOnQuadraticCurve=function(e,t,i,n,s,a,o){var r=2;return{x:Math.pow(1-e,r)*t+2*(1-e)*e*a+Math.pow(e,r)*n,y:Math.pow(1-e,r)*i+2*(1-e)*e*o+Math.pow(e,r)*s}}}a.prototype=new e.InteractiveElement,e.Link=a,r.prototype=new a,l.prototype=new a,e.Edge=l}(o),function(e){function t(i){this.initialize=function(i){t.prototype.initialize.apply(this,null),this.elementType="box",this.zIndex=e.zIndex_Box,this.width=100,this.height=100,this.childs=[],this.alpha=.5,this.dragable=!0,this.childDragble=!0,this.visible=!0,this.fillColor="10,250,10",this.borderWidth=0,this.borderColor="255,255,255",this.borderRadius=5,this.font="nomral 20px 微软雅黑",this.fontColor="0,255,0",this.text=i,this.textPosition="Top_Left",this.textOffsetX=0,this.textOffsetY=30,this.layout=new e.layout.AutoBoxLayout},this.initialize(i),this.add=function(e){this.childs.push(e),e.dragable=this.childDragble},this.remove=function(e){for(var t=0;t<this.childs.length;t++)if(this.childs[t]===e){e.parentContainer=null,this.childs=this.childs.del(t),e.lastParentContainer=this;break}},this.removeAll=function(){this.childs=[]},this.setLocation=function(e,t){var i=e-this.x,n=t-this.y;this.x=e,this.y=t;for(var s=0;s<this.childs.length;s++){var a=this.childs[s];a.setLocation(a.x+i,a.y+n)}},this.doLayout=function(e){e&&e(this,this.childs)},this.paint=function(e){this.visible&&(this.layout&&this.layout(this,this.childs),e.beginPath(),e.fillStyle="rgba("+this.fillColor+","+this.alpha+")",e.strokeStyle="rgba("+this.fillColor+",1)",e.lineWidth=2,null==this.borderRadius||0==this.borderRadius?e.rect(this.x,this.y,this.width,this.height):e.DGraphRoundRect(this.x,this.y,this.width,this.height,this.borderRadius),e.fill(),e.stroke(),e.closePath(),this.paintText(e))},this.paintBorder=function(e){if(0!=this.borderWidth){e.beginPath(),e.lineWidth=this.borderWidth,e.strokeStyle="rgba("+this.borderColor+","+this.alpha+")";var t=this.borderWidth/2;null==this.borderRadius||0==this.borderRadius?e.rect(this.x-t,this.y-t,this.width+this.borderWidth,this.height+this.borderWidth):e.DGraphRoundRect(this.x-t,this.y-t,this.width+this.borderWidth,this.height+this.borderWidth,this.borderRadius),e.stroke(),e.closePath()}},this.paintText=function(e){var t=this.text;if(null!=t&&""!=t){e.beginPath(),e.font=this.font;var i=e.measureText(t).width,n=e.measureText("田").width;e.fillStyle="rgba("+this.fontColor+", "+this.alpha+")";var s=this.getTextPostion(this.textPosition,i,n);e.fillText(t,s.x,s.y),e.closePath()}},this.getTextPostion=function(e,t,i){var n=null;switch(e){case"Bottom_Center":n={x:this.x+this.width/2-t/2,y:this.y+this.height+i};break;case"Top_Center":n={x:this.x+this.width/2-t/2,y:this.y-i/2};break;case"Top_Right":n={x:this.x+this.width-t,y:this.y-i/2};break;case"Top_Left":n={x:this.x,y:this.y-i/2};break;case"Bottom_Right":n={x:this.x+this.width-t,y:this.y+this.height+i};break;case"Bottom_Left":n={x:this.x,y:this.y+this.height+i};break;case"Middle_Center":n={x:this.x+this.width/2-t/2,y:this.y+this.height/2+i/2};break;case"Middle_Right":n={x:this.x+this.width-t,y:this.y+this.height/2+i/2};break;case"Middle_Left":n={x:this.x,y:this.y+this.height/2+i/2};break;default:n={x:this.x+this.width/2-t/2,y:this.y+this.height+i};break}return n.x+=this.textOffsetX,n.y+=this.textOffsetY,n},this.paintMouseover=function(e){this.paintSelected(e)},this.paintSelected=function(e){e.save(),e.beginPath(),e.strokeStyle="rgba("+this.fillColor+",0.5)",e.lineWidth=8,0==this.borderRadius?e.rect(this.x,this.y,this.width,this.height):e.DGraphRoundRect(this.x,this.y,this.width,this.height,this.borderRadius),e.stroke(),e.closePath(),e.restore()},this.setLayoutType=function(e){switch(e){case"grid":this.layout=new o.layout.GridLayout;break;case"circle":this.layout=new o.layout.CircleLayout;break;default:this.layout=new o.layout.AutoBoxLayout;break}}}t.prototype=new e.InteractiveElement,e.Box=t}(o),function(e){function t(){return function(e,t){var i=t.length;if(i>0){for(var n=0,s=1e7,a=-1e7,o=1e7,r=-1e7,l=a-s,h=r-o,c=0;c<i;c++){var d=t[c];d.x<=s&&(s=d.x),d.x>=a&&(a=d.x),d.y<=o&&(o=d.y),d.y>=r&&(r=d.y),l=a-s+d.width,h=r-o+d.height}e.x=s-n,e.y=o-n,e.width=l+n+2*n,e.height=h+2*n}}}function i(){return function(t,i){for(var n=i.length,s=0,a=0,o=0,r=0;r<n;r++){var l=i[r];s+=1.5*l.radius}a=s/Math.PI,o=2*Math.PI/s;var h=a/2,c=0,d=t.x+t.width/2,u=t.y+t.height/2;for(r=0;r<n;r++){l=i[r];noderadius=l.radius;var f=o*noderadius;c+=1.5*noderadius*o,l.x=h*Math.cos(c+f+Math.PI/2)+d,l.y=h*Math.sin(c+f+Math.PI/2)+u}t.layout=new e.layout.AutoBoxLayout}}function n(){return function(t,i){var n=i.length,s=Math.round(Math.sqrt(n))+1,a=Math.round(Math.sqrt(n))+1;i=i.sort((function(e,t){var i=(e.inLinks||[]).length+(e.outLinks||[]).length,n=(t.inLinks||[]).length+(t.outLinks||[]).length;return i>n?-1:1}));for(var o=verticalScale=2*i[0].width,r=0,l=0;l<s;l++)for(var h=0;h<a;h++)if(!(r>=n)){var c=i[r];c.x=h*o+t.x,c.y=l*verticalScale+t.y,r++}t.layout=new e.layout.AutoBoxLayout}}e.layout=e.Layout={AutoBoxLayout:t,CircleLayout:i,GridLayout:n}}(o),function(e){function t(){t.prototype.init.apply(this,[].slice.call(arguments))}function i(){var e=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i;function t(e,t,n){e=s(e),t=s(t),e=r(e),t=r(t);for(var a=[],o=(t[0]-e[0])/n,l=(t[1]-e[1])/n,c=(t[2]-e[2])/n,d=0,u=e[0],f=e[1],p=e[2];d<n;d++)a[d]=i([h(Math.floor(u),[0,255]),h(Math.floor(f),[0,255]),h(Math.floor(p),[0,255])]),u+=o,f+=l,p+=c;return u=t[0],f=t[1],p=t[2],a[d]=i([u,f,p]),a}function i(e,t){if(t=t||"rgb",e&&(3===e.length||4===e.length)){if(e=l(e,(function(e){return e>1?Math.ceil(e):e})),t.indexOf("hex")>-1)return e=l(e.slice(0,3),(function(e){return e=Number(e).toString(16),1===e.length?"0"+e:e})),"#"+e.join("");if(t.indexOf("hs")>-1){var i=l(e.slice(1,3),(function(e){return e+"%"}));e[1]=i[0],e[2]=i[1]}return t.indexOf("a")>-1?(3===e.length&&e.push(1),e[3]=h(e[3],[0,1]),t+"("+e.slice(0,4).join(",")+")"):t+"("+e.slice(0,3).join(",")+")"}}function n(e,t){var n=r(e),s=n[3];return"undefined"===typeof s&&(s=1),n[3]=s,i(n,t)}function s(e){return n(e,"rgba")}function a(e){return e=String(e),e=e.replace(/(^\s*)|(\s*$)/g,""),/^[^#]*?$/i.test(e)&&(e=e.replace(/\s/g,"")),e}function o(e){if(e=a(e),/^#[0-9a-f]{3}$/i.test(e)){var t=e.replace("#","").split("");e="#"+t[0]+t[0]+t[1]+t[1]+t[2]+t[2]}return e}function r(t){t=o(t);var i=t.match(e);if(null!==i){var n,s,a,r=[];if(i[2])n=i[2].replace("#","").split(""),a=[n[0]+n[1],n[2]+n[3],n[4]+n[5]],r=l(a,(function(e){return h(parseInt(e,16),[0,255])}));else if(i[4]){var c=i[4].split(",");s=c[3],a=c.slice(0,3),r=l(a,(function(e){return e=Math.floor(e.indexOf("%")>0?2.55*parseInt(e,0):e),h(e,[0,255])})),"undefined"!==typeof s&&r.push(h(parseFloat(s),[0,1]))}return r}}function l(e,t){if("function"!==typeof t)throw new TypeError;for(var i=e?e.length:0,n=0;n<i;n++)e[n]=t(e[n]);return e}function h(e,t){return e<=t[0]?e=t[0]:e>=t[1]&&(e=t[1]),e}function c(e){for(var t=e,i=t.replace(/(?:(|)|rgb|RGB)*/g,"").replace("(","").replace(")","").split(","),n="#",s=0;s<i.length;s++){var a=Number(i[s]).toString(16);a=a.length<2?"0"+a:a,"0"===a&&(a+=a),n+=a}return n}return{getStepColors:t,colorHex:c}}t.fps=60,t.easing={default:"swing",linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-1*e*(e-2)},easeInOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return(e-=1)*e*e+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-1*((e-=1)*e*e*e-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return(e-=1)*e*e*e*e+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return-1*Math.cos(e*(Math.PI/2))+1},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0==e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1==e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0==e||1==e?e:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},easeInCirc:function(e){return-1*(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-(e-=1)*e)},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){var t=1.70158,i=0,n=1;if(0==e||1==e)return e;if(i||(i=.3),n<Math.abs(1)){n=1;t=i/4}else t=i/(2*Math.PI)*Math.asin(1/n);return-n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i)},easeOutElastic:function(e){var t=1.70158,i=0,n=1;if(0==e||1==e)return e;if(i||(i=.3),n<Math.abs(1)){n=1;t=i/4}else t=i/(2*Math.PI)*Math.asin(1/n);return n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/i)+1},easeInOutElastic:function(e){var t=1.70158,i=0,n=1;if(0==e)return 0;if(2==(e/=.5))return 1;if(i||(i=.3*1.5),n<Math.abs(1)){n=1;t=i/4}else t=i/(2*Math.PI)*Math.asin(1/n);return e<1?n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i)*-.5:n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i)*.5+1},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:function(e){return 1-t.easing.easeOutBounce(1-e)},easeOutBounce:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:function(e){return e<.5?.5*t.easing.easeInBounce(2*e):.5*t.easing.easeOutBounce(2*e-1)+.5}},t.calc=function(e,t,i){if("object"==a(e)){var n={};for(var s in t)n[s]=e[s]+(t[s]-e[s])*i;return n}return e+(t-e)*i},t.prototype.init=function(){for(var e=[].slice.call(arguments),t=0;t<3&&t<e.length;t++)switch(a(e[t])){case"number":this._d=e[t];break;case"string":this._e=e[t];break;case"function":this._c=e[t];break}return this},t.prototype.run=function(e,i){var n,s=this,o=new Date,r="number"==typeof t.fps?t.fps:60,l="number"==typeof this._d?this._d:1e3,h="string"==typeof this._e&&"function"==typeof t.easing[this._e]?this._e:t.easing["default"],c=t.easing[h];if("function"!=typeof c)throw new TypeError('Animate.easing["'+h+'"] type is a '+a(c)+" not a function");return this._t=n=setInterval((function(){var t=(new Date-o)/l;t>=1?(e.call(s,1,t),s.stop(n,i)):e.call(s,c(t,0,1,1),t)}),parseInt(1e3/r)),n},t.prototype.stop=function(){for(var e,t,i=[].slice.call(arguments),n=0;n<i.length;n++)switch(a(i[n])){case"number":clearInterval(i[n]),e=1;break;case"function":t=i[n];break}return!e&&clearInterval(this._t),t&&t.call(this),"function"==typeof this._c&&this._c(),this},e.Animate=t,e.ColorUtils=i}(o);var r=function(e,t){if(null!=e){this.defaultConfig={node:{label:{show:!0,color:"50,50,50",font:"12px 微软雅黑",wrapText:!1,textPosition:"Middle_Center",textOffsetX:0,textOffsetY:0,backgroud:null,borderWidth:0,borderColor:null},shape:"circle",color:"20,20,200",borderColor:"10,10,10",borderWidth:0,borderRadius:0,lineDash:[3,2],alpha:1,size:60,width:100,height:40,image:null,selected:{borderColor:"120,0,250",borderAlpha:1,borderWidth:5,showShadow:!1,shadowColor:"10,240,10"},onClick:function(e,t){},ondblClick:function(e,t){},onMouseDown:function(e,t){},onMouseOver:function(e,t){},onMouseOut:function(e,t){},onMousedrag:function(e,t){}},link:{label:{show:!0,color:"20,20,20",font:"11px 微软雅黑"},lineType:"direct",colorType:"source",color:"10,10,10",alpha:1,lineWidth:3,lineDash:[0],showArrow:!0,selected:{color:"255,0,0",alpha:1,lineWidth:8,showShadow:!1,shadowColor:"10,250,10"},onClick:function(e,t){},ondblClick:function(e,t){}},highLightNeiber:!0,wheelZoom:1,noElementClick:function(e){}},this.stage=new o.Stage(e),this.canvas=this.stage.canvas,this.scene=null,this.nodes=[],this.links=[],this.nodeIdIndex=1,this.currentNode=null,this.currentLink=null,this.showLinkFlag=!0,this.typeMapStyle={},this.lineTypeMapStyle={},this.isDerictedGraph=!0,this.clusterBoxes=[],this.currentCluster=null,this.currentLayout=null,this.drawLinkFlag=!1,this.virNode=null,this.sceneEvent=null,this.autoLayout=!1;var i=this;this.forceOptions={size:[i.canvas.width,i.canvas.height],friction:.9,linkDistance:150,linkStrength:.05,charge:-150,gravity:.01,noverlap:!1,alpha:.5,theta:.8,loopName:null},t?(this.config=this.deepExtend(this.defaultConfig,t,!0,!0),this.config.layout&&"force"==this.config.layout["type"]&&this.config.layout["options"]&&(this.autoLayout=!0,this.forceOptions.friction=Number(i.config.layout.options["friction"])||.9,this.forceOptions.linkDistance=Number(i.config.layout.options["linkDistance"])||150,this.forceOptions.linkStrength=Number(i.config.layout.options["linkStrength"])||.05,this.forceOptions.charge=Number(i.config.layout.options["charge"])||-150,this.forceOptions.gravity=Number(i.config.layout.options["gravity"])||.01,this.forceOptions.noverlap=i.config.layout.options["noverlap"]||!1)):this.config=this.defaultConfig,this.defaultNodeColor=this.config.node.color,this.highLightNeiber=this.config.highLightNeiber,this.init()}};r.prototype.init=function(){var e=this;this.stage.wheelZoom=this.config.wheelZoom,null!=e.scene&&(e.scene.clear(),e.stage.remove(e.scene)),e.scene=new o.Scene(this.stage),e.nodes=[],e.links=[],e.typeMapStyle={},e.lineTypeMapStyle={},e.initDrawLinkBase()},r.prototype.initDrawLinkBase=function(){var e=this,t=new o.Node;t.radius=1,t.show=!1,t.dragable=!1,t.fillColor="10,10,10",t.alpha=.1,t.showSelected=!1,e.virNode=t,e.scene.mousemove((function(t){if(e.drawLinkFlag){if(e.virNode.show||(e.virNode.show=!0,e.scene.add(e.virNode)),null==e.virLink){var i=new o.Edge(e.currentNode,e.virNode);i.lineWidth=2,i.alpha=.8,i.strokeColor="50,250,50",i.lineDash=[5,8],i.showSelected=!1,e.virLink=i,e.scene.add(e.virLink)}var n=o.util.mouseCoords(t);e.virNode.x=n.x,e.virNode.y=n.y}})),e.scene.dbclick((function(t){e.drawLinkFlag=!1,e.virNode.show&&(e.virNode.show=!1,e.scene.remove(e.virNode)),e.virLink&&(e.scene.remove(e.virLink),e.virLink=null)})),e.scene.click((function(t){if(e.hideAllRightMenu(),null==t.target){e.currentNode=null,e.currentLink=null,e.highLightNeiber&&e.restoreHightLight();var i=e.config["noElementClick"];i(t)}else"node"==t.target.elementType?e.currentLink=null:e.currentNode=null}))},r.prototype.deepExtend=function(e,t,i,n){for(var s in t)if(t.hasOwnProperty(s)||!0===i)if(t[s]&&t[s].constructor===Object)void 0===e[s]&&(e[s]={}),e[s].constructor===Object?this.deepExtend(e[s],t[s],i):null===t[s]&&void 0!==e[s]&&!0===n?delete e[s]:e[s]=t[s];else if(Array.isArray(t[s])){e[s]=[];for(var a=0;a<t[s].length;a++)e[s].push(t[s][a])}else null===t[s]&&void 0!==e[s]&&!0===n?delete e[s]:e[s]=t[s];return e},r.prototype.hideAllRightMenu=function(){var e=this;e.config.hasOwnProperty("rightMenu")&&(e.config.rightMenu.hasOwnProperty("nodeMenu")&&e.config["rightMenu"]["nodeMenu"].hide(),e.config.rightMenu.hasOwnProperty("linkMenu")&&e.config["rightMenu"]["linkMenu"].hide(),e.config.rightMenu.hasOwnProperty("clusterMenu")&&e.config["rightMenu"]["clusterMenu"].hide())},r.prototype.drawData=function(e){var t=this;if(null!=e){this.init();var i={};(e.nodes||[]).forEach((function(e,n){var s=t.newNode(e,n);s.showlabel=t.config.node.label.show,t.scene.add(s),t.nodes.push(s),i[e.id]=s})),(e.links||[]).forEach((function(e){var n=e.source,s=e.target,a=i[n];if(void 0==a||null==a){var o={id:n};a=t.newNode(o,0);a.visible=!0,t.scene.add(a),t.nodes.push(a),i[o.id]=a}var r=i[s];if(void 0==r||null==r){o={id:s};r=t.newNode(o,0),r.visible=!0,t.scene.add(r),t.nodes.push(r),i[o.id]=r}if(a&&r){var l=t.newEdge(a,r);l.id=e.id||"",l.showlabel=e.showlabel||t.config.link.label.show,l.fontColor=e.fontColor||t.config.link.label.color,l.font=e.font||t.config.link.label.font,l.colorType=e.colorType||t.config.link.colorType,l.strokeColor=e.color||t.config.link.color,l.lineType=e.lineType||t.config.link.lineType,l.type=e.type||"",l.label=e.label||e.type||"",l.weight=e.weight||1,l.lineWidth=e.lineWidth||t.config.link.lineWidth,l.properties=e.properties||{},t.scene.add(l),t.links.push(l),t.setLineTypeMap(l)}})),t.scene.translateToCenter(),t.refresh(),t.autoLayout&&t.runLayoutEngin(.9)}},r.prototype.translateToCenter=function(){this.scene.translateToCenter(),this.refresh()},r.prototype.getColor=function(e){var t=e.color;return t=t?t.replace("rgb(","").replace(")",""):this.defaultNodeColor,t},r.prototype.newNode=function(e){var t=this,i=this.stage.canvas.width||500,n=this.stage.canvas.height||300,s=new o.Node;return s.x=e.x||Math.round(Math.random()*i),s.y=e.y||Math.round(Math.random()*n),s.id=e.id,s.type=e.type||"default",s.cluster=e.cluster||"default",s.radius=Number(e.size)||t.config.node.size,s.width=e.width||t.config.node.width,s.height=e.height||t.config.node.height,s.label=e.label||e.id,s.alpha=e.alpha||t.config.node.alpha,s.fillColor=t.getColor(e),s.fontColor=e.fontColor||t.config.node.label.color,s.textPosition=e.textPosition||t.config.node.label.textPosition,s.font=e.font||t.config.node.label.font,s.borderWidth=e.borderWidth||t.config.node.borderWidth,s.borderRadius=e.borderRadius||t.config.node.borderRadius,s.borderColor=e.borderColor||t.config.node.borderColor,s.scaleX=s.scaleY=e.scale||1,s.shape=e.shape||t.config.node.shape,s.showlabel=e.showlabel||t.config.node.label.show,s.wrapText=t.config.node.label.wrapText,s.showShadow=e.showShadow||t.config.node.selected.showShadow,s.shadowColor=e.shadowColor||t.config.node.selected.shadowColor,s.selectedBorderColor=e.selectedBorderColor||t.config.node.selected.borderColor,s.selectedBorderAlpha=e.selectedBorderAlpha||t.config.node.selected.borderAlpha,s.selectedBorderWidth=e.selectedBorderWidth||t.config.node.selected.borderWidth,s.lineDash=e.lineDash||t.config.node.lineDash,s.labelBackGround=e.labelBackGround||t.config.node.label.backgroud,s.labelBorderWidth=e.labelBorderWidth||t.config.node.label.borderWidth,s.labelBorderColor=e.labelBorderColor||t.config.node.label.borderColor,s.textOffsetX=e.textOffsetX||t.config.node.label.textOffsetX,s.textOffsetY=e.textOffsetY||t.config.node.label.textOffsetY,s.icon=e.icon,s.weight=1,s.px=s.x,s.py=s.y,s.charge=t.forceOptions.charge,e.image&&e.image.length>0?s.setImage(e.image):s.setImage(t.config.node.image||""),s.properties=e.properties||{},t.setTypeMapWithNode(s),s.click((function(e){if(t.drawLinkFlag&&null!=t.virLink){var i=!0;if(t.config.link.hasOwnProperty("beforebegainAddLine")){var n=t.config.link["beforebegainAddLine"];i=n(t.virLink.source,this)}if(i){var s=t.newEdge(t.virLink.source,this);if(s.label=t.config.link.label.defaultLabel,s.showlabel=t.config.link.label.show,t.links.push(s),t.scene.add(s),t.virNode.show&&(t.virNode.show=!1,t.scene.remove(t.virNode)),t.drawLinkFlag=!1,t.virLink&&(t.scene.remove(t.virLink),t.virLink=null),t.config.link.hasOwnProperty("afterbegainAddLine")){var a=t.config.link["afterbegainAddLine"];a(s)}}}if(t.currentNode=this,this.fixed=!0,this.dx=this.x,this.dy=this.y,t.highLightNeiber&&(t.restoreHightLight(),t.highLightNeiberNodes(this,.1)),t.config.node.hasOwnProperty("onClick")){var o=t.config.node["onClick"];o(e,this)}})),s.dbclick((function(e){if(t.config.node.hasOwnProperty("ondblClick")){var i=t.config.node["ondblClick"];i(event,this)}this.fixed=!this.fixed})),s.mousedrag((function(e){if(this.isDragging||t.scene.selectedElements.length>1)return!1;if(this.isDragging=!0,this.fixed=!0,t.autoLayout&&t.runLayoutEngin(.5),t.config.node.hasOwnProperty("onMousedrag")){var i=t.config.node["onMousedrag"];i(event,this)}})),s.mouseup((function(e){if(t.currentNode=this,this.fixed=!0,this.isDragging=!1,this.dx=this.cx,this.dy=this.cy,2==e.button&&t.showNodeRightMenu(e,this),t.config.node.hasOwnProperty("onMouseUp")){var i=t.config.node["onMouseUp"];i(event,this)}})),s.mousedown((function(e){if(t.config.node.hasOwnProperty("onMouseDown")){var i=t.config.node["onMouseDown"];i(event,this)}})),s.mouseover((function(e){if(t.config.node.hasOwnProperty("onMouseOver")){var i=t.config.node["onMouseOver"];i(event,this)}})),s.mouseout((function(e){if(t.config.node.hasOwnProperty("onMouseOut")){var i=t.config.node["onMouseOut"];i(event,this)}})),s},r.prototype.refresh=function(){this.stage.paint(),this.stage.thumbnail.visible&&this.stage.thumbnail.update()},r.prototype.highLightNeiberNodes=function(e,t){var i=this;i.nodes.map((function(e){e.t_alpha=e.alpha,e.alpha=t||.1})),e.alpha=e.t_alpha,(e.inLinks||[]).map((function(e){e.source.visible&&(e.source.alpha=e.source.t_alpha)})),(e.outLinks||[]).map((function(e){e.target.visible&&(e.target.alpha=e.target.t_alpha)})),i.showLinkFlag&&(i.links.map((function(e){e.visible=!1})),(e.inLinks||[]).map((function(e){e.source.visible&&(e.visible=!0)})),(e.outLinks||[]).map((function(e){e.target.visible&&(e.visible=!0)})))},r.prototype.restoreHightLight=function(){var e=this;e.nodes.map((function(e){e.alpha=e.t_alpha||e.alpha})),e.showLinkFlag&&e.links.map((function(e){e.source.visible&&e.target.visible&&(e.visible=!0)}))},r.prototype.lockNode=function(e){e&&null!=e&&(e.fixed=!0,e.dragable=!1)},r.prototype.unLockNode=function(e){e&&null!=e&&(e.fixed=!1,e.dragable=!0)},r.prototype.showNodeRightMenu=function(e,t){var i=this;i.config.hasOwnProperty("rightMenu")&&i.config["rightMenu"].hasOwnProperty("nodeMenu")&&i.config["rightMenu"]["nodeMenu"].show(e,i,t)},r.prototype.showLinkRightMenu=function(e,t){var i=this;i.config.hasOwnProperty("rightMenu")&&i.config["rightMenu"].hasOwnProperty("linkMenu")&&i.config["rightMenu"]["linkMenu"].show(e,i,t)},r.prototype.showClusterRightMenu=function(e,t){var i=this;i.config.hasOwnProperty("rightMenu")&&i.config["rightMenu"].hasOwnProperty("clusterMenu")&&i.config["rightMenu"]["clusterMenu"].show(e,i,t)},r.prototype.setTypeMapWithNode=function(e){var t=this;this.typeMapStyle[e.type+""]={color:t.colorHex(e.fillColor)},this.typeMapStyle[e.type+""]["shape"]=e.shape||"circle"},r.prototype.setLineTypeMap=function(e){var t=this,i=e.type||e.label||"default";this.lineTypeMapStyle[i]={color:t.colorHex(e.strokeColor)},this.lineTypeMapStyle[i]["lineType"]=e.lineType||"direct"},r.prototype.colorHex=function(e){var t=new o.ColorUtils;return t.colorHex(e)||"0,0,250"},r.prototype.newEdge=function(e,t){var i=this,n=new o.Edge(e,t,null);return n.lineWidth=i.config.link.lineWidth,n.alpha=i.config.link.alpha,n.strokeColor=i.config.link.color,n.showArrow=i.config.link.showArrow,n.lineType=i.config.link.lineType,n.lineDash=i.config.link.lineDash,n.fontColor=i.config.link.label.color,n.showShadow=i.config.link.selected.showShadow,n.shadowColor=i.config.link.selected.shadowColor,n.selectedColor=i.config.link.selected.color,n.selectedAlpha=i.config.link.selected.alpha,n.colorType=i.config.link.colorType,n.distance=i.forceOptions.linkDistance,n.strength=i.forceOptions.linkStrength,++e.weight,++t.weight,n.mouseup((function(e){i.currentLink=this,2==e.button&&i.showLinkRightMenu(e,this)})),n.click((function(e){if(i.config.link.hasOwnProperty("onClick")){var t=i.config.link["onClick"];t(e,this)}})),n.dbclick((function(e){if(i.config.link.hasOwnProperty("ondblClick")){var t=i.config.link["ondblClick"];t(e,this)}})),n},r.prototype.addNode=function(e){var t=this,i=t.newNode(e);return i.text=i.label,i.showlabel=!0,t.scene.add(i),t.nodes.push(i),t.refresh(),i},r.prototype.addEdge=function(e){var t=this,i=e.source,n=e.target,s=this.nodes.filter((function(e){return e.id==i}))[0],a=this.nodes.filter((function(e){return e.id==n}))[0],o=null;return s&&a&&(o=t.newEdge(s,a),o.id=e.id||"",o.type=e.type||"default",o.label=e.label||"",o.showlabel=e.showlabel||t.config.link.label.show,o.lineWidth=Number(e.lineWidth)||t.config.link.lineWidth,o.strokeColor=e.color||t.config.link.color,o.weight=Number(e.weight)||1,o.lineType=e.lineType||t.config.link.lineType,o.lineDash=e.lineDash||t.config.link.lineDash,o.font=e.font||t.config.link.label.font,o.fontColor=e.fontColor||t.config.link.label.color,o.properties=e.properties||{},t.scene.add(o),t.links.push(o),t.refresh()),o},r.prototype.getGraphData=function(){var e=this;return{nodes:e.nodes,links:e.links}},r.prototype.getVisibleData=function(){var e=this,t=e.nodes.filter((function(e){return 1==e.visible})),i=e.links.filter((function(e){var t=e.source,i=e.target;return 1==t.visible&&1==i.visible}));return t.map((function(e){e.fixed=!1})),{nodes:t,links:i}},r.prototype.setZoom=function(e){var t=this;"zoomOut"==e?t.stage.zoomOut():"zoomIn"==e?t.stage.zoomIn():"zoom1"==e?(t.stage.centerAndZoom(),t.scene.scaleX=1,t.scene.scaleY=1):t.stage.centerAndZoom(1,1),t.refresh()},r.prototype.animate=function(e,t,i,n,s){var a=this;a.stage.fps=100;var r=new o.Animate(t||1e3,i||"swing");r.run((function(t){var i={};for(var s in e)i[s]=o.Animate.calc(e[s].from,e[s].to,t);n&&"function"===typeof n&&n(i)}),(function(){s&&"function"===typeof s&&s(),a.stage.fps=-100}))},r.prototype.moveCenter=function(){this.scene.scaleX=1,this.scene.scaleY=1,this.scene.translateToCenter(),this.refresh()},r.prototype.moveNodeToCenter=function(e,t){var i=this;t&&Number(t)>0?i.animate({x:{from:i.scene.translateX,to:-e.x+i.stage.canvas.width/2},y:{from:i.scene.translateY,to:-e.y+i.stage.canvas.height/2}},t,"linear",(function(e){i.scene.translateX=e.x,i.scene.translateY=e.y})):(i.scene.setCenter(e.x,e.y),i.refresh())},r.prototype.setLineType=function(e){this.links.forEach((function(t){t.lineType=e})),this.refresh()},r.prototype.setNodeShape=function(e){this.nodes.forEach((function(t){t.shape=e})),this.refresh()},r.prototype.showNodeLabel=function(e){this.nodes.map((function(t){t.showlabel=e,t.text=e?t.label:null})),this.refresh()},r.prototype.showLinkLabel=function(e){this.links.forEach((function(t){t.showlabel=e,e?(t.text=t.label,t.font="14px 微软雅黑",t.fontColor=t.strokeColor):t.text=null})),this.refresh()},r.prototype.setMouseModel=function(e){this.stage.mode="drag"==e?"drag":"select"==e?"select":"normal"},r.prototype.contract=function(e){var t=this;if(e){var i=[];(e.outLinks||[]).map((function(e){0==(e.target.outLinks||[]).length&&1==(e.target.inLinks||[]).length&&(i.push(e.target),e.visible=!1)})),e.tipText=i.length,i.map((function(t){t.x=e.x,t.y=e.y,t.visible=!1})),t.refresh()}},r.prototype.expanded=function(e){var t=this;if(e){var i=[];if((e.outLinks||[]).map((function(e){var t=e.target;0==(t.outLinks||[]).length&&0==t.visible&&(e.visible=!0,t.visible=!0,i.push(t))})),0==i.length)return;t.runLayoutEngin(.1),e.tipText=null}},r.prototype.saveImage=function(e,t,i){this.stage.saveAsLocalImage(e,t,i)},r.prototype.exportJsonFile=function(){var e=JSON.stringify(this.serialized());function t(e,t){var i=document.createElement("a");i.download=t,i.style.display="none";var n=new Blob([e]);i.href=URL.createObjectURL(n),document.body.appendChild(i),i.click(),document.body.removeChild(i)}t(e,"graphvis.json")},r.prototype.showOverView=function(e){this.stage.thumbnail.visible=e,this.refresh()},r.prototype.switchOverView=function(){this.stage.thumbnail.visible=!this.stage.thumbnail.visible,this.refresh()},r.prototype.findNode=function(e){var t=this.nodes.filter((function(t){if(null==t.label)return!1;var i=t.label+"";return i==e}));if(t.length>0){var i=t[0];return i.selected=!0,i.showlabel=!0,this.currentNode=i,this.focusTargetEle(i),i}return null},r.prototype.focusTargetEle=function(e,t,i){e.selected=!0,t||(t={}),t.x||0==t.x||(t.x=this.stage.canvas.width/2),t.y||0==t.y||(t.y=this.stage.canvas.height/2);var n=this;n.animate({x:{from:n.scene.translateX,to:-e.x+t.x},y:{from:n.scene.translateY,to:-e.y+t.y}},1e3,"swing",(function(e){n.scene.translateX=e.x,n.scene.translateY=e.y}),(function(){i&&"function"===typeof i&&i()}))},r.prototype.converHexToRGB=function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(function(e,t,i,n){return t+t+i+i+n+n}));var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16):null},r.prototype.setLabelColor=function(e){var t=this.converHexToRGB(e);this.config.node.label.color=t,this.nodes.forEach((function(e){e.fontColor=t})),this.refresh()},r.prototype.hideAllLink=function(){this.showLinkFlag=!1,this.links.forEach((function(e){e.visible=!1})),this.refresh()},r.prototype.showAllLink=function(){this.showLinkFlag=!0,this.links.forEach((function(e){e.source.visible&&e.target.visible&&(e.visible=!0)})),this.refresh()},r.prototype.showAllNode=function(){this.nodes.forEach((function(e){e.alpha=1,e.visible=!0})),this.refresh()},r.prototype.setNodeFont=function(e){var t=this;t.nodes.forEach((function(t){t.font="noraml "+e+"px Consolas"})),t.refresh()},r.prototype.setTextPosition=function(e){var t=this;t.nodes.forEach((function(t){t.textPosition=e})),t.refresh()},r.prototype.setLinkAlpha=function(e){this.links.forEach((function(t){t.alpha=e})),this.refresh()},r.prototype.setLinkArrowShow=function(e){this.links.forEach((function(t){t.showArrow=e})),this.refresh()},r.prototype.setLinkColor=function(e){var t=this.converHexToRGB(e);this.links.forEach((function(e){e.colorType="defined",e.strokeColor=t})),this.refresh()},r.prototype.setLinkColorType=function(e){var t=e||"source";this.links.forEach((function(e){e.colorType=t,"defined"==t&&(e.strokeColor=self.config.link.color||"50,50,50")})),this.refresh()},r.prototype.setLinkFont=function(e){var t=this;t.links.forEach((function(t){t.font="noraml "+e+"px 微软雅黑",t.textOffsetX=-Number(e)})),this.refresh()},r.prototype.setLinkLabelColor=function(e){var t=this,i=this.converHexToRGB(e);t.links.forEach((function(e){e.fontColor=i})),this.refresh()},r.prototype.resetNodeInfo=function(e){var t=this.currentNode;t&&(t.label=this.currentNode.text=e.name,t.radius=Number(e.radius)||20,t.width=Number(e.width)||100,t.height=Number(e.height)||50,t.scaleX=t.scaleY=Number(e.scale)||1,t.fillColor=this.converHexToRGB(e.fillColor),t.shape=e.shape,t.showlabel="true"==e.showlabel,t.imageUrl=e.image,t.setImage(e.image),this.refresh())},r.prototype.resetEdgeStyle=function(e){var t=this,i=t.currentLink;if(i){i.label=e["label"],i.text=i.label,i.type=i.label,i.lineWidth=e["lineWidth"],i.lineType=e["lineType"],e["lineDash"]&&(i.lineDash=e["lineDash"].split(","));var n=e["edgeColor"];n&&n.length>0&&"#1f6ce9"!=n&&(i.strokeColor=t.converHexToRGB(n),i.fontColor=i.strokeColor,i.colorType="defined"),i.showlabel=!0,this.refresh()}},r.prototype.addClusterContainer=function(e,t){var i=this;if(null!=e){for(var n in void 0!=t&&null!=t||(t=!1),i.clusterBoxes.forEach((function(e){i.scene.remove(e)})),i.clusterBoxes=[],e){var s=e[n],a=i.nodes.filter((function(e){return e.cluster==n})),r=(s.size,s.rate,s.color);if(a.length>1){var l=new o.Box;l.borderRadius=2,l.fillColor=r,l.alpha=.1,l.dbclick((function(e){var t=Math.round(3*Math.random());this.layout=1==t?new o.layout.GridLayout:2==t?new o.layout.CircleLayout:new o.layout.AutoBoxLayout,i.refresh()})),l.mouseup((function(e){2==e.button&&(i.currentCluster=this,i.showClusterRightMenu(e,this))})),i.scene.add(l),i.clusterBoxes.push(l),a.forEach((function(e){l.add(e)})),this.refresh()}}t||(i.clusterAvoidOverlap(i.clusterBoxes),this.refresh())}},r.prototype.removeCluster=function(){var e=this;e.clusterBoxes=e.clusterBoxes.filter((function(t){return t!=e.currentCluster})),e.scene.remove(e.currentCluster),this.refresh()},r.prototype.clearClusters=function(){var e=this;e.clusterBoxes.forEach((function(t){e.scene.remove(t)})),e.clusterBoxes=[],this.refresh()},r.prototype.setClusterLayout=function(e){var t=this;null!=t.currentCluster&&null!=e&&(t.currentCluster.layout="grid"==e?new o.layout.GridLayout:"circle"==e?new o.layout.CircleLayout:new o.layout.AutoBoxLayout,this.refresh())},r.prototype.clusterAvoidOverlap=function(e){var t=[];if(e.forEach((function(e,i){e.layout(e,e.childs);var n=Math.sqrt(e.width/2*(e.width/2)+e.height/2*(e.height/2)),s=new o.Node;s.radius=n,s.x=e.cx,s.y=e.cy,t[i]=s})),"undefined"!=typeof LayoutFactory){var i=new LayoutFactory({nodes:t,links:null}).createLayout("noverlap");if(null!=i){i.initAlgo(),i.resetConfig({maxMove:1});var n=0,s=!0;while(n++<300&&s)i.runLayout(),s=i.runFlag}}t.forEach((function(t,i){var n=e[i],s=t.x-n.cx,a=t.y-n.cy;n.childs.forEach((function(e){e.x+=s,e.y+=a}))}))},r.prototype.applyNodeSize=function(e){var t=this,i=0,n=0;t.nodes.forEach((function(e){var t=(e.outLinks||[]).length+(e.inLinks||[]).length;e.degree=t,i=Math.min(t,i),n=Math.max(t,n)}));var s=[Math.sqrt(i),Math.sqrt(n)];t.nodes.forEach((function(i){var n=t.numScale(e,s,Math.sqrt(i.degree));i.scaleX=n,i.scaleY=n})),this.refresh()},r.prototype.applyLinkWeight=function(e){var t=this,i=3,n=8;t.links.forEach((function(e){i=Math.min(e.weight,i),n=Math.max(e.weight,n)}));var s=[Math.sqrt(i),Math.sqrt(n)];t.links.forEach((function(i){var n=t.numScale(e,s,Math.sqrt(i.weight));i.lineWidth=Math.round(n)})),this.refresh()},r.prototype.numScale=function(e,t,i){return((i-t[0])*(e[1]-e[0])/(t[1]-t[0])+e[0]).toFixed(1)},r.prototype.selectAll=function(){var e=this;this.nodes.forEach((function(t){t.selected=!0,e.scene.addToSelected(t)})),this.refresh()},r.prototype.reverseSelect=function(){var e=this;this.nodes.forEach((function(t){t.selected?(t.selected=!1,e.scene.removeFromSelected(t)):(t.selected=!0,e.scene.addToSelected(t))})),this.refresh()},r.prototype.selectRelate=function(e){var t=this,i=e||t.currentNode;if(null==i)return!1;var n=i.inLinks||[],s=i.outLinks||[];n.forEach((function(e){e.source.selected=!0,t.scene.addToSelected(e.source)})),s.forEach((function(e){e.target.selected=!0,t.scene.addToSelected(e.target)})),this.refresh()},r.prototype.showSelected=function(){this.nodes.forEach((function(e){if(!e.selected){e.visible=!1;var t=e.inLinks||[],i=e.outLinks||[];t.forEach((function(e){e.visible=!1})),i.forEach((function(e){e.visible=!1}))}})),this.refresh()},r.prototype.setScale=function(e,t){e&&(e.scaleX=t,e.scaleY=t,this.refresh())},r.prototype.hideSelected=function(){this.nodes.forEach((function(e){if(e.selected){e.visible=!1;var t=e.inLinks||[],i=e.outLinks||[];t.forEach((function(e){e.visible=!1})),i.forEach((function(e){e.visible=!1}))}})),this.refresh()},r.prototype.hideIsolatedNodes=function(){this.nodes.forEach((function(e){0==(e.inLinks||[]).length&&0==(e.outLinks||[]).length&&(e.visible=!1)})),this.refresh()},r.prototype.showNodes=function(){this.nodes.forEach((function(e){e.visible=!0,e.alpha=1})),this.refresh()},r.prototype.deleteNode=function(e){var t=this;if(e){var i=[],n=t.nodes.indexOf(e);n>-1&&((e.inLinks||[]).forEach((function(e){i.push(e)})),(e.outLinks||[]).forEach((function(e){i.push(e)})),t.nodes.splice(n,1),t.scene.remove(e)),i.forEach((function(e){n=t.links.indexOf(e),n>-1&&(t.links.splice(n,1),t.scene.remove(e))})),e=null,this.refresh()}},r.prototype.deleteLink=function(e){var t=this;if(e){var i=t.links.indexOf(e);i>-1&&(t.links.splice(i,1),t.scene.remove(e)),this.refresh()}},r.prototype.setNodeLabelWithDegree=function(e){this.nodes.forEach((function(t){(t.inLinks||[]).length+(t.outLinks||[]).length>=e?t.showlabel=!0:(t.showlabel=!1,t.text=null)})),this.refresh()},r.prototype.translateOrZoom=function(e){var t=this;function i(e){var i=t.nodes.length,n=0,s=0;t.nodes.forEach((function(e){n+=e.x,s+=e.y})),n/=i,s/=i,t.nodes.forEach((function(t){var i=(t.x-n)*e,a=(t.y-s)*e;t.x=n+i,t.y=s+a}))}"zoomOut"===e?i(1.2):"zoomIn"===e?i(.8):this.stage.centerAndZoom(1,1),this.refresh()},r.prototype.rotateGraph=function(e){var t=Math.sin(-e*Math.PI/180),i=Math.cos(-e*Math.PI/180),n=this.stage.getBound(),s=Math.round(n.width/2),a=Math.round(n.height/2);this.nodes.forEach((function(e){var n=e.x-s,o=e.y-a;e.x=s+n*i-o*t,e.y=a+o*i+n*t})),this.refresh()},r.prototype.getGraphStatistic=function(){var e=this;if(0==e.nodes.length)return null;var t=e.calculateDensity(),i=e.calculateAvgDegree(),n=e.calculateAvgWieghtDegree();return{nodesCount:e.nodes.length,linksCount:e.links.length,density:t.toFixed(6),avgDegree:i.toFixed(6),avgWeightDegree:n.toFixed(6)}},r.prototype.calculateDensity=function(){var e=this,t=e.nodes.length,i=e.links.length,n=1;e.isDerictedGraph||(n=2);var s=n*i/(t*t-t);return s},r.prototype.calculateAvgDegree=function(){var e=this,t=e.nodes.length,i=0;e.nodes.forEach((function(e){i+=(e.inLinks||[]).length+(e.outLinks||[]).length}));var n=1;e.isDerictedGraph&&(n=2);var s=i/=n*t;return s},r.prototype.calculateAvgWieghtDegree=function(){var e=this,t=e.nodes.length,i=0;e.nodes.forEach((function(t){if(e.isDerictedGraph)(t.inLinks||[]).forEach((function(e){i+=e.weight})),(t.outLinks||[]).forEach((function(e){i+=e.weight}));else{var n=[];n.push(t.inLinks||[]),n.push(t.outLinks||[]),n.forEach((function(e){var t=1;e.source==e.target&&(t=2),i+=t*e.weight}))}}));var n=1;e.isDerictedGraph&&(n=2);var s=i/=n*t;return s},r.prototype.serialized=function(){var e=this,t={nodes:[],links:[]};return e.nodes.forEach((function(e){t.nodes.push({id:e.id,label:e.label,x:Math.round(e.x),y:Math.round(e.y),size:e.radius,color:e.fillColor})})),e.links.forEach((function(e){t.links.push({source:e.source.id,target:e.target.id,label:e.label||e.type||""})})),t},r.prototype.nodeWrapText=function(e){this.nodes.forEach((function(t){t.wrapText=e})),this.refresh()},r.prototype.nodeMapAlphaByDegree=function(){var e=this,t=0,i=0;e.nodes.forEach((function(e){e.outdegree=(e.outLinks||[]).reduce((function(e,t){return e+(t.weight||1)}),0),e.indegree=(e.inLinks||[]).reduce((function(e,t){return e+(t.weight||1)}),0),e.degree=e.outdegree+e.indegree,t=Math.min(e.degree,t),i=Math.max(e.degree,i)}));var n=[t,i],s=[.2,1];e.nodes.forEach((function(t){var i=e.numScale(s,n,t.degree);t.alpha=i,(t.outLinks||[]).forEach((function(e){e.alpha=i}))})),this.refresh()},r.prototype.nodeMapSizeByDegree=function(e,t){var i=this,n=0,s=0;i.nodes.forEach((function(t){t.outdegree=(t.outLinks||[]).reduce((function(e,t){return e+(t.weight||1)}),0),t.indegree=(t.inLinks||[]).reduce((function(e,t){return e+(t.weight||1)}),0),t.degree=t.outdegree+t.indegree,"degree"==e?(n=Math.min(t.degree,n),s=Math.max(t.degree,s)):"outdegree"==e?(n=Math.min(t.outdegree,n),s=Math.max(t.outdegree,s)):(n=Math.min(t.indegree,n),s=Math.max(t.indegree,s))}));var a=[n,s];i.nodes.forEach((function(n){var s=1;s="degree"==e?i.numScale(t,a,n.degree):"outdegree"==e?i.numScale(t,a,n.outdegree):i.numScale(t,a,n.indegree),n.width=n.radius=Math.round(s)})),this.refresh()},r.prototype.findShortPath=function(e,t){var i=this;if(0!=e.length&&0!=t.length){var n=i.nodes.filter((function(t){return t.label+""==e}))[0],s=i.nodes.filter((function(e){return e.label+""==t}))[0];i.allShortPath(0,n,s),this.refresh()}},r.prototype.allShortPath=function(e,t,i){var n=this,s=[],a=[],o=0,r=0,l=0,h=!0,c=!0,d=!0;function u(e,t,i){var r={},l={},c=[];if(void 0==e.outLinks||null==e.outLinks||0==e.outLinks.length||void 0==t.inLinks||null==t.inLinks||0==t.inLinks.length)return!0;s.push(e),n.scene.addToSelected(e),c.push(e),void 0==r[o]&&(r[o]=[]),void 0==l[o]&&(l[o]=[]),r[o].push(e),l[o].push(void 0);do{o++,u(o)}while(void 0!=r[o]&&void 0!=r[o].length&&r[o].length>0);if(i&&!h&&o>1)for(var d=o-1;d>=1;d--)l[d].forEach((function(e){1==e.target.selected&&(e.source.selected=!0,e.selected=!0,n.scene.addToSelected(e.target),s.push(e.target),a.push(e))}));return h;function u(e){void 0!=r[e-1]&&void 0!=r[e-1].length&&r[e-1].length>0&&r[e-1].forEach((function(o){h&&o.outLinks.forEach((function(o){if(h)return o.target.id==t.id?(i&&(o.target.selected=!0,o.source.selected=!0,o.selected=!0,n.scene.addToSelected(o.target),s.push(o.target),a.push(o)),h=!1,void(r[e]=void 0)):void(-1==c.indexOf(o.target)&&(void 0==r[e]&&(r[e]=[]),void 0==l[e]&&(l[e]=[]),r[e].push(o.target),l[e].push(o),c.push(o.target)))}))}))}}0==e?(u(t,i,!1)||(r=o,o=0,c=h,h=!0),u(i,t,!1)||(l=o,o=0,d=h,h=!0),c&&d||(c&&!d?u(i,t,!0):!c&&d||r<=l?u(t,i,!0):u(i,t,!0))):1==e?u(t,i,!0):2==e&&u(i,t,!0),this.refresh()},r.prototype.pathAnalyze=function(e,t){var i=this;if(0!=(i.nodes||[]).length){var n=i.nodes.filter((function(t){return t.label+""==e}))[0],s=i.nodes.filter((function(e){return e.label+""==t}))[0];i.allPath(0,n,s),this.refresh()}},r.prototype.allPath=function(e,t,i){var n=this,s=[],a=[];if(0==e)o(t,i),o(i,t);else 1==e?o(t,i):2==e&&o(i,t);function o(e,t){var i=[],o=[],r={};if(0==(e.outLinks||[]).length||0==(t.inLinks||[]).length)return!0;s.push(e),n.scene.addToSelected(e),i.push(e);var l=!0;return e.outLinks.forEach((function(e){if(-1==i.indexOf(e.target)){i.push(e.target);var t=d(e.target);void 0!=t?(e.target.selected=t,e.selected=t,-1==o.indexOf(e.target)&&(o.push(e.target),h(e.target)),t&&(l=!1,n.scene.addToSelected(e.target),s.push(e.target),a.push(e))):c(e.target,e)}else-1==o.indexOf(e.target)?c(e.target,e):-1!=o.indexOf(e.target)&&(e.selected=e.target.selected,e.target.selected&&(l=!1,n.scene.addToSelected(e.target),s.push(e.target),a.push(e)))})),l;function h(e){var t=e.id;if(void 0!=r[t]&&r[t].length>0)for(var i=r[t].length,l=0;l<i;l++){var c=r[t][l];c.selected||(c.selected=e.selected,c.selected&&a.push(c)),c.source.selected||(c.source.selected=e.selected,c.source.selected&&(n.scene.addToSelected(c.source),s.push(c.source)),-1==o.indexOf(c.source)&&(o.push(c.source),h(c.source)))}}function c(e,t){void 0==r[e.id]&&(r[e.id]=[]),-1==r[e.id].indexOf(t)&&r[e.id].push(t)}function d(e){if(e.id==t.id)return!0;if(0==(e.outLinks||[]).length)return!1;var r=!1;return e.outLinks.forEach((function(e){if(-1==i.indexOf(e.target)){i.push(e.target);var t=d(e.target);void 0!=t?(e.target.selected=t,e.selected=t,-1==o.indexOf(e.target)&&(o.push(e.target),h(e.target)),t&&(n.scene.addToSelected(e.target),s.push(e.target),a.push(e),r=!0)):(c(e.target,e),r||(r=void 0))}else-1==o.indexOf(e.target)?(c(e.target,e),r||(r=void 0)):-1!=o.indexOf(e.target)&&(e.selected=e.target.selected,e.target.selected&&(r=!0,n.scene.addToSelected(e.target),s.push(e.target),a.push(e)))})),r}}this.refresh()},r.prototype.findNDegreeRelates=function(e){var t=this,i=[];this.nodes.forEach((function(n){var s=(n.inLinks||[]).length+(n.outLinks||[]).length;s>=e&&(n.selected=!0,t.scene.addToSelected(n),i.push(n))})),this.refresh()},r.prototype.nLayerRelates=function(e,t){var i=this,n=i.nodes.filter((function(t){return t.label+""==e}))[0],s=[],a={},o=[];function r(e,n){if(n>1){t==n&&-1==s.indexOf(e)&&s.push(e);var l=t-n,h=e.inLinks||[],c=e.outLinks||[];if(h.forEach((function(e){-1==s.indexOf(e.source)&&(s.push(e.source),void 0==a[l]&&(a[l]=[]),a[l].push(e.source))})),c.forEach((function(e){-1==s.indexOf(e.target)&&(s.push(e.target),void 0==a[l]&&(a[l]=[]),a[l].push(e.target))})),void 0==a[l])return;a[l].forEach((function(e){r(e,n-1)}))}else if(1==n){h=e.inLinks||[],c=e.outLinks||[];h.forEach((function(e){-1==s.indexOf(e.source)&&(e.source.selected=!0,i.scene.addToSelected(e.source),o.push(e.source))})),c.forEach((function(e){-1==s.indexOf(e.target)&&(e.target.selected=!0,i.scene.addToSelected(e.target),o.push(e.target))}))}}null!=n&&(n.selected=!0,i.scene.addToSelected(n),o.push(n),r(n,t),this.refresh())},r.prototype.getLineTypeMap=function(){return this.lineTypeMapStyle},r.prototype.getALLLineTypeCounter=function(){var e=this,t=new Map;return(e.links||[]).forEach((function(e){var i=t.get(e.type);null==i?t.set(e.type,{label:e.label,num:1}):i.num++})),t},r.prototype.renderNodeStyle=function(e){var t=this;this.typeMapStyle=e,this.nodes.forEach((function(i){var n=e[i.type];i.fillColor=t.converHexToRGB(n["color"]),i.shape=n["shape"]})),this.refresh()},r.prototype.removeCurrentLink=function(){this.scene.remove(this.currentLink),this.currentLink=null,this.refresh()},r.prototype.renderLineStyle=function(e){var t=this;this.lineTypeMapStyle=e,this.links.forEach((function(i){var n=e[i.label||"default"];i.colorType=null,i.strokeColor=t.converHexToRGB(n["color"]),i.lineType=n["lineType"]})),this.refresh()},r.prototype.setNodeLabelWithDegree=function(e){this.nodes.forEach((function(t){(t.inLinks||[]).length+(t.outLinks||[]).length>=e?t.showlabel=!0:(t.showlabel=!1,t.text=null)})),this.refresh()},r.prototype.filterNodes=function(e,t,i){this.nodes.forEach((function(n){var s=0;"degree"==e?s=(n.inLinks||[]).length+(n.outLinks||[]).length:"outdegree"==e?s=(n.outLinks||[]).length:"indegree"==e&&(s=(n.inLinks||[]).length),1==t?n.visible=s>i:2==t?n.visible=s==i:3==t&&(n.visible=s<i)})),this.links.forEach((function(e){0==e.source.visible||0==e.target.visible?e.visible=!1:e.visible=!0})),this.refresh()},r.prototype.filterLinks=function(e,t){this.links.forEach((function(i){1==i.source.visible&&1==i.target.visible?1==e?i.weight>t?i.visible=!0:i.visible=!1:2==e?i.weight==t?i.visible=!0:i.visible=!1:3==e&&(i.weight<t?i.visible=!0:i.visible=!1):i.visible=!1})),this.refresh()},r.prototype.getTypeMap=function(){return this.typeMapStyle},r.prototype.nodeMapColorsByDegree=function(e,t){var i=this,n={};i.nodes.forEach((function(t){t.outdegree=(t.outLinks||[]).length,t.indegree=(t.inLinks||[]).length,t.degree=t.outdegree+t.indegree,"degree"==e?n[t.degree+""]=1:"outdegree"==e?n[t.outdegree+""]=1:n[t.indegree+""]=1}));var s=[];for(var a in n)s.push(a);s.sort((function(e,t){return Number(e)>Number(t)?1:-1}));var r=new o.ColorUtils,l=r.getStepColors(t[0],t[1],s.length);i.nodes.forEach((function(t){var i=0;i="degree"==e?s.indexOf(t.degree+""):"outdegree"==e?s.indexOf(t.outdegree+""):s.indexOf(t.indegree+""),t.fillColor=l[i].replace("rgb(","").replace(")","")})),this.refresh()},r.prototype.setLineDirected=function(e){this.links.forEach((function(t){t.showArrow=e})),this.refresh()},r.prototype.setLineDashed=function(e){var t=[0];e&&(t=[8,5]),this.links.forEach((function(e){e.lineDash=t})),this.refresh()},r.prototype.setNodeSize=function(e){e=Number(e)||60,this.config.node.size=e,this.nodes.map((function(t){t.radius=Math.round(e)})),this.refresh()},r.prototype.setNodeColor=function(e){var t=this.converHexToRGB(e);this.defaultNodeColor=t,this.nodes.map((function(e){e.fillColor=t})),this.refresh()},r.prototype.covertSencePoint=function(e){return o.util.mouseCoords(e)},r.prototype.addNodeForDrag=function(e,t){var i=this;i.stage.removeEventListener("mousemove"),i.stage.mousemove((function(n){var s=i.scene.toSceneEvent(n);i.stage.removeEventListener("mousemove"),e.id=null==e.id?i.nodeIdIndex++:e.id,e.x=s.x,e.y=s.y;var a=i.newNode(e);a.fixed=!0,i.nodes.push(a),i.scene.add(a),i.refresh(),t&&"function"===typeof t&&t(a)}))},r.prototype.showAll=function(){this.nodes.map((function(e){e.visible||(e.visible=!0)})),this.links.map((function(e){e.visible||(e.visible=!0)})),this.refresh()},r.prototype.filterChangeVisible=function(e,t,i){var n=this;if(n.showAll(),e.length>0&&n.nodes.map((function(t){t.type&&-1!=e.indexOf(t.type)&&(t.visible=!1)})),t.length>0&&n.links.map((function(e){e.text&&-1!=t.indexOf(e.text)&&(e.visible=!1)})),i["linkCount"]){var s=i["linkCount"][0],a=i["linkCount"][1];n.nodes.forEach((function(e){var t=(e.inLinks||[]).length+(e.outLinks||[]).length;o(s,a,t)||(e.visible=!1)}))}if(i["linkOut"]){s=i["linkOut"][0],a=i["linkOut"][1];n.nodes.forEach((function(e){var t=(e.outLinks||[]).length;o(s,a,t)||(e.visible=!1)}))}if(i["linkIn"]){s=i["linkIn"][0],a=i["linkIn"][1];n.nodes.forEach((function(e){var t=(e.inLinks||[]).length;o(s,a,t)||(e.visible=!1)}))}if(i["linkWeight"]){s=i["linkWeight"][0],a=i["linkWeight"][1];n.links.forEach((function(e){o(s,a,e.weight)||(e.visible=!1)}))}if(i["entityDesc"]){s=i["entityDesc"][0],a=i["entityDesc"][1];n.nodes.forEach((function(e){var t=e.value;1==s?t!=a&&(e.visible=!1):2==s&&-1==t.indexOf(a)&&(e.visible=!1)}))}function o(e,t,i){return 1==e?i>t:2==e?i==t:i<t}n.links.forEach((function(e){e.source.visible&&e.target.visible||(e.visible=!1)})),n.refresh()},r.prototype.delSelect=function(){var e=this;e.nodes.forEach((function(t){t.selected&&e.removeOneNode(t)})),e.refresh()},r.prototype.removeOneNode=function(e){var t=this;if(e){var i=[],n=t.nodes.indexOf(e);n>-1&&((e.inLinks||[]).forEach((function(e){i.push(e)})),(e.outLinks||[]).forEach((function(e){i.push(e)})),t.nodes.splice(n,1),t.scene.remove(e)),i.forEach((function(e){n=t.links.indexOf(e),n>-1&&(t.links.splice(n,1),t.scene.remove(e))})),e=null,t.refresh()}},r.prototype.clearAll=function(){this.scene&&this.scene.clear(),this.nodes=[],this.links=[],this.nodeIdIndex=1,this.currentNode=null,this.currentLink=null,this.typeMapStyle={},this.lineTypeMapStyle={},this.currentLayout=null,this.clusterBoxes=[],this.currentCluster=null,this.drawLinkFlag=!1,this.virLink=null,this.setZoom("zoom1"),this.stopRunningLayout(10),this.refresh()},r.prototype.rightMenuOprate=function(e){var t=this;switch(e){case"allSelect":t.selectAll();break;case"rebackSel":t.reverseSelect();break;case"showAll":t.showAll();break;case"selRelate":t.selectRelate();break;case"showNodes":t.showNodes();break;case"showSelNode":t.showSelected();break;case"hideSelNode":t.hideSelected();break;case"delSelect":t.delSelect();break;case"clearAll":this.clearAll();break;case"hideIsolatedNodes":t.hideIsolatedNodes();break;case"showLinks":t.showAllLink();break;case"hideLinks":t.hideAllLink();break;case"sourcelphaMap":t.nodeMapAlphaByDegree();break;case"saveImage":t.saveImage(5e3,5e3);break;case"deleteNode":t.deleteNode(t.currentNode),t.currentNode=null;break;case"nodeConnent":t.begainAddLine(t.currentNode);break;case"delEdge":t.deleteLink(t.currentLink),t.currentLink=null;break;case"expanded":t.expanded(t.currentNode);break;case"contract":t.contract(t.currentNode);break;case"directedLine":t.setLineDirected(!0);break;case"undirectedLine":t.setLineDirected(!1);break;case"showLineLabel":t.showLinkLabel(!0);break;case"hideLineLabel":t.showLinkLabel(!1);break;case"Rline":t.setLineDashed(!1);break;case"Vline":t.setLineDashed(!0);break;default:break}},r.prototype.begainAddLine=function(e){this.drawLinkFlag=!0},r.prototype.drawVirtualLine=function(e,t){var i=this,n=i.newEdge(e,t);return i.scene.add(n),n},r.prototype.drawVirtualNode=function(e){var t=this,i=t.newNode(e||{x:10,y:10,size:5});return i.dragable=!1,i.fixed=!0,t.scene.add(i),i},r.prototype.removeLine=function(e){this.scene.remove(e),this.refresh()},r.prototype.getMousePosition=function(e){var t=o.util.mouseCoords(e);return{x:t.x,y:t.y}},r.prototype.computeParentAngle=function(e){var t,i=0,n=100,s=[],a=!0;if((e.inLinks||[]).forEach((function(e){s.push(e.source)})),0==s.length&&(a=!1,(e.outLinks||[]).forEach((function(e){s.push(e.target)}))),t=s.sort((function(e,t){return a?(e.outLinks||[]).length+(e.inLinks||[]).length<(t.outLinks||[]).length+(t.inLinks||[]).length:(e.outLinks||[]).length+(e.inLinks||[]).length>(t.outLinks||[]).length+(t.inLinks||[]).length}))[0],t){var o=t.x,r=t.y,l=e.x,h=e.y,c=Math.sqrt(Math.pow(o-l,2)+Math.pow(r-h,2)),d=n/(c-n),u=(l+d*o)/(1+d),f=(u-l)/n;f<-1&&(f=-1),f>1&&(f=1),i=Math.acos(f),r>h&&(i=2*Math.PI-i)}return i},r.prototype.activeAddNodeLinks=function(e,t){var i=this,n=i.canvas.width/2||500,s=i.canvas.height/2||300;null!=i.currentNode&&(n=i.currentNode.cx,s=i.currentNode.cy);var a,o,r=[],l=[],h=Math.PI*(3-Math.sqrt(5));(e||[]).forEach((function(e,t){a=5*Math.sqrt(t),o=t*h,e.x=e.x||n+a*Math.cos(o),e.y=e.y||s+a*Math.sin(o);var l=i.nodes.filter((function(t){return t.id==e.id}));if(0==l.length)if(null!=i.currentNode)if(e.id!=i.currentNode.id){var c=i.newNode(e);i.nodes.push(c),i.scene.add(c),r.push(c)}else i.currentNode.id=e.id;else{c=i.newNode(e);i.nodes.push(c),i.scene.add(c),r.push(c)}}));var c=i.nodes;(t||[]).forEach((function(e){var t=i.links.filter((function(t){return t.source.id==e.source&&t.target.id==e.target}));if(0==t.length){var n=c.filter((function(t){return t.id==e.source}))[0],s=c.filter((function(t){return t.id==e.target}))[0];if(null!=n&&null!=s){var a=i.newEdge(n,s);a.id=e.id||"",a.type=e.type||"default",a.label=e.label||"",a.showlabel=e.showlabel||i.config.link.label.show,a.lineWidth=Number(e.lineWidth)||i.config.link.lineWidth,a.weight=Number(e.weight)||1,a.lineType=e.lineType||i.config.link.lineType,a.lineDash=e.lineDash||i.config.link.lineDash,a.strokeColor=e.color||i.config.link.color,a.font=e.font||i.config.link.label.font,a.fontColor=e.fontColor||i.config.link.label.color,a.properties=e.properties||{},i.links.push(a),i.scene.add(a),l.push(a)}}}));var d=i.nodes.filter((function(e){return!e.hasOwnProperty("charge")}));d.forEach((function(e){r.push(e)})),null!=i.currentNode&&r.push(i.currentNode),r.length>1&&(null!=i.currentNode&&((i.currentNode.inLinks||[]).forEach((function(e){var t=r.filter((function(t){return t==e.source}));null!=t&&0!=t.length||(e.source.fixed=!0)})),i.currentNode.fixed=!0),i.runLayoutEngin(.5))},r.prototype.stopRunningLayout=function(e){var t=this;setTimeout((function(){cancelAnimationFrame(t.forceOptions.loopName),t.forceOptions.loopName=null,t.forceOptions.alpha=0}),e)},r.prototype.loopRunLayout=function(e){var t=this;if("function"==typeof e){var i=function i(){cancelAnimationFrame(t.forceOptions.loopName),e(),t.refresh(),t.forceOptions.loopName=requestAnimationFrame(i)};cancelAnimationFrame(t.forceOptions.loopName),t.forceOptions.loopName=null,t.forceOptions.loopName=requestAnimationFrame(i)}},r.prototype.initLayoutParams=function(e,t){var i=this;i.nodes.forEach((function(e,t){e.weight=null==e.weight?1:e.weight,e.px=e.x,e.py=e.y,e.charge=e.charge||i.forceOptions.charge})),i.links.forEach((function(e,t){var n=e.source,s=e.target;e.distance=e.distance||i.forceOptions.linkDistance,e.strength=e.strength||i.forceOptions.linkStrength,++n.weight,++s.weight}))},r.prototype.runLayoutEngin=function(e){var t=this;function i(){if((t.forceOptions.alpha*=.99)<.001)return t.stopRunningLayout(10),void(t.forceOptions.alpha=0);var e,i,a,o,r,l,h,c,d;t.links.forEach((function(e,i){o=e.source,r=e.target,c=r.x-o.x,d=r.y-o.y,(l=c*c+d*d)&&(l=t.forceOptions.alpha*e.strength*((l=Math.sqrt(l))-e.distance)/l,c*=l,d*=l,r.x-=c*(h=o.weight/(r.weight+o.weight)),r.y-=d*h,o.x+=c*(h=1-h),o.y+=d*h)}));var u=t.nodes.length;if((h=t.forceOptions.alpha*t.forceOptions.gravity)&&(c=t.forceOptions.size[0]/2,d=t.forceOptions.size[1]/2,i=-1,h))while(++i<u)a=t.nodes[i],a.x+=(c-a.x)*h,a.y+=(d-a.y)*h;if(t.forceOptions.charge){n(e=s(t.nodes),t.forceOptions.alpha),i=-1;while(++i<u)(a=t.nodes[i]).fixed||e.visit(f(a))}i=-1;while(++i<u)a=t.nodes[i],a.fixed?a.isDragging?(a.px=a.x,a.py=a.y):(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*t.forceOptions.friction,a.y-=(a.py-(a.py=a.y))*t.forceOptions.friction,1==t.forceOptions.noverlap&&e.visit(p(a)));function f(e){return function(i,n,s,a,o){if(i.point!==e){var r=i.cx-e.x,l=i.cy-e.y,h=1/Math.sqrt(r*r+l*l);if((a-n)*h<t.forceOptions.theta){var c=i.charge*h*h;return e.px-=r*c,e.py-=l*c,!0}if(i.point&&isFinite(h)){c=i.pointCharge*h*h;e.px-=r*c,e.py-=l*c}}return!i.charge}}function p(e){var t=e.radius*e.scaleX+1,i=e.x-t,n=e.x+t,s=e.y-t,a=e.y+t;return function(t,o,r,l,h){if(t.point&&t.point!==e){var c=e.x-t.point.x,d=e.y-t.point.y,u=Math.sqrt(c*c+d*d),f=e.radius*e.scaleX+t.point.radius;u<f&&(u=(u-f)/u*.5,e.x-=c*=u,e.y-=d*=u,t.point.x+=c,t.point.y+=d)}return o>n||l<i||r>a||h<s}}}function n(e,i){var s=0,a=0;if(e.charge=0,!e.leaf){var o,r=e.nodes,l=r.length,h=-1;while(++h<l)o=r[h],null!=o&&(n(o,i),e.charge+=o.charge,s+=o.charge*o.cx,a+=o.charge*o.cy)}if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var c=t.forceOptions.alpha*e.point.charge;e.charge+=e.pointCharge=c,s+=c*e.point.x,a+=c*e.point.y}e.cx=s/e.charge,e.cy=a/e.charge}function s(e,t,i,n,s){var a,o=-1,r=e.length;if(r&&isNaN(e[0].x)&&(e=e.map((function(e){return{x:e[0],y:e[1]}}))),arguments.length<5)if(3===arguments.length)s=n=i,i=t;else{t=i=1/0,n=s=-1/0;while(++o<r)a=e[o],a.x<t&&(t=a.x),a.y<i&&(i=a.y),a.x>n&&(n=a.x),a.y>s&&(s=a.y);var l=n-t,h=s-i;l>h?s=i+l:n=t+h}function c(e,t,i,n,s,a){if(!isNaN(t.x)&&!isNaN(t.y))if(e.leaf){var o=e.point;o?(Math.abs(o.x-t.x)+Math.abs(o.y-t.y)<.01||(e.point=null,d(e,o,i,n,s,a)),d(e,t,i,n,s,a)):e.point=t}else d(e,t,i,n,s,a)}function d(e,t,i,n,s,a){var o=.5*(i+s),r=.5*(n+a),l=t.x>=o,h=t.y>=r,d=(h<<1)+l;e.leaf=!1,e=e.nodes[d]||(e.nodes[d]={leaf:!0,nodes:[],point:null}),l?i=o:s=o,h?n=r:a=r,c(e,t,i,n,s,a)}function u(e,t,i,n,s,a){if(!e(t,i,n,s,a)){var o=.5*(i+s),r=.5*(n+a),l=t.nodes;l[0]&&u(e,l[0],i,n,o,r),l[1]&&u(e,l[1],o,n,s,r),l[2]&&u(e,l[2],i,r,o,a),l[3]&&u(e,l[3],o,r,s,a)}}var f={leaf:!0,nodes:[],point:null,add:function(e){c(f,e,t,i,n,s)},visit:function(e){u(e,f,t,i,n,s)}};return e.forEach(f.add),f}0!=t.nodes.length&&(t.autoLayout=!0,t.forceOptions.alpha=e||.5,t.loopRunLayout(i))},r.prototype.findNodeByAttr=function(e,t){var i=this.nodes.filter((function(i){return i[e]==t}));if(i.length>0){var n=i[0];return n}return null},r.prototype.findNodeById=function(e){var t=this.nodes.filter((function(t){return t.id==e}));if(t.length>0){var i=t[0];i.selected=!0,i.visible=!0,this.scene.addToSelected(i),this.focusTargetEle(i)}},r.prototype.updateNodeLabel=function(e,t){var i=this.nodes.filter((function(t){return t.id==e}))[0];i&&(i.label=t,i.text=t,this.refresh())};var l=r;"object"===a(t)?e.exports=l:(s=function(){return l}.call(t,i,t,e),void 0===s||(e.exports=s))}.call(this||("undefined"!==typeof window?window:n))}).call(this,i("c8ba"))},"99fb":function(e,t,i){},ad8f:function(e,t,i){"use strict";i.d(t,"n",(function(){return l})),i.d(t,"o",(function(){return h})),i.d(t,"p",(function(){return c})),i.d(t,"m",(function(){return d})),i.d(t,"q",(function(){return u})),i.d(t,"v",(function(){return f})),i.d(t,"i",(function(){return p})),i.d(t,"j",(function(){return b})),i.d(t,"c",(function(){return g})),i.d(t,"k",(function(){return v})),i.d(t,"t",(function(){return y})),i.d(t,"f",(function(){return m})),i.d(t,"d",(function(){return x})),i.d(t,"h",(function(){return k})),i.d(t,"u",(function(){return w})),i.d(t,"b",(function(){return L})),i.d(t,"g",(function(){return E})),i.d(t,"x",(function(){return S})),i.d(t,"y",(function(){return C})),i.d(t,"w",(function(){return I})),i.d(t,"e",(function(){return N})),i.d(t,"r",(function(){return M})),i.d(t,"a",(function(){return T}));var n=i("b775"),s=(i("d3b7"),i("bc3a")),a=i.n(s),o=(i("5c96"),a.a.create({baseURL:"",timeout:5e4}));o.defaults.retry=4,o.defaults.retryDelay=1e5,o.interceptors.response.use((function(e){var t=e.data;return t}),(function(e){return console.log("err"+e),Promise.reject(e)}));var r=o;function l(e){return Object(n["a"])({url:"backend/Projects/searchProject",method:"get",params:e})}function h(e){return Object(n["a"])({url:"backend/Projects/searchVersion",method:"get",params:e})}function c(e){return Object(n["a"])({url:"backend/getResults",method:"get",params:e})}function d(e){return Object(n["a"])({url:"backend/Services/getServices",method:"get",params:e})}function u(e){return Object(n["a"])({url:"backend/Services/insertServices",method:"get",params:e})}function f(e){return Object(n["a"])({url:"backend/Services/updateServices",method:"get",params:e})}function p(e){return Object(n["a"])({url:"backend/Services/deleteServices",method:"get",params:e})}function b(e){return Object(n["a"])({url:"backend/getMap",method:"get",params:e})}function g(e){return Object(n["a"])({url:"backend/addNode",method:"get",params:e})}function v(e){return Object(n["a"])({url:"backend/getNode",method:"get",params:e})}function y(e){return Object(n["a"])({url:"backend/updateNode",method:"get",params:e})}function m(e){return Object(n["a"])({url:"backend/deleteNode",method:"get",params:e})}function x(e){return Object(n["a"])({url:"backend/addRelation",method:"get",params:e})}function k(e){return Object(n["a"])({url:"backend/deleteRelation",method:"get",params:e})}function w(e){return Object(n["a"])({url:"backend/updateRelation",method:"get",params:e})}function L(e){return Object(n["a"])({url:"backend/addLabel",method:"get",params:e})}function E(e){return Object(n["a"])({url:"backend/deleteLabel",method:"get",params:e})}function S(e){return Object(n["a"])({url:"backend/mavenDependency/update",method:"get",params:e})}function C(e){return r({url:"backend/mavenDependency/sshupload",method:"post",headers:{"content-type":"multipart/form-data"},data:e})}function I(e){return r({url:"backend/mavenDependency/uploadFile",method:"post",headers:{"content-type":"multipart/form-data"},data:e})}function N(e){return Object(n["a"])({url:"backend/Projects/insertVersion",method:"get",params:e})}function M(e){return Object(n["a"])({url:"backend/insertSnykData",method:"get",params:e})}function T(e){return Object(n["a"])({url:"backend/crawl",method:"get",params:e})}},b5cc:function(e,t,i){},b775:function(e,t,i){"use strict";i("d3b7");var n=i("bc3a"),s=i.n(n),a=(i("5c96"),i("4328")),o=i.n(a),r=s.a.create({baseURL:"",timeout:5e4,headers:{"Content-Type":"application/x-www-form-urlencoded"}});r.defaults.retry=4,r.defaults.retryDelay=1e5,r.interceptors.request.use((function(e){return e.data=o.a.stringify(e.data),e}),(function(e){return Promise.error(e)})),r.interceptors.response.use((function(e){var t=e.data;return t}),(function(e){return console.log("err"+e),Promise.reject(e)})),t["a"]=r},bfa9:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"GraphXML数据",visible:e.dialogVisible,width:"50%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-alert",{attrs:{title:"使用说明",type:"warning",description:"以下数据可以被存储起来，方便下一次流程加载","show-icon":"","close-text":"知道了"}}),i("codemirror",{staticClass:"code",attrs:{value:e.xmlData,options:e.options}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("关闭")]),i("el-button",{attrs:{type:"primary"},on:{click:e.downloadData}},[e._v("下载")])],1)],1)},s=[],a=(i("a7be"),i("d5e0"),i("8f94")),o=i("347e"),r=i.n(o);i("f9d4");var l={props:{data:String},data:function(){return{dialogVisible:!1,xmlData:void 0,options:{mode:"xml",readOnly:!0,lineNumbers:!0}}},components:{codemirror:a["codemirror"]},methods:{init:function(){this.dialogVisible=!0,this.xmlData=r.a.xml(this.data)},downloadData:function(){this.$emit("downloadData")}}},h=l,c=i("2877"),d=Object(c["a"])(h,n,s,!1,null,null,null);t["a"]=d.exports},d55b:function(e,t,i){"use strict";i("07f4")},df4a:function(e,t,i){"use strict";i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return l}));var n=i("b85c"),s=(i("d3b7"),i("159b"),i("c740"),i("fb6a"),i("a434"),i("5892")),a={SERVICE:{color:"64,158,255"},SOFTWARE:{color:"103,194,58"},COMPONENT:{color:"103,194,58"},HOST:{color:"230,162,60"},DOCKER:{color:"230,162,60"},ACCESS:{color:"26,185,211"},INTERFACE:{color:"26,185,211"},NETWORK:{color:"144,147,153"},RISK:{color:"245,108,108"},CUSTOM:{color:"153,153,153"}};function o(e,t){var i={nodes:[],links:[]};return e.forEach((function(e){var t={id:e.id,label:e.label,type:e.type,tags:e.properties.tags,risks:e.properties.risks,version:e.properties.version,serviceId:e.properties.serviceId,serviceNodeId:e.properties.serviceNodeId,riskId:e.properties.riskId,riskNodeId:e.properties.riskNodeId};i.nodes.push(t)})),t.forEach((function(e){i.links.push({source:e.source.id||e.source,target:e.target.id||e.target,label:e.label||"",id:e.id})})),i}function r(e,t){var i,s=Object(n["a"])(e);try{for(s.s();!(i=s.n()).done;){var o=i.value;try{if(o.type=o.type.toUpperCase(),o.color=a[o.type].color,o.properties={risks:o.risks,tags:o.tags||[]},t){if("SOFTWARE"===o.type||"COMPONENT"===o.type){var r=o.properties.tags.findIndex((function(e){return-1!=e.indexOf("Version")}));r>-1&&(o.properties.version=o.properties.tags[r].slice(8),o.properties.tags.splice(r,1))}else if("SERVICE"===o.type){var l=o.properties.tags.findIndex((function(e){return-1!=e.indexOf("ServiceId")}));l>-1&&(o.properties.serviceId=o.properties.tags[l].slice(10),o.properties.tags.splice(l,1)),o.properties.serviceNodeId=o.id}else if("RISK"===o.type){var h=o.properties.tags.findIndex((function(e){return-1!=e.indexOf("RiskId")}));h>-1&&(o.properties.riskId=o.properties.tags[h].slice(7),o.properties.tags.splice(h,1)),o.properties.riskNodeId=o.id}o.properties.tags.shift()}else o.serviceId&&(o.properties.serviceId=o.serviceId),o.serviceNodeId&&(o.properties.serviceNodeId=o.serviceNodeId),o.version&&(o.properties.version=o.version),o.riskId&&(o.properties.riskId=o.riskId),o.riskNodeId&&(o.properties.riskNodeId=o.riskNodeId);delete o.tags,delete o.risks}catch(c){console.error("未定义的节点类型：",o.type,c);continue}}}catch(c){s.e(c)}finally{s.f()}return e}function l(e){return Object(s["a"])(o(r(e.nodes,!0),e.links))}},f9ea:function(e,t,i){"use strict";i("4348")}}]);